(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?module.exports=t(require("global/document"),require("global/window")):typeof define==="function"&&define.amd?define(["global/document","global/window"],t):e.videojs=t(e.document,e.window)})(this,function(h,_){h=h&&h.hasOwnProperty("default")?h["default"]:h;_=_&&_.hasOwnProperty("default")?_["default"]:_;var d="7.4.1";function o(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}function u(e,t){u=Object.setPrototypeOf||function e(t,i){t.__proto__=i;return t};return u(e,t)}function r(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}function s(e,t,i){if(r()){s=Reflect.construct}else{s=function e(t,i,r){var n=[null];n.push.apply(n,i);var a=Function.bind.apply(t,n);var s=new a;if(r)u(s,r.prototype);return s}}return s.apply(null,arguments)}function p(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function e(e,t){if(!t){t=e.slice(0)}e.raw=t;return e}var l=[];var c=function e(s,o){return function(e,t,i){var r=o.levels[t];var n=new RegExp("^("+r+")$");if(e!=="log"){i.unshift(e.toUpperCase()+":")}i.unshift(s+":");if(l){l.push([].concat(i))}if(!_.console){return}var a=_.console[e];if(!a&&e==="debug"){a=_.console.info||_.console.log}if(!a||!r||!n.test(e)){return}a[Array.isArray(i)?"apply":"call"](_.console,i)}};function f(t){var n="info";var a;var i=function e(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++){i[r]=arguments[r]}a("log",n,i)};a=c(t,i);i.createLogger=function(e){return f(t+": "+e)};i.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:n};i.level=function(e){if(typeof e==="string"){if(!i.levels.hasOwnProperty(e)){throw new Error('"'+e+'" in not a valid log level')}n=e}return n};i.history=function(){return l?[].concat(l):[]};i.history.filter=function(t){return(l||[]).filter(function(e){return new RegExp(".*"+t+".*").test(e[0])})};i.history.clear=function(){if(l){l.length=0}};i.history.disable=function(){if(l!==null){l.length=0;l=null}};i.history.enable=function(){if(l===null){l=[]}};i.error=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++){t[i]=arguments[i]}return a("error",n,t)};i.warn=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++){t[i]=arguments[i]}return a("warn",n,t)};i.debug=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++){t[i]=arguments[i]}return a("debug",n,t)};return i}var m=f("VIDEOJS");var v=m.createLogger;function n(e){return e.replace(/\n\r?\s*/g,"")}var g=function e(t){var i="",r=0;for(;r<arguments.length;r++){i+=n(t[r])+(arguments[r+1]||"")}return i};var t=Object.prototype.toString;var a=function e(t){return T(t)?Object.keys(t):[]};function y(t,i){a(t).forEach(function(e){return i(t[e],e)})}function i(i,r,e){if(e===void 0){e=0}return a(i).reduce(function(e,t){return r(e,i[t],t)},e)}function b(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++){t[r-1]=arguments[r]}if(Object.assign){return Object.assign.apply(Object,[i].concat(t))}t.forEach(function(e){if(!e){return}y(e,function(e,t){i[t]=e})});return i}function T(e){return!!e&&typeof e==="object"}function S(e){return T(e)&&t.call(e)==="[object Object]"&&e.constructor===Object}function k(e,t){if(!e||!t){return""}if(typeof _.getComputedStyle==="function"){var i=_.getComputedStyle(e);return i?i[t]:""}return""}function w(){var t=e(["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."]);w=function e(){return t};return t}function C(e){return typeof e==="string"&&/\S/.test(e)}function E(e){if(/\s/.test(e)){throw new Error("class has illegal whitespace characters")}}function A(e){return new RegExp("(^|\\s)"+e+"($|\\s)")}function L(){return h===_.document}function I(e){return T(e)&&e.nodeType===1}function O(){try{return _.parent!==_.self}catch(e){return true}}function P(r){return function(e,t){if(!C(e)){return h[r](null)}if(C(t)){t=h.querySelector(t)}var i=I(t)?t:h;return i[r]&&i[r](e)}}function U(e,i,t,r){if(e===void 0){e="div"}if(i===void 0){i={}}if(t===void 0){t={}}var n=h.createElement(e);Object.getOwnPropertyNames(i).forEach(function(e){var t=i[e];if(e.indexOf("aria-")!==-1||e==="role"||e==="type"){m.warn(g(w(),e,t));n.setAttribute(e,t)}else if(e==="textContent"){D(n,t)}else{n[e]=t}});Object.getOwnPropertyNames(t).forEach(function(e){n.setAttribute(e,t[e])});if(r){Q(n,r)}return n}function D(e,t){if(typeof e.textContent==="undefined"){e.innerText=t}else{e.textContent=t}return e}function x(e,t){if(t.firstChild){t.insertBefore(e,t.firstChild)}else{t.appendChild(e)}}function R(e,t){E(t);if(e.classList){return e.classList.contains(t)}return A(t).test(e.className)}function M(e,t){if(e.classList){e.classList.add(t)}else if(!R(e,t)){e.className=(e.className+" "+t).trim()}return e}function B(e,t){if(e.classList){e.classList.remove(t)}else{E(t);e.className=e.className.split(/\s+/).filter(function(e){return e!==t}).join(" ")}return e}function N(e,t,i){var r=R(e,t);if(typeof i==="function"){i=i(e,t)}if(typeof i!=="boolean"){i=!r}if(i===r){return}if(i){M(e,t)}else{B(e,t)}return e}function j(i,r){Object.getOwnPropertyNames(r).forEach(function(e){var t=r[e];if(t===null||typeof t==="undefined"||t===false){i.removeAttribute(e)}else{i.setAttribute(e,t===true?"":t)}})}function F(e){var t={};var i=","+"autoplay,controls,playsinline,loop,muted,default,defaultMuted"+",";if(e&&e.attributes&&e.attributes.length>0){var r=e.attributes;for(var n=r.length-1;n>=0;n--){var a=r[n].name;var s=r[n].value;if(typeof e[a]==="boolean"||i.indexOf(","+a+",")!==-1){s=s!==null?true:false}t[a]=s}}return t}function V(e,t){return e.getAttribute(t)}function H(e,t,i){e.setAttribute(t,i)}function q(e,t){e.removeAttribute(t)}function z(){h.body.focus();h.onselectstart=function(){return false}}function W(){h.onselectstart=function(){return true}}function G(e){if(e&&e.getBoundingClientRect&&e.parentNode){var t=e.getBoundingClientRect();var i={};["bottom","height","left","right","top","width"].forEach(function(e){if(t[e]!==undefined){i[e]=t[e]}});if(!i.height){i.height=parseFloat(k(e,"height"))}if(!i.width){i.width=parseFloat(k(e,"width"))}return i}}function X(e){var t;if(e.getBoundingClientRect&&e.parentNode){t=e.getBoundingClientRect()}if(!t){return{left:0,top:0}}var i=h.documentElement;var r=h.body;var n=i.clientLeft||r.clientLeft||0;var a=_.pageXOffset||r.scrollLeft;var s=t.left+a-n;var o=i.clientTop||r.clientTop||0;var u=_.pageYOffset||r.scrollTop;var l=t.top+u-o;return{left:Math.round(s),top:Math.round(l)}}function Y(e,t){var i={};var r=X(e);var n=e.offsetWidth;var a=e.offsetHeight;var s=r.top;var o=r.left;var u=t.pageY;var l=t.pageX;if(t.changedTouches){l=t.changedTouches[0].pageX;u=t.changedTouches[0].pageY}i.y=Math.max(0,Math.min(1,(s-u+a)/a));i.x=Math.max(0,Math.min(1,(l-o)/n));return i}function $(e){return T(e)&&e.nodeType===3}function K(e){while(e.firstChild){e.removeChild(e.firstChild)}return e}function J(e){if(typeof e==="function"){e=e()}return(Array.isArray(e)?e:[e]).map(function(e){if(typeof e==="function"){e=e()}if(I(e)||$(e)){return e}if(typeof e==="string"&&/\S/.test(e)){return h.createTextNode(e)}}).filter(function(e){return e})}function Q(t,e){J(e).forEach(function(e){return t.appendChild(e)});return t}function Z(e,t){return Q(K(e),t)}function ee(e){if(e.button===undefined&&e.buttons===undefined){return true}if(e.button===0&&e.buttons===undefined){return true}if(e.button!==0||e.buttons!==1){return false}return true}var te=P("querySelector");var ie=P("querySelectorAll");var re=Object.freeze({isReal:L,isEl:I,isInFrame:O,createEl:U,textContent:D,prependTo:x,hasClass:R,addClass:M,removeClass:B,toggleClass:N,setAttributes:j,getAttributes:F,getAttribute:V,setAttribute:H,removeAttribute:q,blockTextSelection:z,unblockTextSelection:W,getBoundingClientRect:G,findPosition:X,getPointerPosition:Y,isTextNode:$,emptyEl:K,normalizeContent:J,appendContent:Q,insertContent:Z,isSingleLeftClick:ee,$:te,$$:ie});var ne=1;function ae(){return ne++}var se={};var oe="vdata"+(new Date).getTime();function ue(e){var t=e[oe];if(!t){t=e[oe]=ae()}if(!se[t]){se[t]={}}return se[t]}function le(e){var t=e[oe];if(!t){return false}return!!Object.getOwnPropertyNames(se[t]).length}function ce(t){var e=t[oe];if(!e){return}delete se[e];try{delete t[oe]}catch(e){if(t.removeAttribute){t.removeAttribute(oe)}else{t[oe]=null}}}function fe(e,t){var i=ue(e);if(i.handlers[t].length===0){delete i.handlers[t];if(e.removeEventListener){e.removeEventListener(t,i.dispatcher,false)}else if(e.detachEvent){e.detachEvent("on"+t,i.dispatcher)}}if(Object.getOwnPropertyNames(i.handlers).length<=0){delete i.handlers;delete i.dispatcher;delete i.disabled}if(Object.getOwnPropertyNames(i).length===0){ce(e)}}function he(t,i,e,r){e.forEach(function(e){t(i,e,r)})}function de(e){function t(){return true}function i(){return false}if(!e||!e.isPropagationStopped){var r=e||_.event;e={};for(var n in r){if(n!=="layerX"&&n!=="layerY"&&n!=="keyLocation"&&n!=="webkitMovementX"&&n!=="webkitMovementY"){if(!(n==="returnValue"&&r.preventDefault)){e[n]=r[n]}}}if(!e.target){e.target=e.srcElement||h}if(!e.relatedTarget){e.relatedTarget=e.fromElement===e.target?e.toElement:e.fromElement}e.preventDefault=function(){if(r.preventDefault){r.preventDefault()}e.returnValue=false;r.returnValue=false;e.defaultPrevented=true};e.defaultPrevented=false;e.stopPropagation=function(){if(r.stopPropagation){r.stopPropagation()}e.cancelBubble=true;r.cancelBubble=true;e.isPropagationStopped=t};e.isPropagationStopped=i;e.stopImmediatePropagation=function(){if(r.stopImmediatePropagation){r.stopImmediatePropagation()}e.isImmediatePropagationStopped=t;e.stopPropagation()};e.isImmediatePropagationStopped=i;if(e.clientX!==null&&e.clientX!==undefined){var a=h.documentElement;var s=h.body;e.pageX=e.clientX+(a&&a.scrollLeft||s&&s.scrollLeft||0)-(a&&a.clientLeft||s&&s.clientLeft||0);e.pageY=e.clientY+(a&&a.scrollTop||s&&s.scrollTop||0)-(a&&a.clientTop||s&&s.clientTop||0)}e.which=e.charCode||e.keyCode;if(e.button!==null&&e.button!==undefined){e.button=e.button&1?0:e.button&4?1:e.button&2?2:0}}return e}var pe=false;(function(){try{var e=Object.defineProperty({},"passive",{get:function e(){pe=true}});_.addEventListener("test",null,e);_.removeEventListener("test",null,e)}catch(e){}})();var me=["touchstart","touchmove"];function ve(s,e,t){if(Array.isArray(e)){return he(ve,s,e,t)}var o=ue(s);if(!o.handlers){o.handlers={}}if(!o.handlers[e]){o.handlers[e]=[]}if(!t.guid){t.guid=ae()}o.handlers[e].push(t);if(!o.dispatcher){o.disabled=false;o.dispatcher=function(e,t){if(o.disabled){return}e=de(e);var i=o.handlers[e.type];if(i){var r=i.slice(0);for(var n=0,a=r.length;n<a;n++){if(e.isImmediatePropagationStopped()){break}else{try{r[n].call(s,e,t)}catch(e){m.error(e)}}}}}}if(o.handlers[e].length===1){if(s.addEventListener){var i=false;if(pe&&me.indexOf(e)>-1){i={passive:true}}s.addEventListener(e,o.dispatcher,i)}else if(s.attachEvent){s.attachEvent("on"+e,o.dispatcher)}}}function ge(e,t,i){if(!le(e)){return}var r=ue(e);if(!r.handlers){return}if(Array.isArray(t)){return he(ge,e,t,i)}var n=function e(t,i){r.handlers[i]=[];fe(t,i)};if(t===undefined){for(var a in r.handlers){if(Object.prototype.hasOwnProperty.call(r.handlers||{},a)){n(e,a)}}return}var s=r.handlers[t];if(!s){return}if(!i){n(e,t);return}if(i.guid){for(var o=0;o<s.length;o++){if(s[o].guid===i.guid){s.splice(o--,1)}}}fe(e,t)}function ye(e,t,i){var r=le(e)?ue(e):{};var n=e.parentNode||e.ownerDocument;if(typeof t==="string"){t={type:t,target:e}}else if(!t.target){t.target=e}t=de(t);if(r.dispatcher){r.dispatcher.call(e,t,i)}if(n&&!t.isPropagationStopped()&&t.bubbles===true){ye.call(null,n,t,i)}else if(!n&&!t.defaultPrevented){var a=ue(t.target);if(t.target[t.type]){a.disabled=true;if(typeof t.target[t.type]==="function"){t.target[t.type]()}a.disabled=false}}return!t.defaultPrevented}function _e(t,i,r){if(Array.isArray(i)){return he(_e,t,i,r)}var e=function e(){ge(t,i,e);r.apply(this,arguments)};e.guid=r.guid=r.guid||ae();ve(t,i,e)}var be=Object.freeze({fixEvent:de,on:ve,off:ge,trigger:ye,one:_e});var Te=false;var Se;var ke=function e(){if(!L()||Se.options.autoSetup===false){return}var t=Array.prototype.slice.call(h.getElementsByTagName("video"));var i=Array.prototype.slice.call(h.getElementsByTagName("audio"));var r=Array.prototype.slice.call(h.getElementsByTagName("video-js"));var n=t.concat(i,r);if(n&&n.length>0){for(var a=0,s=n.length;a<s;a++){var o=n[a];if(o&&o.getAttribute){if(o.player===undefined){var u=o.getAttribute("data-setup");if(u!==null){Se(o)}}}else{we(1);break}}}else if(!Te){we(1)}};function we(e,t){if(t){Se=t}_.setTimeout(ke,e)}if(L()&&h.readyState==="complete"){Te=true}else{_e(_,"load",function(){Te=true})}var Ce=function e(t){var i=h.createElement("style");i.className=t;return i};var Ee=function e(t,i){if(t.styleSheet){t.styleSheet.cssText=i}else{t.textContent=i}};var Ae=function e(t,i,r){if(!i.guid){i.guid=ae()}var n=function e(){return i.apply(t,arguments)};n.guid=r?r+"_"+i.guid:i.guid;return n};var Le=function e(i,r){var n=Date.now();var t=function e(){var t=Date.now();if(t-n>=r){i.apply(void 0,arguments);n=t}};return t};var Ie=function e(n,a,s,o){if(o===void 0){o=_}var u;var t=function e(){o.clearTimeout(u);u=null};var i=function e(){var t=this;var i=arguments;var r=function e(){u=null;r=null;if(!s){n.apply(t,i)}};if(!u&&s){n.apply(t,i)}o.clearTimeout(u);u=o.setTimeout(r,a)};i.cancel=t;return i};var Oe=function e(){};Oe.prototype.allowedEvents_={};Oe.prototype.on=function(e,t){var i=this.addEventListener;this.addEventListener=function(){};ve(this,e,t);this.addEventListener=i};Oe.prototype.addEventListener=Oe.prototype.on;Oe.prototype.off=function(e,t){ge(this,e,t)};Oe.prototype.removeEventListener=Oe.prototype.off;Oe.prototype.one=function(e,t){var i=this.addEventListener;this.addEventListener=function(){};_e(this,e,t);this.addEventListener=i};Oe.prototype.trigger=function(e){var t=e.type||e;if(typeof e==="string"){e={type:t}}e=de(e);if(this.allowedEvents_[t]&&this["on"+t]){this["on"+t](e)}ye(this,e)};Oe.prototype.dispatchEvent=Oe.prototype.trigger;var Pe;Oe.prototype.queueTrigger=function(e){var t=this;if(!Pe){Pe=new Map}var i=e.type||e;var r=Pe.get(this);if(!r){r=new Map;Pe.set(this,r)}var n=r.get(i);r.delete(i);_.clearTimeout(n);var a=_.setTimeout(function(){if(r.size===0){r=null;Pe.delete(t)}t.trigger(e)},0);r.set(i,a)};var Ue=function e(t){return t instanceof Oe||!!t.eventBusEl_&&["on","one","off","trigger"].every(function(e){return typeof t[e]==="function"})};var De=function e(t,i){if(Ue(t)){i()}else{if(!t.eventedCallbacks){t.eventedCallbacks=[]}t.eventedCallbacks.push(i)}};var xe=function e(t){return typeof t==="string"&&/\S/.test(t)||Array.isArray(t)&&!!t.length};var Re=function e(t){if(!t.nodeName&&!Ue(t)){throw new Error("Invalid target; must be a DOM node or evented object.")}};var Me=function e(t){if(!xe(t)){throw new Error("Invalid event type; must be a non-empty string or array.")}};var Be=function e(t){if(typeof t!=="function"){throw new Error("Invalid listener; must be a function.")}};var Ne=function e(t,i){var r=i.length<3||i[0]===t||i[0]===t.eventBusEl_;var n;var a;var s;if(r){n=t.eventBusEl_;if(i.length>=3){i.shift()}a=i[0];s=i[1]}else{n=i[0];a=i[1];s=i[2]}Re(n);Me(a);Be(s);s=Ae(t,s);return{isTargetingSelf:r,target:n,type:a,listener:s}};var je=function e(t,i,r,n){Re(t);if(t.nodeName){be[i](t,r,n)}else{t[i](r,n)}};var Fe={on:function e(){var t=this;for(var i=arguments.length,r=new Array(i),n=0;n<i;n++){r[n]=arguments[n]}var a=Ne(this,r),s=a.isTargetingSelf,o=a.target,u=a.type,l=a.listener;je(o,"on",u,l);if(!s){var c=function e(){return t.off(o,u,l)};c.guid=l.guid;var f=function e(){return t.off("dispose",c)};f.guid=l.guid;je(this,"on","dispose",c);je(o,"on","dispose",f)}},one:function e(){var n=this;for(var t=arguments.length,i=new Array(t),r=0;r<t;r++){i[r]=arguments[r]}var a=Ne(this,i),s=a.isTargetingSelf,o=a.target,u=a.type,l=a.listener;if(s){je(o,"one",u,l)}else{var c=function e(){n.off(o,u,e);for(var t=arguments.length,i=new Array(t),r=0;r<t;r++){i[r]=arguments[r]}l.apply(null,i)};c.guid=l.guid;je(o,"one",u,c)}},off:function e(t,i,r){if(!t||xe(t)){ge(this.eventBusEl_,t,i)}else{var n=t;var a=i;Re(n);Me(a);Be(r);r=Ae(this,r);this.off("dispose",r);if(n.nodeName){ge(n,a,r);ge(n,"dispose",r)}else if(Ue(n)){n.off(a,r);n.off("dispose",r)}}},trigger:function e(t,i){return ye(this.eventBusEl_,t,i)}};function Ve(e,t){if(t===void 0){t={}}var i=t,r=i.eventBusKey;if(r){if(!e[r].nodeName){throw new Error('The eventBusKey "'+r+'" does not refer to an element.')}e.eventBusEl_=e[r]}else{e.eventBusEl_=U("span",{className:"vjs-event-bus"})}b(e,Fe);if(e.eventedCallbacks){e.eventedCallbacks.forEach(function(e){e()})}e.on("dispose",function(){e.off();_.setTimeout(function(){e.eventBusEl_=null},0)});return e}var He={state:{},setState:function e(t){var i=this;if(typeof t==="function"){t=t()}var r;y(t,function(e,t){if(i.state[t]!==e){r=r||{};r[t]={from:i.state[t],to:e}}i.state[t]=e});if(r&&Ue(this)){this.trigger({changes:r,type:"statechanged"})}return r}};function qe(e,t){b(e,He);e.state=b({},e.state,t);if(typeof e.handleStateChanged==="function"&&Ue(e)){e.on("statechanged",e.handleStateChanged)}return e}function ze(e){if(typeof e!=="string"){return e}return e.charAt(0).toUpperCase()+e.slice(1)}function We(e,t){return ze(e)===ze(t)}function Ge(){var i={};for(var e=arguments.length,t=new Array(e),r=0;r<e;r++){t[r]=arguments[r]}t.forEach(function(e){if(!e){return}y(e,function(e,t){if(!S(e)){i[t]=e;return}if(!S(i[t])){i[t]={}}i[t]=Ge(i[t],e)})});return i}var Xe=function(){function c(e,t,i){if(!e&&this.play){this.player_=e=this}else{this.player_=e}this.options_=Ge({},this.options_);t=this.options_=Ge(this.options_,t);this.id_=t.id||t.el&&t.el.id;if(!this.id_){var r=e&&e.id&&e.id()||"no_player";this.id_=r+"_component_"+ae()}this.name_=t.name||null;if(t.el){this.el_=t.el}else if(t.createEl!==false){this.el_=this.createEl()}if(t.evented!==false){Ve(this,{eventBusKey:this.el_?"el_":null})}qe(this,this.constructor.defaultState);this.children_=[];this.childIndex_={};this.childNameIndex_={};if(t.initChildren!==false){this.initChildren()}this.ready(i);if(t.reportTouchActivity!==false){this.enableTouchActivity()}}var e=c.prototype;e.dispose=function e(){this.trigger({type:"dispose",bubbles:false});if(this.children_){for(var t=this.children_.length-1;t>=0;t--){if(this.children_[t].dispose){this.children_[t].dispose()}}}this.children_=null;this.childIndex_=null;this.childNameIndex_=null;if(this.el_){if(this.el_.parentNode){this.el_.parentNode.removeChild(this.el_)}ce(this.el_);this.el_=null}this.player_=null};e.player=function e(){return this.player_};e.options=function e(t){m.warn("this.options() has been deprecated and will be moved to the constructor in 6.0");if(!t){return this.options_}this.options_=Ge(this.options_,t);return this.options_};e.el=function e(){return this.el_};e.createEl=function e(t,i,r){return U(t,i,r)};e.localize=function e(t,n,i){if(i===void 0){i=t}var r=this.player_.language&&this.player_.language();var a=this.player_.languages&&this.player_.languages();var s=a&&a[r];var o=r&&r.split("-")[0];var u=a&&a[o];var l=i;if(s&&s[t]){l=s[t]}else if(u&&u[t]){l=u[t]}if(n){l=l.replace(/\{(\d+)\}/g,function(e,t){var i=n[t-1];var r=i;if(typeof i==="undefined"){r=e}return r})}return l};e.contentEl=function e(){return this.contentEl_||this.el_};e.id=function e(){return this.id_};e.name=function e(){return this.name_};e.children=function e(){return this.children_};e.getChildById=function e(t){return this.childIndex_[t]};e.getChild=function e(t){if(!t){return}t=ze(t);return this.childNameIndex_[t]};e.addChild=function e(t,i,r){if(i===void 0){i={}}if(r===void 0){r=this.children_.length}var n;var a;if(typeof t==="string"){a=ze(t);var s=i.componentClass||a;i.name=a;var o=c.getComponent(s);if(!o){throw new Error("Component "+s+" does not exist")}if(typeof o!=="function"){return null}n=new o(this.player_||this,i)}else{n=t}this.children_.splice(r,0,n);if(typeof n.id==="function"){this.childIndex_[n.id()]=n}a=a||n.name&&ze(n.name());if(a){this.childNameIndex_[a]=n}if(typeof n.el==="function"&&n.el()){var u=this.contentEl().children;var l=u[r]||null;this.contentEl().insertBefore(n.el(),l)}return n};e.removeChild=function e(t){if(typeof t==="string"){t=this.getChild(t)}if(!t||!this.children_){return}var i=false;for(var r=this.children_.length-1;r>=0;r--){if(this.children_[r]===t){i=true;this.children_.splice(r,1);break}}if(!i){return}this.childIndex_[t.id()]=null;this.childNameIndex_[t.name()]=null;var n=t.el();if(n&&n.parentNode===this.contentEl()){this.contentEl().removeChild(t.el())}};e.initChildren=function e(){var a=this;var r=this.options_.children;if(r){var s=this.options_;var t=function e(t){var i=t.name;var r=t.opts;if(s[i]!==undefined){r=s[i]}if(r===false){return}if(r===true){r={}}r.playerOptions=a.options_.playerOptions;var n=a.addChild(i,r);if(n){a[i]=n}};var i;var n=c.getComponent("Tech");if(Array.isArray(r)){i=r}else{i=Object.keys(r)}i.concat(Object.keys(this.options_).filter(function(t){return!i.some(function(e){if(typeof e==="string"){return t===e}return t===e.name})})).map(function(e){var t;var i;if(typeof e==="string"){t=e;i=r[t]||a.options_[t]||{}}else{t=e.name;i=e}return{name:t,opts:i}}).filter(function(e){var t=c.getComponent(e.opts.componentClass||ze(e.name));return t&&!n.isTech(t)}).forEach(t)}};e.buildCSSClass=function e(){return""};e.ready=function e(t,i){if(i===void 0){i=false}if(!t){return}if(!this.isReady_){this.readyQueue_=this.readyQueue_||[];this.readyQueue_.push(t);return}if(i){t.call(this)}else{this.setTimeout(t,1)}};e.triggerReady=function e(){this.isReady_=true;this.setTimeout(function(){var e=this.readyQueue_;this.readyQueue_=[];if(e&&e.length>0){e.forEach(function(e){e.call(this)},this)}this.trigger("ready")},1)};e.$=function e(t,i){return te(t,i||this.contentEl())};e.$$=function e(t,i){return ie(t,i||this.contentEl())};e.hasClass=function e(t){return R(this.el_,t)};e.addClass=function e(t){M(this.el_,t)};e.removeClass=function e(t){B(this.el_,t)};e.toggleClass=function e(t,i){N(this.el_,t,i)};e.show=function e(){this.removeClass("vjs-hidden")};e.hide=function e(){this.addClass("vjs-hidden")};e.lockShowing=function e(){this.addClass("vjs-lock-showing")};e.unlockShowing=function e(){this.removeClass("vjs-lock-showing")};e.getAttribute=function e(t){return V(this.el_,t)};e.setAttribute=function e(t,i){H(this.el_,t,i)};e.removeAttribute=function e(t){q(this.el_,t)};e.width=function e(t,i){return this.dimension("width",t,i)};e.height=function e(t,i){return this.dimension("height",t,i)};e.dimensions=function e(t,i){this.width(t,true);this.height(i)};e.dimension=function e(t,i,r){if(i!==undefined){if(i===null||i!==i){i=0}if((""+i).indexOf("%")!==-1||(""+i).indexOf("px")!==-1){this.el_.style[t]=i}else if(i==="auto"){this.el_.style[t]=""}else{this.el_.style[t]=i+"px"}if(!r){this.trigger("componentresize")}return}if(!this.el_){return 0}var n=this.el_.style[t];var a=n.indexOf("px");if(a!==-1){return parseInt(n.slice(0,a),10)}return parseInt(this.el_["offset"+ze(t)],10)};e.currentDimension=function e(t){var i=0;if(t!=="width"&&t!=="height"){throw new Error("currentDimension only accepts width or height value")}if(typeof _.getComputedStyle==="function"){var r=_.getComputedStyle(this.el_);i=r.getPropertyValue(t)||r[t]}i=parseFloat(i);if(i===0){var n="offset"+ze(t);i=this.el_[n]}return i};e.currentDimensions=function e(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}};e.currentWidth=function e(){return this.currentDimension("width")};e.currentHeight=function e(){return this.currentDimension("height")};e.focus=function e(){this.el_.focus()};e.blur=function e(){this.el_.blur()};e.emitTapEvents=function e(){var i=0;var n=null;var a=10;var r=200;var s;this.on("touchstart",function(e){if(e.touches.length===1){n={pageX:e.touches[0].pageX,pageY:e.touches[0].pageY};i=(new Date).getTime();s=true}});this.on("touchmove",function(e){if(e.touches.length>1){s=false}else if(n){var t=e.touches[0].pageX-n.pageX;var i=e.touches[0].pageY-n.pageY;var r=Math.sqrt(t*t+i*i);if(r>a){s=false}}});var t=function e(){s=false};this.on("touchleave",t);this.on("touchcancel",t);this.on("touchend",function(e){n=null;if(s===true){var t=(new Date).getTime()-i;if(t<r){e.preventDefault();this.trigger("tap")}}})};e.enableTouchActivity=function e(){if(!this.player()||!this.player().reportUserActivity){return}var i=Ae(this.player(),this.player().reportUserActivity);var r;this.on("touchstart",function(){i();this.clearInterval(r);r=this.setInterval(i,250)});var t=function e(t){i();this.clearInterval(r)};this.on("touchmove",i);this.on("touchend",t);this.on("touchcancel",t)};e.setTimeout=function e(t,i){var r=this;var n,a;t=Ae(this,t);n=_.setTimeout(function(){r.off("dispose",a);t()},i);a=function e(){return r.clearTimeout(n)};a.guid="vjs-timeout-"+n;this.on("dispose",a);return n};e.clearTimeout=function e(t){_.clearTimeout(t);var i=function e(){};i.guid="vjs-timeout-"+t;this.off("dispose",i);return t};e.setInterval=function e(t,i){var r=this;t=Ae(this,t);var n=_.setInterval(t,i);var a=function e(){return r.clearInterval(n)};a.guid="vjs-interval-"+n;this.on("dispose",a);return n};e.clearInterval=function e(t){_.clearInterval(t);var i=function e(){};i.guid="vjs-interval-"+t;this.off("dispose",i);return t};e.requestAnimationFrame=function e(t){var i=this;var r,n;if(this.supportsRaf_){t=Ae(this,t);r=_.requestAnimationFrame(function(){i.off("dispose",n);t()});n=function e(){return i.cancelAnimationFrame(r)};n.guid="vjs-raf-"+r;this.on("dispose",n);return r}return this.setTimeout(t,1e3/60)};e.cancelAnimationFrame=function e(t){if(this.supportsRaf_){_.cancelAnimationFrame(t);var i=function e(){};i.guid="vjs-raf-"+t;this.off("dispose",i);return t}return this.clearTimeout(t)};c.registerComponent=function e(t,i){if(typeof t!=="string"||!t){throw new Error('Illegal component name, "'+t+'"; must be a non-empty string.')}var r=c.getComponent("Tech");var n=r&&r.isTech(i);var a=c===i||c.prototype.isPrototypeOf(i.prototype);if(n||!a){var s;if(n){s="techs must be registered using Tech.registerTech()"}else{s="must be a Component subclass"}throw new Error('Illegal component, "'+t+'"; '+s+".")}t=ze(t);if(!c.components_){c.components_={}}var o=c.getComponent("Player");if(t==="Player"&&o&&o.players){var u=o.players;var l=Object.keys(u);if(u&&l.length>0&&l.map(function(e){return u[e]}).every(Boolean)){throw new Error("Can not register Player component after player has been created.")}}c.components_[t]=i;return i};c.getComponent=function e(t){if(!t){return}t=ze(t);if(c.components_&&c.components_[t]){return c.components_[t]}};return c}();Xe.prototype.supportsRaf_=typeof _.requestAnimationFrame==="function"&&typeof _.cancelAnimationFrame==="function";Xe.registerComponent("Component",Xe);var Ye=_.navigator&&_.navigator.userAgent||"";var $e=/AppleWebKit\/([\d.]+)/i.exec(Ye);var Ke=$e?parseFloat($e.pop()):null;var Je=/iPad/i.test(Ye);var Qe=/iPhone/i.test(Ye)&&!Je;var Ze=/iPod/i.test(Ye);var et=Qe||Je||Ze;var tt=function(){var e=Ye.match(/OS (\d+)_/i);if(e&&e[1]){return e[1]}return null}();var it=/Android/i.test(Ye);var rt=function(){var e=Ye.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e){return null}var t=e[1]&&parseFloat(e[1]);var i=e[2]&&parseFloat(e[2]);if(t&&i){return parseFloat(e[1]+"."+e[2])}else if(t){return t}return null}();var nt=it&&rt<5&&Ke<537;var at=/Firefox/i.test(Ye);var st=/Edge/i.test(Ye);var ot=!st&&(/Chrome/i.test(Ye)||/CriOS/i.test(Ye));var ut=function(){var e=Ye.match(/(Chrome|CriOS)\/(\d+)/);if(e&&e[2]){return parseFloat(e[2])}return null}();var lt=function(){var e=/MSIE\s(\d+)\.\d/.exec(Ye);var t=e&&parseFloat(e[1]);if(!t&&/Trident\/7.0/i.test(Ye)&&/rv:11.0/.test(Ye)){t=11}return t}();var ct=/Safari/i.test(Ye)&&!ot&&!it&&!st;var ft=(ct||et)&&!ot;var ht=L()&&("ontouchstart"in _||_.navigator.maxTouchPoints||_.DocumentTouch&&_.document instanceof _.DocumentTouch);var dt=Object.freeze({IS_IPAD:Je,IS_IPHONE:Qe,IS_IPOD:Ze,IS_IOS:et,IOS_VERSION:tt,IS_ANDROID:it,ANDROID_VERSION:rt,IS_NATIVE_ANDROID:nt,IS_FIREFOX:at,IS_EDGE:st,IS_CHROME:ot,CHROME_VERSION:ut,IE_VERSION:lt,IS_SAFARI:ct,IS_ANY_SAFARI:ft,TOUCH_ENABLED:ht});function pt(e,t,i){if(typeof t!=="number"||t<0||t>i){throw new Error("Failed to execute '"+e+"' on 'TimeRanges': The index provided ("+t+") is non-numeric or out of bounds (0-"+i+").")}}function mt(e,t,i,r){pt(e,r,i.length-1);return i[r][t]}function vt(e){if(e===undefined||e.length===0){return{length:0,start:function e(){throw new Error("This TimeRanges object is empty")},end:function e(){throw new Error("This TimeRanges object is empty")}}}return{length:e.length,start:mt.bind(null,"start",0,e),end:mt.bind(null,"end",1,e)}}function gt(e,t){if(Array.isArray(e)){return vt(e)}else if(e===undefined||t===undefined){return vt()}return vt([[e,t]])}function yt(e,t){var i=0;var r;var n;if(!t){return 0}if(!e||!e.length){e=gt(0,0)}for(var a=0;a<e.length;a++){r=e.start(a);n=e.end(a);if(n>t){n=t}i+=n-r}return i/t}var _t={};var bt=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]];var Tt=bt[0];var St;for(var kt=0;kt<bt.length;kt++){if(bt[kt][1]in h){St=bt[kt];break}}if(St){for(var wt=0;wt<St.length;wt++){_t[Tt[wt]]=St[wt]}}function Ct(e){if(e instanceof Ct){return e}if(typeof e==="number"){this.code=e}else if(typeof e==="string"){this.message=e}else if(T(e)){if(typeof e.code==="number"){this.code=e.code}b(this,e)}if(!this.message){this.message=Ct.defaultMessages[this.code]||""}}Ct.prototype.code=0;Ct.prototype.message="";Ct.prototype.status=null;Ct.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"];Ct.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var Et=0;Et<Ct.errorTypes.length;Et++){Ct[Ct.errorTypes[Et]]=Et;Ct.prototype[Ct.errorTypes[Et]]=Et}var At=Lt;function Lt(e,t){var i;var r=null;try{i=JSON.parse(e,t)}catch(e){r=e}return[r,i]}function It(e){return e!==undefined&&e!==null&&typeof e.then==="function"}function Ot(e){if(It(e)){e.then(null,function(e){})}}var Pt=function e(r){var t=["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(e,t,i){if(r[t]){e[t]=r[t]}return e},{cues:r.cues&&Array.prototype.map.call(r.cues,function(e){return{startTime:e.startTime,endTime:e.endTime,text:e.text,id:e.id}})});return t};var Ut=function e(t){var i=t.$$("track");var r=Array.prototype.map.call(i,function(e){return e.track});var n=Array.prototype.map.call(i,function(e){var t=Pt(e.track);if(e.src){t.src=e.src}return t});return n.concat(Array.prototype.filter.call(t.textTracks(),function(e){return r.indexOf(e)===-1}).map(Pt))};var Dt=function e(t,i){t.forEach(function(e){var t=i.addRemoteTextTrack(e).track;if(!e.src&&e.cues){e.cues.forEach(function(e){return t.addCue(e)})}});return i.textTracks()};var xt={textTracksToJson:Ut,jsonToTextTracks:Dt,trackToJson_:Pt};var Rt="vjs-modal-dialog";var Mt=27;var Bt=function(r){o(e,r);function e(e,t){var i;i=r.call(this,e,t)||this;i.opened_=i.hasBeenOpened_=i.hasBeenFilled_=false;i.closeable(!i.options_.uncloseable);i.content(i.options_.content);i.contentEl_=U("div",{className:Rt+"-content"},{role:"document"});i.descEl_=U("p",{className:Rt+"-description vjs-control-text",id:i.el().getAttribute("aria-describedby")});D(i.descEl_,i.description());i.el_.appendChild(i.descEl_);i.el_.appendChild(i.contentEl_);return i}var t=e.prototype;t.createEl=function e(){return r.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})};t.dispose=function e(){this.contentEl_=null;this.descEl_=null;this.previouslyActiveEl_=null;r.prototype.dispose.call(this)};t.buildCSSClass=function e(){return Rt+" vjs-hidden "+r.prototype.buildCSSClass.call(this)};t.handleKeyPress=function e(t){if(t.which===Mt&&this.closeable()){this.close()}};t.label=function e(){return this.localize(this.options_.label||"Modal Window")};t.description=function e(){var t=this.options_.description||this.localize("This is a modal window.");if(this.closeable()){t+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")}return t};t.open=function e(){if(!this.opened_){var t=this.player();this.trigger("beforemodalopen");this.opened_=true;if(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_){this.fill()}this.wasPlaying_=!t.paused();if(this.options_.pauseOnOpen&&this.wasPlaying_){t.pause()}if(this.closeable()){this.on(this.el_.ownerDocument,"keydown",Ae(this,this.handleKeyPress))}this.hadControls_=t.controls();t.controls(false);this.show();this.conditionalFocus_();this.el().setAttribute("aria-hidden","false");this.trigger("modalopen");this.hasBeenOpened_=true}};t.opened=function e(t){if(typeof t==="boolean"){this[t?"open":"close"]()}return this.opened_};t.close=function e(){if(!this.opened_){return}var t=this.player();this.trigger("beforemodalclose");this.opened_=false;if(this.wasPlaying_&&this.options_.pauseOnOpen){t.play()}if(this.closeable()){this.off(this.el_.ownerDocument,"keydown",Ae(this,this.handleKeyPress))}if(this.hadControls_){t.controls(true)}this.hide();this.el().setAttribute("aria-hidden","true");this.trigger("modalclose");this.conditionalBlur_();if(this.options_.temporary){this.dispose()}};t.closeable=function e(t){if(typeof t==="boolean"){var e=this.closeable_=!!t;var i=this.getChild("closeButton");if(e&&!i){var r=this.contentEl_;this.contentEl_=this.el_;i=this.addChild("closeButton",{controlText:"Close Modal Dialog"});this.contentEl_=r;this.on(i,"close",this.close)}if(!e&&i){this.off(i,"close",this.close);this.removeChild(i);i.dispose()}}return this.closeable_};t.fill=function e(){this.fillWith(this.content())};t.fillWith=function e(t){var i=this.contentEl();var r=i.parentNode;var n=i.nextSibling;this.trigger("beforemodalfill");this.hasBeenFilled_=true;r.removeChild(i);this.empty();Z(i,t);this.trigger("modalfill");if(n){r.insertBefore(i,n)}else{r.appendChild(i)}var a=this.getChild("closeButton");if(a){r.appendChild(a.el_)}};t.empty=function e(){this.trigger("beforemodalempty");K(this.contentEl());this.trigger("modalempty")};t.content=function e(t){if(typeof t!=="undefined"){this.content_=t}return this.content_};t.conditionalFocus_=function e(){var t=h.activeElement;var i=this.player_.el_;this.previouslyActiveEl_=null;if(i.contains(t)||i===t){this.previouslyActiveEl_=t;this.focus();this.on(h,"keydown",this.handleKeyDown)}};t.conditionalBlur_=function e(){if(this.previouslyActiveEl_){this.previouslyActiveEl_.focus();this.previouslyActiveEl_=null}this.off(h,"keydown",this.handleKeyDown)};t.handleKeyDown=function e(t){if(t.which!==9){return}var i=this.focusableEls_();var r=this.el_.querySelector(":focus");var n;for(var a=0;a<i.length;a++){if(r===i[a]){n=a;break}}if(h.activeElement===this.el_){n=0}if(t.shiftKey&&n===0){i[i.length-1].focus();t.preventDefault()}else if(!t.shiftKey&&n===i.length-1){i[0].focus();t.preventDefault()}};t.focusableEls_=function e(){var t=this.el_.querySelectorAll("*");return Array.prototype.filter.call(t,function(e){return(e instanceof _.HTMLAnchorElement||e instanceof _.HTMLAreaElement)&&e.hasAttribute("href")||(e instanceof _.HTMLInputElement||e instanceof _.HTMLSelectElement||e instanceof _.HTMLTextAreaElement||e instanceof _.HTMLButtonElement)&&!e.hasAttribute("disabled")||e instanceof _.HTMLIFrameElement||e instanceof _.HTMLObjectElement||e instanceof _.HTMLEmbedElement||e.hasAttribute("tabindex")&&e.getAttribute("tabindex")!==-1||e.hasAttribute("contenteditable")})};return e}(Xe);Bt.prototype.options_={pauseOnOpen:true,temporary:true};Xe.registerComponent("ModalDialog",Bt);var Nt=function(r){o(e,r);function e(e){var t;if(e===void 0){e=[]}t=r.call(this)||this;t.tracks_=[];Object.defineProperty(p(p(t)),"length",{get:function e(){return this.tracks_.length}});for(var i=0;i<e.length;i++){t.addTrack(e[i])}return t}var t=e.prototype;t.addTrack=function e(t){var i=this.tracks_.length;if(!(""+i in this)){Object.defineProperty(this,i,{get:function e(){return this.tracks_[i]}})}if(this.tracks_.indexOf(t)===-1){this.tracks_.push(t);this.trigger({track:t,type:"addtrack"})}};t.removeTrack=function e(t){var i;for(var r=0,n=this.length;r<n;r++){if(this[r]===t){i=this[r];if(i.off){i.off()}this.tracks_.splice(r,1);break}}if(!i){return}this.trigger({track:i,type:"removetrack"})};t.getTrackById=function e(t){var i=null;for(var r=0,n=this.length;r<n;r++){var a=this[r];if(a.id===t){i=a;break}}return i};return e}(Oe);Nt.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"};for(var jt in Nt.prototype.allowedEvents_){Nt.prototype["on"+jt]=null}var Ft=function e(t,i){for(var r=0;r<t.length;r++){if(!Object.keys(t[r]).length||i.id===t[r].id){continue}t[r].enabled=false}};var Vt=function(r){o(e,r);function e(e){var t;if(e===void 0){e=[]}for(var i=e.length-1;i>=0;i--){if(e[i].enabled){Ft(e,e[i]);break}}t=r.call(this,e)||this;t.changing_=false;return t}var t=e.prototype;t.addTrack=function e(t){var i=this;if(t.enabled){Ft(this,t)}r.prototype.addTrack.call(this,t);if(!t.addEventListener){return}t.addEventListener("enabledchange",function(){if(i.changing_){return}i.changing_=true;Ft(i,t);i.changing_=false;i.trigger("change")})};return e}(Nt);var Ht=function e(t,i){for(var r=0;r<t.length;r++){if(!Object.keys(t[r]).length||i.id===t[r].id){continue}t[r].selected=false}};var qt=function(r){o(e,r);function e(e){var t;if(e===void 0){e=[]}for(var i=e.length-1;i>=0;i--){if(e[i].selected){Ht(e,e[i]);break}}t=r.call(this,e)||this;t.changing_=false;Object.defineProperty(p(p(t)),"selectedIndex",{get:function e(){for(var t=0;t<this.length;t++){if(this[t].selected){return t}}return-1},set:function e(){}});return t}var t=e.prototype;t.addTrack=function e(t){var i=this;if(t.selected){Ht(this,t)}r.prototype.addTrack.call(this,t);if(!t.addEventListener){return}t.addEventListener("selectedchange",function(){if(i.changing_){return}i.changing_=true;Ht(i,t);i.changing_=false;i.trigger("change")})};return e}(Nt);var zt=function(r){o(e,r);function e(){return r.apply(this,arguments)||this}var t=e.prototype;t.addTrack=function e(t){r.prototype.addTrack.call(this,t);t.addEventListener("modechange",Ae(this,function(){this.queueTrigger("change")}));var i=["metadata","chapters"];if(i.indexOf(t.kind)===-1){t.addEventListener("modechange",Ae(this,function(){this.trigger("selectedlanguagechange")}))}};return e}(Nt);var Wt=function(){function e(e){if(e===void 0){e=[]}this.trackElements_=[];Object.defineProperty(this,"length",{get:function e(){return this.trackElements_.length}});for(var t=0,i=e.length;t<i;t++){this.addTrackElement_(e[t])}}var t=e.prototype;t.addTrackElement_=function e(t){var i=this.trackElements_.length;if(!(""+i in this)){Object.defineProperty(this,i,{get:function e(){return this.trackElements_[i]}})}if(this.trackElements_.indexOf(t)===-1){this.trackElements_.push(t)}};t.getTrackElementByTrack_=function e(t){var i;for(var r=0,n=this.trackElements_.length;r<n;r++){if(t===this.trackElements_[r].track){i=this.trackElements_[r];break}}return i};t.removeTrackElement_=function e(t){for(var i=0,r=this.trackElements_.length;i<r;i++){if(t===this.trackElements_[i]){this.trackElements_.splice(i,1);break}}};return e}();var Gt=function(){function t(e){t.prototype.setCues_.call(this,e);Object.defineProperty(this,"length",{get:function e(){return this.length_}})}var e=t.prototype;e.setCues_=function e(t){var i=this.length||0;var r=0;var n=t.length;this.cues_=t;this.length_=t.length;var a=function e(t){if(!(""+t in this)){Object.defineProperty(this,""+t,{get:function e(){return this.cues_[t]}})}};if(i<n){r=i;for(;r<n;r++){a.call(this,r)}}};e.getCueById=function e(t){var i=null;for(var r=0,n=this.length;r<n;r++){var a=this[r];if(a.id===t){i=a;break}}return i};return t}();var Xt={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"};var Yt={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"};var $t={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"};var Kt={disabled:"disabled",hidden:"hidden",showing:"showing"};var Jt=function(a){o(e,a);function e(e){var i;if(e===void 0){e={}}i=a.call(this)||this;var r={id:e.id||"vjs_track_"+ae(),kind:e.kind||"",label:e.label||"",language:e.language||""};var t=function e(t){Object.defineProperty(p(p(i)),t,{get:function e(){return r[t]},set:function e(){}})};for(var n in r){t(n)}return i}return e}(Oe);var Qt=function e(t){var i=["protocol","hostname","port","pathname","search","hash","host"];var r=h.createElement("a");r.href=t;var n=r.host===""&&r.protocol!=="file:";var a;if(n){a=h.createElement("div");a.innerHTML='<a href="'+t+'"></a>';r=a.firstChild;a.setAttribute("style","display:none; position:absolute;");h.body.appendChild(a)}var s={};for(var o=0;o<i.length;o++){s[i[o]]=r[i[o]]}if(s.protocol==="http:"){s.host=s.host.replace(/:80$/,"")}if(s.protocol==="https:"){s.host=s.host.replace(/:443$/,"")}if(!s.protocol){s.protocol=_.location.protocol}if(n){h.body.removeChild(a)}return s};var Zt=function e(t){if(!t.match(/^https?:\/\//)){var i=h.createElement("div");i.innerHTML='<a href="'+t+'">x</a>';t=i.firstChild.href}return t};var ei=function e(t){if(typeof t==="string"){var i=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/i;var r=i.exec(t);if(r){return r.pop().toLowerCase()}}return""};var ti=function e(t){var i=_.location;var r=Qt(t);var n=r.protocol===":"?i.protocol:r.protocol;var a=n+r.host!==i.protocol+i.host;return a};var ii=Object.freeze({parseUrl:Qt,getAbsoluteURL:Zt,getFileExtension:ei,isCrossOrigin:ti});var ri=ai;var ni=Object.prototype.toString;function ai(e){var t=ni.call(e);return t==="[object Function]"||typeof e==="function"&&t!=="[object RegExp]"||typeof window!=="undefined"&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)}var si=typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function oi(e,t){return t={exports:{}},e(t,t.exports),t.exports}var ui=oi(function(e,t){t=e.exports=i;function i(e){return e.replace(/^\s*|\s*$/g,"")}t.left=function(e){return e.replace(/^\s*/,"")};t.right=function(e){return e.replace(/\s*$/,"")}});var li=ui.left;var ci=ui.right;var fi=Function.prototype.toString;var hi=/^\s*class\b/;var di=function e(t){try{var i=fi.call(t);return hi.test(i)}catch(e){return false}};var pi=function e(t){try{if(di(t)){return false}fi.call(t);return true}catch(e){return false}};var mi=Object.prototype.toString;var vi="[object Function]";var gi="[object GeneratorFunction]";var yi=typeof Symbol==="function"&&typeof Symbol.toStringTag==="symbol";var _i=function e(t){if(!t){return false}if(typeof t!=="function"&&typeof t!=="object"){return false}if(typeof t==="function"&&!t.prototype){return true}if(yi){return pi(t)}if(di(t)){return false}var i=mi.call(t);return i===vi||i===gi};var bi=Object.prototype.toString;var Ti=Object.prototype.hasOwnProperty;var Si=function e(t,i,r){for(var n=0,a=t.length;n<a;n++){if(Ti.call(t,n)){if(r==null){i(t[n],n,t)}else{i.call(r,t[n],n,t)}}}};var ki=function e(t,i,r){for(var n=0,a=t.length;n<a;n++){if(r==null){i(t.charAt(n),n,t)}else{i.call(r,t.charAt(n),n,t)}}};var wi=function e(t,i,r){for(var n in t){if(Ti.call(t,n)){if(r==null){i(t[n],n,t)}else{i.call(r,t[n],n,t)}}}};var Ci=function e(t,i,r){if(!_i(i)){throw new TypeError("iterator must be a function")}var n;if(arguments.length>=3){n=r}if(bi.call(t)==="[object Array]"){Si(t,i,n)}else if(typeof t==="string"){ki(t,i,n)}else{wi(t,i,n)}};var Ei=Ci;var Ai=function e(t){return Object.prototype.toString.call(t)==="[object Array]"};var Li=function e(t){if(!t)return{};var n={};Ei(ui(t).split("\n"),function(e){var t=e.indexOf(":"),i=ui(e.slice(0,t)).toLowerCase(),r=ui(e.slice(t+1));if(typeof n[i]==="undefined"){n[i]=r}else if(Ai(n[i])){n[i].push(r)}else{n[i]=[n[i],r]}});return n};var Ii=Pi;var Oi=Object.prototype.hasOwnProperty;function Pi(){var e={};for(var t=0;t<arguments.length;t++){var i=arguments[t];for(var r in i){if(Oi.call(i,r)){e[r]=i[r]}}}return e}var Ui=Mi;Mi.XMLHttpRequest=_.XMLHttpRequest||ji;Mi.XDomainRequest="withCredentials"in new Mi.XMLHttpRequest?Mi.XMLHttpRequest:_.XDomainRequest;Di(["get","put","post","patch","head","delete"],function(r){Mi[r==="delete"?"del":r]=function(e,t,i){t=Ri(e,t,i);t.method=r.toUpperCase();return Bi(t)}});function Di(e,t){for(var i=0;i<e.length;i++){t(e[i])}}function xi(e){for(var t in e){if(e.hasOwnProperty(t))return false}return true}function Ri(e,t,i){var r=e;if(ri(t)){i=t;if(typeof e==="string"){r={uri:e}}}else{r=Ii(t,{uri:e})}r.callback=i;return r}function Mi(e,t,i){t=Ri(e,t,i);return Bi(t)}function Bi(n){if(typeof n.callback==="undefined"){throw new Error("callback argument missing")}var a=false;var r=function e(t,i,r){if(!a){a=true;n.callback(t,i,r)}};function e(){if(o.readyState===4){setTimeout(i,0)}}function s(){var e=undefined;if(o.response){e=o.response}else{e=o.responseText||Ni(o)}if(m){try{e=JSON.parse(e)}catch(e){}}return e}function t(e){clearTimeout(v);if(!(e instanceof Error)){e=new Error(""+(e||"Unknown XMLHttpRequest Error"))}e.statusCode=0;return r(e,g)}function i(){if(l)return;var e;clearTimeout(v);if(n.useXDR&&o.status===undefined){e=200}else{e=o.status===1223?204:o.status}var t=g;var i=null;if(e!==0){t={body:s(),statusCode:e,method:f,headers:{},url:c,rawRequest:o};if(o.getAllResponseHeaders){t.headers=Li(o.getAllResponseHeaders())}}else{i=new Error("Internal XMLHttpRequest Error")}return r(i,t,t.body)}var o=n.xhr||null;if(!o){if(n.cors||n.useXDR){o=new Mi.XDomainRequest}else{o=new Mi.XMLHttpRequest}}var u;var l;var c=o.url=n.uri||n.url;var f=o.method=n.method||"GET";var h=n.body||n.data;var d=o.headers=n.headers||{};var p=!!n.sync;var m=false;var v;var g={body:undefined,headers:{},statusCode:0,method:f,url:c,rawRequest:o};if("json"in n&&n.json!==false){m=true;d["accept"]||d["Accept"]||(d["Accept"]="application/json");if(f!=="GET"&&f!=="HEAD"){d["content-type"]||d["Content-Type"]||(d["Content-Type"]="application/json");h=JSON.stringify(n.json===true?h:n.json)}}o.onreadystatechange=e;o.onload=i;o.onerror=t;o.onprogress=function(){};o.onabort=function(){l=true};o.ontimeout=t;o.open(f,c,!p,n.username,n.password);if(!p){o.withCredentials=!!n.withCredentials}if(!p&&n.timeout>0){v=setTimeout(function(){if(l)return;l=true;o.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT";t(e)},n.timeout)}if(o.setRequestHeader){for(u in d){if(d.hasOwnProperty(u)){o.setRequestHeader(u,d[u])}}}else if(n.headers&&!xi(n.headers)){throw new Error("Headers cannot be set on an XDomainRequest object")}if("responseType"in n){o.responseType=n.responseType}if("beforeSend"in n&&typeof n.beforeSend==="function"){n.beforeSend(o)}o.send(h||null);return o}function Ni(e){if(e.responseType==="document"){return e.responseXML}var t=e.responseXML&&e.responseXML.documentElement.nodeName==="parsererror";if(e.responseType===""&&!t){return e.responseXML}return null}function ji(){}var Fi=function e(t,i){var r=new _.WebVTT.Parser(_,_.vttjs,_.WebVTT.StringDecoder());var n=[];r.oncue=function(e){i.addCue(e)};r.onparsingerror=function(e){n.push(e)};r.onflush=function(){i.trigger({type:"loadeddata",target:i})};r.parse(t);if(n.length>0){if(_.console&&_.console.groupCollapsed){_.console.groupCollapsed("Text Track parsing errors for "+i.src)}n.forEach(function(e){return m.error(e)});if(_.console&&_.console.groupEnd){_.console.groupEnd()}}r.flush()};var Vi=function e(t,n){var i={uri:t};var r=ti(t);if(r){i.cors=r}Ui(i,Ae(this,function(e,t,i){if(e){return m.error(e,t)}n.loaded_=true;if(typeof _.WebVTT!=="function"){if(n.tech_){var r=function e(){return Fi(i,n)};n.tech_.on("vttjsloaded",r);n.tech_.on("vttjserror",function(){m.error("vttjs failed to load, stopping trying to process "+n.src);n.tech_.off("vttjsloaded",r)})}}else{Fi(i,n)}}))};var Hi=function(l){o(e,l);function e(e){var t;if(e===void 0){e={}}if(!e.tech){throw new Error("A tech was not provided.")}var i=Ge(e,{kind:$t[e.kind]||"subtitles",language:e.language||e.srclang||""});var r=Kt[i.mode]||"disabled";var n=i.default;if(i.kind==="metadata"||i.kind==="chapters"){r="hidden"}t=l.call(this,i)||this;t.tech_=i.tech;t.cues_=[];t.activeCues_=[];var a=new Gt(t.cues_);var o=new Gt(t.activeCues_);var u=false;var s=Ae(p(p(t)),function(){this.activeCues=this.activeCues;if(u){this.trigger("cuechange");u=false}});if(r!=="disabled"){t.tech_.ready(function(){t.tech_.on("timeupdate",s)},true)}Object.defineProperties(p(p(t)),{default:{get:function e(){return n},set:function e(){}},mode:{get:function e(){return r},set:function e(t){var i=this;if(!Kt[t]){return}r=t;if(r!=="disabled"){this.tech_.ready(function(){i.tech_.on("timeupdate",s)},true)}else{this.tech_.off("timeupdate",s)}this.trigger("modechange")}},cues:{get:function e(){if(!this.loaded_){return null}return a},set:function e(){}},activeCues:{get:function e(){if(!this.loaded_){return null}if(this.cues.length===0){return o}var t=this.tech_.currentTime();var i=[];for(var r=0,n=this.cues.length;r<n;r++){var a=this.cues[r];if(a.startTime<=t&&a.endTime>=t){i.push(a)}else if(a.startTime===a.endTime&&a.startTime<=t&&a.startTime+.5>=t){i.push(a)}}u=false;if(i.length!==this.activeCues_.length){u=true}else{for(var s=0;s<i.length;s++){if(this.activeCues_.indexOf(i[s])===-1){u=true}}}this.activeCues_=i;o.setCues_(this.activeCues_);return o},set:function e(){}}});if(i.src){t.src=i.src;Vi(i.src,p(p(t)))}else{t.loaded_=true}return t}var t=e.prototype;t.addCue=function e(t){var i=t;if(_.vttjs&&!(t instanceof _.vttjs.VTTCue)){i=new _.vttjs.VTTCue(t.startTime,t.endTime,t.text);for(var r in t){if(!(r in i)){i[r]=t[r]}}i.id=t.id;i.originalCue_=t}var n=this.tech_.textTracks();for(var a=0;a<n.length;a++){if(n[a]!==this){n[a].removeCue(i)}}this.cues_.push(i);this.cues.setCues_(this.cues_)};t.removeCue=function e(t){var i=this.cues_.length;while(i--){var r=this.cues_[i];if(r===t||r.originalCue_&&r.originalCue_===t){this.cues_.splice(i,1);this.cues.setCues_(this.cues_);break}}};return e}(Jt);Hi.prototype.allowedEvents_={cuechange:"cuechange"};var qi=function(n){o(e,n);function e(e){var t;if(e===void 0){e={}}var i=Ge(e,{kind:Yt[e.kind]||""});t=n.call(this,i)||this;var r=false;Object.defineProperty(p(p(t)),"enabled",{get:function e(){return r},set:function e(t){if(typeof t!=="boolean"||t===r){return}r=t;this.trigger("enabledchange")}});if(i.enabled){t.enabled=i.enabled}t.loaded_=true;return t}return e}(Jt);var zi=function(n){o(e,n);function e(e){var t;if(e===void 0){e={}}var i=Ge(e,{kind:Xt[e.kind]||""});t=n.call(this,i)||this;var r=false;Object.defineProperty(p(p(t)),"selected",{get:function e(){return r},set:function e(t){if(typeof t!=="boolean"||t===r){return}r=t;this.trigger("selectedchange")}});if(i.selected){t.selected=i.selected}return t}return e}(Jt);var Wi=0;var Gi=1;var Xi=2;var Yi=3;var $i=function(n){o(e,n);function e(e){var t;if(e===void 0){e={}}t=n.call(this)||this;var i;var r=new Hi(e);t.kind=r.kind;t.src=r.src;t.srclang=r.language;t.label=r.label;t.default=r.default;Object.defineProperties(p(p(t)),{readyState:{get:function e(){return i}},track:{get:function e(){return r}}});i=Wi;r.addEventListener("loadeddata",function(){i=Xi;t.trigger({type:"load",target:p(p(t))})});return t}return e}(Oe);$i.prototype.allowedEvents_={load:"load"};$i.NONE=Wi;$i.LOADING=Gi;$i.LOADED=Xi;$i.ERROR=Yi;var Ki={audio:{ListClass:Vt,TrackClass:qi,capitalName:"Audio"},video:{ListClass:qt,TrackClass:zi,capitalName:"Video"},text:{ListClass:zt,TrackClass:Hi,capitalName:"Text"}};Object.keys(Ki).forEach(function(e){Ki[e].getterName=e+"Tracks";Ki[e].privateName=e+"Tracks_"});var Ji={remoteText:{ListClass:zt,TrackClass:Hi,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:Wt,TrackClass:$i,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}};var Qi=Ge(Ki,Ji);Ji.names=Object.keys(Ji);Ki.names=Object.keys(Ki);Qi.names=[].concat(Ji.names).concat(Ki.names);var Zi=Object.create||function(){function t(){}return function(e){if(arguments.length!==1){throw new Error("Object.create shim only accepts one parameter.")}t.prototype=e;return new t}}();function er(e,t){this.name="ParsingError";this.code=e.code;this.message=t||e.message}er.prototype=Zi(Error.prototype);er.prototype.constructor=er;er.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}};function tr(e){function t(e,t,i,r){return(e|0)*3600+(t|0)*60+(i|0)+(r|0)/1e3}var i=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);if(!i){return null}if(i[3]){return t(i[1],i[2],i[3].replace(":",""),i[4])}else if(i[1]>59){return t(i[1],i[2],0,i[4])}else{return t(0,i[1],i[2],i[4])}}function ir(){this.values=Zi(null)}ir.prototype={set:function e(t,i){if(!this.get(t)&&i!==""){this.values[t]=i}},get:function e(t,i,r){if(r){return this.has(t)?this.values[t]:i[r]}return this.has(t)?this.values[t]:i},has:function e(t){return t in this.values},alt:function e(t,i,r){for(var n=0;n<r.length;++n){if(i===r[n]){this.set(t,i);break}}},integer:function e(t,i){if(/^-?\d+$/.test(i)){this.set(t,parseInt(i,10))}},percent:function e(t,i){var r;if(r=i.match(/^([\d]{1,3})(\.[\d]*)?%$/)){i=parseFloat(i);if(i>=0&&i<=100){this.set(t,i);return true}}return false}};function rr(e,t,i,r){var n=r?e.split(r):[e];for(var a in n){if(typeof n[a]!=="string"){continue}var s=n[a].split(i);if(s.length!==2){continue}var o=s[0];var u=s[1];t(o,u)}}function nr(t,e,s){var i=t;function r(){var e=tr(t);if(e===null){throw new er(er.Errors.BadTimeStamp,"Malformed timestamp: "+i)}t=t.replace(/^[^\sa-zA-Z-]+/,"");return e}function n(e,t){var a=new ir;rr(e,function(e,t){switch(e){case"region":for(var i=s.length-1;i>=0;i--){if(s[i].id===t){a.set(e,s[i].region);break}}break;case"vertical":a.alt(e,t,["rl","lr"]);break;case"line":var r=t.split(","),n=r[0];a.integer(e,n);a.percent(e,n)?a.set("snapToLines",false):null;a.alt(e,n,["auto"]);if(r.length===2){a.alt("lineAlign",r[1],["start","middle","end"])}break;case"position":r=t.split(",");a.percent(e,r[0]);if(r.length===2){a.alt("positionAlign",r[1],["start","middle","end"])}break;case"size":a.percent(e,t);break;case"align":a.alt(e,t,["start","middle","end","left","right"]);break}},/:/,/\s/);t.region=a.get("region",null);t.vertical=a.get("vertical","");t.line=a.get("line","auto");t.lineAlign=a.get("lineAlign","start");t.snapToLines=a.get("snapToLines",true);t.size=a.get("size",100);t.align=a.get("align","middle");t.position=a.get("position",{start:0,left:0,middle:50,end:100,right:100},t.align);t.positionAlign=a.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},t.align)}function a(){t=t.replace(/^\s+/,"")}a();e.startTime=r();a();if(t.substr(0,3)!=="--\x3e"){throw new er(er.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+i)}t=t.substr(3);a();e.endTime=r();a();n(t,e)}var ar={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"‎","&rlm;":"‏","&nbsp;":" "};var sr={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"};var or={v:"title",lang:"lang"};var ur={rt:"ruby"};function lr(a,i){function e(){if(!i){return null}function e(e){i=i.substr(e.length);return e}var t=i.match(/^([^<]*)(<[^>]*>?)?/);return e(t[1]?t[1]:t[2])}function t(e){return ar[e]}function r(e){while(d=e.match(/&(amp|lt|gt|lrm|rlm|nbsp);/)){e=e.replace(d[0],t)}return e}function n(e,t){return!ur[t.localName]||ur[t.localName]===e.localName}function s(e,t){var i=sr[e];if(!i){return null}var r=a.document.createElement(i);r.localName=i;var n=or[e];if(n&&t){r[n]=t.trim()}return r}var o=a.document.createElement("div"),u=o,l,c=[];while((l=e())!==null){if(l[0]==="<"){if(l[1]==="/"){if(c.length&&c[c.length-1]===l.substr(2).replace(">","")){c.pop();u=u.parentNode}continue}var f=tr(l.substr(1,l.length-2));var h;if(f){h=a.document.createProcessingInstruction("timestamp",f);u.appendChild(h);continue}var d=l.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!d){continue}h=s(d[1],d[3]);if(!h){continue}if(!n(u,h)){continue}if(d[2]){h.className=d[2].substr(1).replace("."," ")}c.push(d[1]);u.appendChild(h);u=h;continue}u.appendChild(a.document.createTextNode(r(l)))}return o}var cr=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function fr(e){for(var t=0;t<cr.length;t++){var i=cr[t];if(e>=i[0]&&e<=i[1]){return true}}return false}function hr(e){var t=[],i="",r;if(!e||!e.childNodes){return"ltr"}function n(e,t){for(var i=t.childNodes.length-1;i>=0;i--){e.push(t.childNodes[i])}}function a(e){if(!e||!e.length){return null}var t=e.pop(),i=t.textContent||t.innerText;if(i){var r=i.match(/^.*(\n|\r)/);if(r){e.length=0;return r[0]}return i}if(t.tagName==="ruby"){return a(e)}if(t.childNodes){n(e,t);return a(e)}}n(t,e);while(i=a(t)){for(var s=0;s<i.length;s++){r=i.charCodeAt(s);if(fr(r)){return"rtl"}}}return"ltr"}function dr(e){if(typeof e.line==="number"&&(e.snapToLines||e.line>=0&&e.line<=100)){return e.line}if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement){return-1}var t=e.track,i=t.textTrackList,r=0;for(var n=0;n<i.length&&i[n]!==t;n++){if(i[n].mode==="showing"){r++}}return++r*-1}function pr(){}pr.prototype.applyStyles=function(e,t){t=t||this.div;for(var i in e){if(e.hasOwnProperty(i)){t.style[i]=e[i]}}};pr.prototype.formatStyle=function(e,t){return e===0?0:e+t};function mr(e,t,i){pr.call(this);this.cue=t;this.cueDiv=lr(e,t.text);var r={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:t.vertical===""?"horizontal-tb":t.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(r,this.cueDiv);this.div=e.document.createElement("div");r={direction:hr(this.cueDiv),writingMode:t.vertical===""?"horizontal-tb":t.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:t.align==="middle"?"center":t.align,font:i.font,whiteSpace:"pre-line",position:"absolute"};this.applyStyles(r);this.div.appendChild(this.cueDiv);var n=0;switch(t.positionAlign){case"start":n=t.position;break;case"middle":n=t.position-t.size/2;break;case"end":n=t.position-t.size;break}if(t.vertical===""){this.applyStyles({left:this.formatStyle(n,"%"),width:this.formatStyle(t.size,"%")})}else{this.applyStyles({top:this.formatStyle(n,"%"),height:this.formatStyle(t.size,"%")})}this.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})}}mr.prototype=Zi(pr.prototype);mr.prototype.constructor=mr;function vr(e){var t,i,r,n;if(e.div){i=e.div.offsetHeight;r=e.div.offsetWidth;n=e.div.offsetTop;var a=(a=e.div.childNodes)&&(a=a[0])&&a.getClientRects&&a.getClientRects();e=e.div.getBoundingClientRect();t=a?Math.max(a[0]&&a[0].height||0,e.height/a.length):0}this.left=e.left;this.right=e.right;this.top=e.top||n;this.height=e.height||i;this.bottom=e.bottom||n+(e.height||i);this.width=e.width||r;this.lineHeight=t!==undefined?t:e.lineHeight}vr.prototype.move=function(e,t){t=t!==undefined?t:this.lineHeight;switch(e){case"+x":this.left+=t;this.right+=t;break;case"-x":this.left-=t;this.right-=t;break;case"+y":this.top+=t;this.bottom+=t;break;case"-y":this.top-=t;this.bottom-=t;break}};vr.prototype.overlaps=function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top};vr.prototype.overlapsAny=function(e){for(var t=0;t<e.length;t++){if(this.overlaps(e[t])){return true}}return false};vr.prototype.within=function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right};vr.prototype.overlapsOppositeAxis=function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}};vr.prototype.intersectPercentage=function(e){var t=Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left)),i=Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top)),r=t*i;return r/(this.height*this.width)};vr.prototype.toCSSCompatValues=function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}};vr.getSimpleBoxPosition=function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0;var i=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0;var r=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e;var n={left:e.left,right:e.right,top:e.top||r,height:e.height||t,bottom:e.bottom||r+(e.height||t),width:e.width||i};return n};function gr(e,t,o,u){function i(e,t){var i,r=new vr(e),n=1;for(var a=0;a<t.length;a++){while(e.overlapsOppositeAxis(o,t[a])||e.within(o)&&e.overlapsAny(u)){e.move(t[a])}if(e.within(o)){return e}var s=e.intersectPercentage(o);if(n>s){i=new vr(e);n=s}e=new vr(r)}return i||r}var r=new vr(t),n=t.cue,a=dr(n),s=[];if(n.snapToLines){var l;switch(n.vertical){case"":s=["+y","-y"];l="height";break;case"rl":s=["+x","-x"];l="width";break;case"lr":s=["-x","+x"];l="width";break}var c=r.lineHeight,f=c*Math.round(a),h=o[l]+c,d=s[0];if(Math.abs(f)>h){f=f<0?-1:1;f*=Math.ceil(h/c)*c}if(a<0){f+=n.vertical===""?o.height:o.width;s=s.reverse()}r.move(d,f)}else{var p=r.lineHeight/o.height*100;switch(n.lineAlign){case"middle":a-=p/2;break;case"end":a-=p;break}switch(n.vertical){case"":t.applyStyles({top:t.formatStyle(a,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(a,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(a,"%")});break}s=["+y","-x","+x","-y"];r=new vr(t)}var m=i(r,s);t.move(m.toCSSCompatValues(o))}function yr(){}yr.StringDecoder=function(){return{decode:function e(t){if(!t){return""}if(typeof t!=="string"){throw new Error("Error - expected string data.")}return decodeURIComponent(encodeURIComponent(t))}}};yr.convertCueToDOMTree=function(e,t){if(!e||!t){return null}return lr(e,t)};var _r=.05;var br="sans-serif";var Tr="1.5%";yr.processCues=function(r,n,e){if(!r||!n||!e){return null}while(e.firstChild){e.removeChild(e.firstChild)}var a=r.document.createElement("div");a.style.position="absolute";a.style.left="0";a.style.right="0";a.style.top="0";a.style.bottom="0";a.style.margin=Tr;e.appendChild(a);function t(e){for(var t=0;t<e.length;t++){if(e[t].hasBeenReset||!e[t].displayState){return true}}return false}if(!t(n)){for(var i=0;i<n.length;i++){a.appendChild(n[i].displayState)}return}var s=[],o=vr.getSimpleBoxPosition(a),u=Math.round(o.height*_r*100)/100;var l={font:u+"px "+br};(function(){var e,t;for(var i=0;i<n.length;i++){t=n[i];e=new mr(r,t,l);a.appendChild(e.div);gr(r,e,o,s);t.displayState=e.div;s.push(vr.getSimpleBoxPosition(e))}})()};yr.Parser=function(e,t,i){if(!i){i=t;t={}}if(!t){t={}}this.window=e;this.vttjs=t;this.state="INITIAL";this.buffer="";this.decoder=i||new TextDecoder("utf8");this.regionList=[]};yr.Parser.prototype={reportOrThrowError:function e(t){if(t instanceof er){this.onparsingerror&&this.onparsingerror(t)}else{throw t}},parse:function e(t){var r=this;if(t){r.buffer+=r.decoder.decode(t,{stream:true})}function i(){var e=r.buffer;var t=0;while(t<e.length&&e[t]!=="\r"&&e[t]!=="\n"){++t}var i=e.substr(0,t);if(e[t]==="\r"){++t}if(e[t]==="\n"){++t}r.buffer=e.substr(t);return i}function n(e){var n=new ir;rr(e,function(e,t){switch(e){case"id":n.set(e,t);break;case"width":n.percent(e,t);break;case"lines":n.integer(e,t);break;case"regionanchor":case"viewportanchor":var i=t.split(",");if(i.length!==2){break}var r=new ir;r.percent("x",i[0]);r.percent("y",i[1]);if(!r.has("x")||!r.has("y")){break}n.set(e+"X",r.get("x"));n.set(e+"Y",r.get("y"));break;case"scroll":n.alt(e,t,["up"]);break}},/=/,/\s/);if(n.has("id")){var t=new(r.vttjs.VTTRegion||r.window.VTTRegion);t.width=n.get("width",100);t.lines=n.get("lines",3);t.regionAnchorX=n.get("regionanchorX",0);t.regionAnchorY=n.get("regionanchorY",100);t.viewportAnchorX=n.get("viewportanchorX",0);t.viewportAnchorY=n.get("viewportanchorY",100);t.scroll=n.get("scroll","");r.onregion&&r.onregion(t);r.regionList.push({id:n.get("id"),region:t})}}function a(e){var i=new ir;rr(e,function(e,t){switch(e){case"MPEGT":i.integer(e+"S",t);break;case"LOCA":i.set(e+"L",tr(t));break}},/[^\d]:/,/,/);r.ontimestampmap&&r.ontimestampmap({MPEGTS:i.get("MPEGTS"),LOCAL:i.get("LOCAL")})}function s(e){if(e.match(/X-TIMESTAMP-MAP/)){rr(e,function(e,t){switch(e){case"X-TIMESTAMP-MAP":a(t);break}},/=/)}else{rr(e,function(e,t){switch(e){case"Region":n(t);break}},/:/)}}try{var o;if(r.state==="INITIAL"){if(!/\r\n|\n/.test(r.buffer)){return this}o=i();var u=o.match(/^WEBVTT([ \t].*)?$/);if(!u||!u[0]){throw new er(er.Errors.BadSignature)}r.state="HEADER"}var l=false;while(r.buffer){if(!/\r\n|\n/.test(r.buffer)){return this}if(!l){o=i()}else{l=false}switch(r.state){case"HEADER":if(/:/.test(o)){s(o)}else if(!o){r.state="ID"}continue;case"NOTE":if(!o){r.state="ID"}continue;case"ID":if(/^NOTE($|[ \t])/.test(o)){r.state="NOTE";break}if(!o){continue}r.cue=new(r.vttjs.VTTCue||r.window.VTTCue)(0,0,"");r.state="CUE";if(o.indexOf("--\x3e")===-1){r.cue.id=o;continue}case"CUE":try{nr(o,r.cue,r.regionList)}catch(e){r.reportOrThrowError(e);r.cue=null;r.state="BADCUE";continue}r.state="CUETEXT";continue;case"CUETEXT":var c=o.indexOf("--\x3e")!==-1;if(!o||c&&(l=true)){r.oncue&&r.oncue(r.cue);r.cue=null;r.state="ID";continue}if(r.cue.text){r.cue.text+="\n"}r.cue.text+=o;continue;case"BADCUE":if(!o){r.state="ID"}continue}}}catch(e){r.reportOrThrowError(e);if(r.state==="CUETEXT"&&r.cue&&r.oncue){r.oncue(r.cue)}r.cue=null;r.state=r.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function e(){var t=this;try{t.buffer+=t.decoder.decode();if(t.cue||t.state==="HEADER"){t.buffer+="\n\n";t.parse()}if(t.state==="INITIAL"){throw new er(er.Errors.BadSignature)}}catch(e){t.reportOrThrowError(e)}t.onflush&&t.onflush();return this}};var Sr=yr;var kr="auto";var wr={"":1,lr:1,rl:1};var Cr={start:1,middle:1,end:1,left:1,right:1};function Er(e){if(typeof e!=="string"){return false}var t=wr[e.toLowerCase()];return t?e.toLowerCase():false}function Ar(e){if(typeof e!=="string"){return false}var t=Cr[e.toLowerCase()];return t?e.toLowerCase():false}function Lr(e,t,i){this.hasBeenReset=false;var r="";var n=false;var a=e;var s=t;var o=i;var u=null;var l="";var c=true;var f="auto";var h="start";var d=50;var p="middle";var m=50;var v="middle";Object.defineProperties(this,{id:{enumerable:true,get:function e(){return r},set:function e(t){r=""+t}},pauseOnExit:{enumerable:true,get:function e(){return n},set:function e(t){n=!!t}},startTime:{enumerable:true,get:function e(){return a},set:function e(t){if(typeof t!=="number"){throw new TypeError("Start time must be set to a number.")}a=t;this.hasBeenReset=true}},endTime:{enumerable:true,get:function e(){return s},set:function e(t){if(typeof t!=="number"){throw new TypeError("End time must be set to a number.")}s=t;this.hasBeenReset=true}},text:{enumerable:true,get:function e(){return o},set:function e(t){o=""+t;this.hasBeenReset=true}},region:{enumerable:true,get:function e(){return u},set:function e(t){u=t;this.hasBeenReset=true}},vertical:{enumerable:true,get:function e(){return l},set:function e(t){var i=Er(t);if(i===false){throw new SyntaxError("An invalid or illegal string was specified.")}l=i;this.hasBeenReset=true}},snapToLines:{enumerable:true,get:function e(){return c},set:function e(t){c=!!t;this.hasBeenReset=true}},line:{enumerable:true,get:function e(){return f},set:function e(t){if(typeof t!=="number"&&t!==kr){throw new SyntaxError("An invalid number or illegal string was specified.")}f=t;this.hasBeenReset=true}},lineAlign:{enumerable:true,get:function e(){return h},set:function e(t){var i=Ar(t);if(!i){throw new SyntaxError("An invalid or illegal string was specified.")}h=i;this.hasBeenReset=true}},position:{enumerable:true,get:function e(){return d},set:function e(t){if(t<0||t>100){throw new Error("Position must be between 0 and 100.")}d=t;this.hasBeenReset=true}},positionAlign:{enumerable:true,get:function e(){return p},set:function e(t){var i=Ar(t);if(!i){throw new SyntaxError("An invalid or illegal string was specified.")}p=i;this.hasBeenReset=true}},size:{enumerable:true,get:function e(){return m},set:function e(t){if(t<0||t>100){throw new Error("Size must be between 0 and 100.")}m=t;this.hasBeenReset=true}},align:{enumerable:true,get:function e(){return v},set:function e(t){var i=Ar(t);if(!i){throw new SyntaxError("An invalid or illegal string was specified.")}v=i;this.hasBeenReset=true}}});this.displayState=undefined}Lr.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};var Ir=Lr;var Or={"":true,up:true};function Pr(e){if(typeof e!=="string"){return false}var t=Or[e.toLowerCase()];return t?e.toLowerCase():false}function Ur(e){return typeof e==="number"&&e>=0&&e<=100}function Dr(){var i=100;var r=3;var n=0;var a=100;var s=0;var o=100;var u="";Object.defineProperties(this,{width:{enumerable:true,get:function e(){return i},set:function e(t){if(!Ur(t)){throw new Error("Width must be between 0 and 100.")}i=t}},lines:{enumerable:true,get:function e(){return r},set:function e(t){if(typeof t!=="number"){throw new TypeError("Lines must be set to a number.")}r=t}},regionAnchorY:{enumerable:true,get:function e(){return a},set:function e(t){if(!Ur(t)){throw new Error("RegionAnchorX must be between 0 and 100.")}a=t}},regionAnchorX:{enumerable:true,get:function e(){return n},set:function e(t){if(!Ur(t)){throw new Error("RegionAnchorY must be between 0 and 100.")}n=t}},viewportAnchorY:{enumerable:true,get:function e(){return o},set:function e(t){if(!Ur(t)){throw new Error("ViewportAnchorY must be between 0 and 100.")}o=t}},viewportAnchorX:{enumerable:true,get:function e(){return s},set:function e(t){if(!Ur(t)){throw new Error("ViewportAnchorX must be between 0 and 100.")}s=t}},scroll:{enumerable:true,get:function e(){return u},set:function e(t){var i=Pr(t);if(i===false){throw new SyntaxError("An invalid or illegal string was specified.")}u=i}}})}var xr=Dr;var Rr=oi(function(e){var t=e.exports={WebVTT:Sr,VTTCue:Ir,VTTRegion:xr};_.vttjs=t;_.WebVTT=t.WebVTT;var i=t.VTTCue;var r=t.VTTRegion;var n=_.VTTCue;var a=_.VTTRegion;t.shim=function(){_.VTTCue=i;_.VTTRegion=r};t.restore=function(){_.VTTCue=n;_.VTTRegion=a};if(!_.VTTCue){t.shim()}});var Mr=Rr.WebVTT;var Br=Rr.VTTCue;var Nr=Rr.VTTRegion;function jr(e,t,i,r,n){if(n===void 0){n={}}var a=e.textTracks();n.kind=t;if(i){n.label=i}if(r){n.language=r}n.tech=e;var s=new Qi.text.TrackClass(n);a.addTrack(s);return s}var Fr=function(t){o(r,t);function r(i,e){var r;if(i===void 0){i={}}if(e===void 0){e=function e(){}}i.reportTouchActivity=false;r=t.call(this,null,i,e)||this;r.hasStarted_=false;r.on("playing",function(){this.hasStarted_=true});r.on("loadstart",function(){this.hasStarted_=false});Qi.names.forEach(function(e){var t=Qi[e];if(i&&i[t.getterName]){r[t.privateName]=i[t.getterName]}});if(!r.featuresProgressEvents){r.manualProgressOn()}if(!r.featuresTimeupdateEvents){r.manualTimeUpdatesOn()}["Text","Audio","Video"].forEach(function(e){if(i["native"+e+"Tracks"]===false){r["featuresNative"+e+"Tracks"]=false}});if(i.nativeCaptions===false||i.nativeTextTracks===false){r.featuresNativeTextTracks=false}else if(i.nativeCaptions===true||i.nativeTextTracks===true){r.featuresNativeTextTracks=true}if(!r.featuresNativeTextTracks){r.emulateTextTracks()}r.autoRemoteTextTracks_=new Qi.text.ListClass;r.initTrackListeners();if(!i.nativeControlsForTouch){r.emitTapEvents()}if(r.constructor){r.name_=r.constructor.name||"Unknown Tech"}return r}var e=r.prototype;e.triggerSourceset=function e(t){var i=this;if(!this.isReady_){this.one("ready",function(){return i.setTimeout(function(){return i.triggerSourceset(t)},1)})}this.trigger({src:t,type:"sourceset"})};e.manualProgressOn=function e(){this.on("durationchange",this.onDurationChange);this.manualProgress=true;this.one("ready",this.trackProgress)};e.manualProgressOff=function e(){this.manualProgress=false;this.stopTrackingProgress();this.off("durationchange",this.onDurationChange)};e.trackProgress=function e(t){this.stopTrackingProgress();this.progressInterval=this.setInterval(Ae(this,function(){var e=this.bufferedPercent();if(this.bufferedPercent_!==e){this.trigger("progress")}this.bufferedPercent_=e;if(e===1){this.stopTrackingProgress()}}),500)};e.onDurationChange=function e(t){this.duration_=this.duration()};e.buffered=function e(){return gt(0,0)};e.bufferedPercent=function e(){return yt(this.buffered(),this.duration_)};e.stopTrackingProgress=function e(){this.clearInterval(this.progressInterval)};e.manualTimeUpdatesOn=function e(){this.manualTimeUpdates=true;this.on("play",this.trackCurrentTime);this.on("pause",this.stopTrackingCurrentTime)};e.manualTimeUpdatesOff=function e(){this.manualTimeUpdates=false;this.stopTrackingCurrentTime();this.off("play",this.trackCurrentTime);this.off("pause",this.stopTrackingCurrentTime)};e.trackCurrentTime=function e(){if(this.currentTimeInterval){this.stopTrackingCurrentTime()}this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:true})},250)};e.stopTrackingCurrentTime=function e(){this.clearInterval(this.currentTimeInterval);this.trigger({type:"timeupdate",target:this,manuallyTriggered:true})};e.dispose=function e(){this.clearTracks(Ki.names);if(this.manualProgress){this.manualProgressOff()}if(this.manualTimeUpdates){this.manualTimeUpdatesOff()}t.prototype.dispose.call(this)};e.clearTracks=function e(t){var n=this;t=[].concat(t);t.forEach(function(e){var t=n[e+"Tracks"]()||[];var i=t.length;while(i--){var r=t[i];if(e==="text"){n.removeRemoteTextTrack(r)}t.removeTrack(r)}})};e.cleanupAutoTextTracks=function e(){var t=this.autoRemoteTextTracks_||[];var i=t.length;while(i--){var r=t[i];this.removeRemoteTextTrack(r)}};e.reset=function e(){};e.error=function e(t){if(t!==undefined){this.error_=new Ct(t);this.trigger("error")}return this.error_};e.played=function e(){if(this.hasStarted_){return gt(0,0)}return gt()};e.setCurrentTime=function e(){if(this.manualTimeUpdates){this.trigger({type:"timeupdate",target:this,manuallyTriggered:true})}};e.initTrackListeners=function e(){var n=this;Ki.names.forEach(function(t){var e=Ki[t];var i=function e(){n.trigger(t+"trackchange")};var r=n[e.getterName]();r.addEventListener("removetrack",i);r.addEventListener("addtrack",i);n.on("dispose",function(){r.removeEventListener("removetrack",i);r.removeEventListener("addtrack",i)})})};e.addWebVttScript_=function e(){var t=this;if(_.WebVTT){return}if(h.body.contains(this.el())){if(!this.options_["vtt.js"]&&S(Rr)&&Object.keys(Rr).length>0){this.trigger("vttjsloaded");return}var i=h.createElement("script");i.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js";i.onload=function(){t.trigger("vttjsloaded")};i.onerror=function(){t.trigger("vttjserror")};this.on("dispose",function(){i.onload=null;i.onerror=null});_.WebVTT=true;this.el().parentNode.appendChild(i)}else{this.ready(this.addWebVttScript_)}};e.emulateTextTracks=function e(){var t=this;var r=this.textTracks();var i=this.remoteTextTracks();var n=function e(t){return r.addTrack(t.track)};var a=function e(t){return r.removeTrack(t.track)};i.on("addtrack",n);i.on("removetrack",a);this.addWebVttScript_();var s=function e(){return t.trigger("texttrackchange")};var o=function e(){s();for(var t=0;t<r.length;t++){var i=r[t];i.removeEventListener("cuechange",s);if(i.mode==="showing"){i.addEventListener("cuechange",s)}}};o();r.addEventListener("change",o);r.addEventListener("addtrack",o);r.addEventListener("removetrack",o);this.on("dispose",function(){i.off("addtrack",n);i.off("removetrack",a);r.removeEventListener("change",o);r.removeEventListener("addtrack",o);r.removeEventListener("removetrack",o);for(var e=0;e<r.length;e++){var t=r[e];t.removeEventListener("cuechange",s)}})};e.addTextTrack=function e(t,i,r){if(!t){throw new Error("TextTrack kind is required but was not provided")}return jr(this,t,i,r)};e.createRemoteTextTrack=function e(t){var i=Ge(t,{tech:this});return new Ji.remoteTextEl.TrackClass(i)};e.addRemoteTextTrack=function e(t,i){var r=this;if(t===void 0){t={}}var n=this.createRemoteTextTrack(t);if(i!==true&&i!==false){m.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js');i=true}this.remoteTextTrackEls().addTrackElement_(n);this.remoteTextTracks().addTrack(n.track);if(i!==true){this.ready(function(){return r.autoRemoteTextTracks_.addTrack(n.track)})}return n};e.removeRemoteTextTrack=function e(t){var i=this.remoteTextTrackEls().getTrackElementByTrack_(t);this.remoteTextTrackEls().removeTrackElement_(i);this.remoteTextTracks().removeTrack(t);this.autoRemoteTextTracks_.removeTrack(t)};e.getVideoPlaybackQuality=function e(){return{}};e.setPoster=function e(){};e.playsinline=function e(){};e.setPlaysinline=function e(){};e.overrideNativeAudioTracks=function e(){};e.overrideNativeVideoTracks=function e(){};e.canPlayType=function e(){return""};r.canPlayType=function e(){return""};r.canPlaySource=function e(t,i){return r.canPlayType(t.type)};r.isTech=function e(t){return t.prototype instanceof r||t instanceof r||t===r};r.registerTech=function e(t,i){if(!r.techs_){r.techs_={}}if(!r.isTech(i)){throw new Error("Tech "+t+" must be a Tech")}if(!r.canPlayType){throw new Error("Techs must have a static canPlayType method on them")}if(!r.canPlaySource){throw new Error("Techs must have a static canPlaySource method on them")}t=ze(t);r.techs_[t]=i;if(t!=="Tech"){r.defaultTechOrder_.push(t)}return i};r.getTech=function e(t){if(!t){return}t=ze(t);if(r.techs_&&r.techs_[t]){return r.techs_[t]}if(_&&_.videojs&&_.videojs[t]){m.warn("The "+t+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)");return _.videojs[t]}};return r}(Xe);Qi.names.forEach(function(e){var t=Qi[e];Fr.prototype[t.getterName]=function(){this[t.privateName]=this[t.privateName]||new t.ListClass;return this[t.privateName]}});Fr.prototype.featuresVolumeControl=true;Fr.prototype.featuresMuteControl=true;Fr.prototype.featuresFullscreenResize=false;Fr.prototype.featuresPlaybackRate=false;Fr.prototype.featuresProgressEvents=false;Fr.prototype.featuresSourceset=false;Fr.prototype.featuresTimeupdateEvents=false;Fr.prototype.featuresNativeTextTracks=false;Fr.withSourceHandlers=function(a){a.registerSourceHandler=function(e,t){var i=a.sourceHandlers;if(!i){i=a.sourceHandlers=[]}if(t===undefined){t=i.length}i.splice(t,0,e)};a.canPlayType=function(e){var t=a.sourceHandlers||[];var i;for(var r=0;r<t.length;r++){i=t[r].canPlayType(e);if(i){return i}}return""};a.selectSourceHandler=function(e,t){var i=a.sourceHandlers||[];var r;for(var n=0;n<i.length;n++){r=i[n].canHandleSource(e,t);if(r){return i[n]}}return null};a.canPlaySource=function(e,t){var i=a.selectSourceHandler(e,t);if(i){return i.canHandleSource(e,t)}return""};var e=["seekable","seeking","duration"];e.forEach(function(e){var t=this[e];if(typeof t!=="function"){return}this[e]=function(){if(this.sourceHandler_&&this.sourceHandler_[e]){return this.sourceHandler_[e].apply(this.sourceHandler_,arguments)}return t.apply(this,arguments)}},a.prototype);a.prototype.setSource=function(e){var t=a.selectSourceHandler(e,this.options_);if(!t){if(a.nativeSourceHandler){t=a.nativeSourceHandler}else{m.error("No source handler found for the current source.")}}this.disposeSourceHandler();this.off("dispose",this.disposeSourceHandler);if(t!==a.nativeSourceHandler){this.currentSource_=e}this.sourceHandler_=t.handleSource(e,this,this.options_);this.on("dispose",this.disposeSourceHandler)};a.prototype.disposeSourceHandler=function(){if(this.currentSource_){this.clearTracks(["audio","video"]);this.currentSource_=null}this.cleanupAutoTextTracks();if(this.sourceHandler_){if(this.sourceHandler_.dispose){this.sourceHandler_.dispose()}this.sourceHandler_=null}}};Xe.registerComponent("Tech",Fr);Fr.registerTech("Tech",Fr);Fr.defaultTechOrder_=[];var Vr={};var Hr={};var qr={};function zr(e,t){Vr[e]=Vr[e]||[];Vr[e].push(t)}function Wr(e,t,i){e.setTimeout(function(){return nn(t,Vr[t.type],i,e)},1)}function Gr(e,t){e.forEach(function(e){return e.setTech&&e.setTech(t)})}function Xr(e,t,i){return e.reduceRight(Zr(i),t[i]())}function Yr(e,t,i,r){return t[i](e.reduce(Zr(i),r))}function $r(e,t,i,r){if(r===void 0){r=null}var n="call"+ze(i);var a=e.reduce(Zr(n),r);var s=a===qr;var o=s?null:t[i](a);en(e,i,o,s);return o}var Kr={buffered:1,currentTime:1,duration:1,seekable:1,played:1,paused:1};var Jr={setCurrentTime:1};var Qr={play:1,pause:1};function Zr(i){return function(e,t){if(e===qr){return qr}if(t[i]){return t[i](e)}return e}}function en(e,t,i,r){for(var n=e.length-1;n>=0;n--){var a=e[n];if(a[t]){a[t](r,i)}}}function tn(e){Hr[e.id()]=null}function rn(e,t){var i=Hr[e.id()];var r=null;if(i===undefined||i===null){r=t(e);Hr[e.id()]=[[t,r]];return r}for(var n=0;n<i.length;n++){var a=i[n],s=a[0],o=a[1];if(s!==t){continue}r=o}if(r===null){r=t(e);i.push([t,r])}return r}function nn(i,e,r,n,a,s){if(i===void 0){i={}}if(e===void 0){e=[]}if(a===void 0){a=[]}if(s===void 0){s=false}var t=e,o=t[0],u=t.slice(1);if(typeof o==="string"){nn(i,Vr[o],r,n,a,s)}else if(o){var l=rn(n,o);if(!l.setSource){a.push(l);return nn(i,u,r,n,a,s)}l.setSource(b({},i),function(e,t){if(e){return nn(i,u,r,n,a,s)}a.push(l);nn(t,i.type===t.type?u:Vr[t.type],r,n,a,s)})}else if(u.length){nn(i,u,r,n,a,s)}else if(s){r(i,a)}else{nn(i,Vr["*"],r,n,a,true)}}var an={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",mp3:"audio/mpeg",aac:"audio/aac",oga:"audio/ogg",m3u8:"application/x-mpegURL"};var sn=function e(t){if(t===void 0){t=""}var i=ei(t);var r=an[i.toLowerCase()];return r||""};var on=function e(t,i){if(!i){return""}if(t.cache_.source.src===i&&t.cache_.source.type){return t.cache_.source.type}var r=t.cache_.sources.filter(function(e){return e.src===i});if(r.length){return r[0].type}var n=t.$$("source");for(var a=0;a<n.length;a++){var s=n[a];if(s.type&&s.src&&s.src===i){return s.type}}return sn(i)};var un=function t(e){if(Array.isArray(e)){var i=[];e.forEach(function(e){e=t(e);if(Array.isArray(e)){i=i.concat(e)}else if(T(e)){i.push(e)}});e=i}else if(typeof e==="string"&&e.trim()){e=[ln({src:e})]}else if(T(e)&&typeof e.src==="string"&&e.src&&e.src.trim()){e=[ln(e)]}else{e=[]}return e};function ln(e){var t=sn(e.src);if(!e.type&&t){e.type=t}return e}var cn=function(l){o(e,l);function e(e,t,i){var r;var n=Ge({createEl:false},t);r=l.call(this,e,n,i)||this;if(!t.playerOptions.sources||t.playerOptions.sources.length===0){for(var a=0,s=t.playerOptions.techOrder;a<s.length;a++){var o=ze(s[a]);var u=Fr.getTech(o);if(!o){u=Xe.getComponent(o)}if(u&&u.isSupported()){e.loadTech_(o);break}}}else{e.src(t.playerOptions.sources)}return r}return e}(Xe);Xe.registerComponent("MediaLoader",cn);var fn=function(a){o(e,a);function e(e,t){var i;i=a.call(this,e,t)||this;i.emitTapEvents();i.enable();return i}var t=e.prototype;t.createEl=function e(t,i,r){if(t===void 0){t="div"}if(i===void 0){i={}}if(r===void 0){r={}}i=b({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass(),tabIndex:0},i);if(t==="button"){m.error("Creating a ClickableComponent with an HTML element of "+t+" is not supported; use a Button instead.")}r=b({role:"button"},r);this.tabIndex_=i.tabIndex;var n=a.prototype.createEl.call(this,t,i,r);this.createControlTextEl(n);return n};t.dispose=function e(){this.controlTextEl_=null;a.prototype.dispose.call(this)};t.createControlTextEl=function e(t){this.controlTextEl_=U("span",{className:"vjs-control-text"},{"aria-live":"polite"});if(t){t.appendChild(this.controlTextEl_)}this.controlText(this.controlText_,t);return this.controlTextEl_};t.controlText=function e(t,i){if(i===void 0){i=this.el()}if(t===undefined){return this.controlText_||"Need Text"}var r=this.localize(t);this.controlText_=t;D(this.controlTextEl_,r);if(!this.nonIconControl){i.setAttribute("title",r)}};t.buildCSSClass=function e(){return"vjs-control vjs-button "+a.prototype.buildCSSClass.call(this)};t.enable=function e(){if(!this.enabled_){this.enabled_=true;this.removeClass("vjs-disabled");this.el_.setAttribute("aria-disabled","false");if(typeof this.tabIndex_!=="undefined"){this.el_.setAttribute("tabIndex",this.tabIndex_)}this.on(["tap","click"],this.handleClick);this.on("focus",this.handleFocus);this.on("blur",this.handleBlur)}};t.disable=function e(){this.enabled_=false;this.addClass("vjs-disabled");this.el_.setAttribute("aria-disabled","true");if(typeof this.tabIndex_!=="undefined"){this.el_.removeAttribute("tabIndex")}this.off(["tap","click"],this.handleClick);this.off("focus",this.handleFocus);this.off("blur",this.handleBlur)};t.handleClick=function e(t){};t.handleFocus=function e(t){ve(h,"keydown",Ae(this,this.handleKeyPress))};t.handleKeyPress=function e(t){if(t.which===32||t.which===13){t.preventDefault();this.trigger("click")}else if(a.prototype.handleKeyPress){a.prototype.handleKeyPress.call(this,t)}};t.handleBlur=function e(t){ge(h,"keydown",Ae(this,this.handleKeyPress))};return e}(Xe);Xe.registerComponent("ClickableComponent",fn);var hn=function(r){o(e,r);function e(e,t){var i;i=r.call(this,e,t)||this;i.update();e.on("posterchange",Ae(p(p(i)),i.update));return i}var t=e.prototype;t.dispose=function e(){this.player().off("posterchange",this.update);r.prototype.dispose.call(this)};t.createEl=function e(){var t=U("div",{className:"vjs-poster",tabIndex:-1});return t};t.update=function e(t){var i=this.player().poster();this.setSrc(i);if(i){this.show()}else{this.hide()}};t.setSrc=function e(t){var i="";if(t){i='url("'+t+'")'}this.el_.style.backgroundImage=i};t.handleClick=function e(t){if(!this.player_.controls()){return}if(this.player_.paused()){Ot(this.player_.play())}else{this.player_.pause()}};return e}(fn);Xe.registerComponent("PosterImage",hn);var dn="#222";var pn="#ccc";var mn={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function vn(e,t){var i;if(e.length===4){i=e[1]+e[1]+e[2]+e[2]+e[3]+e[3]}else if(e.length===7){i=e.slice(1)}else{throw new Error("Invalid color code provided, "+e+"; must be formatted as e.g. #f0e or #f604e2.")}return"rgba("+parseInt(i.slice(0,2),16)+","+parseInt(i.slice(2,4),16)+","+parseInt(i.slice(4,6),16)+","+t+")"}function gn(e,t,i){try{e.style[t]=i}catch(e){return}}var yn=function(a){o(e,a);function e(i,e,t){var r;r=a.call(this,i,e,t)||this;var n=Ae(p(p(r)),r.updateDisplay);i.on("loadstart",Ae(p(p(r)),r.toggleDisplay));i.on("texttrackchange",n);i.on("loadedmetadata",Ae(p(p(r)),r.preselectTrack));i.ready(Ae(p(p(r)),function(){if(i.tech_&&i.tech_.featuresNativeTextTracks){this.hide();return}i.on("fullscreenchange",n);i.on("playerresize",n);_.addEventListener("orientationchange",n);i.on("dispose",function(){return _.removeEventListener("orientationchange",n)});var e=this.options_.playerOptions.tracks||[];for(var t=0;t<e.length;t++){this.player_.addRemoteTextTrack(e[t],true)}this.preselectTrack()}));return r}var t=e.prototype;t.preselectTrack=function e(){var t={captions:1,subtitles:1};var i=this.player_.textTracks();var r=this.player_.cache_.selectedLanguage;var n;var a;var s;for(var o=0;o<i.length;o++){var u=i[o];if(r&&r.enabled&&r.language&&r.language===u.language&&u.kind in t){if(u.kind===r.kind){s=u}else if(!s){s=u}}else if(r&&!r.enabled){s=null;n=null;a=null}else if(u.default){if(u.kind==="descriptions"&&!n){n=u}else if(u.kind in t&&!a){a=u}}}if(s){s.mode="showing"}else if(a){a.mode="showing"}else if(n){n.mode="showing"}};t.toggleDisplay=function e(){if(this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks){this.hide()}else{this.show()}};t.createEl=function e(){return a.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})};t.clearDisplay=function e(){if(typeof _.WebVTT==="function"){_.WebVTT.processCues(_,[],this.el_)}};t.updateDisplay=function e(){var t=this.player_.textTracks();this.clearDisplay();var i=null;var r=null;var n=t.length;while(n--){var a=t[n];if(a.mode==="showing"){if(a.kind==="descriptions"){i=a}else{r=a}}}if(r){if(this.getAttribute("aria-live")!=="off"){this.setAttribute("aria-live","off")}this.updateForTrack(r)}else if(i){if(this.getAttribute("aria-live")!=="assertive"){this.setAttribute("aria-live","assertive")}this.updateForTrack(i)}};t.updateForTrack=function e(t){if(typeof _.WebVTT!=="function"||!t.activeCues){return}var i=[];for(var r=0;r<t.activeCues.length;r++){i.push(t.activeCues[r])}_.WebVTT.processCues(_,i,this.el_);if(!this.player_.textTrackSettings){return}var n=this.player_.textTrackSettings.getValues();var a=i.length;while(a--){var s=i[a];if(!s){continue}var o=s.displayState;if(n.color){o.firstChild.style.color=n.color}if(n.textOpacity){gn(o.firstChild,"color",vn(n.color||"#fff",n.textOpacity))}if(n.backgroundColor){o.firstChild.style.backgroundColor=n.backgroundColor}if(n.backgroundOpacity){gn(o.firstChild,"backgroundColor",vn(n.backgroundColor||"#000",n.backgroundOpacity))}if(n.windowColor){if(n.windowOpacity){gn(o,"backgroundColor",vn(n.windowColor,n.windowOpacity))}else{o.style.backgroundColor=n.windowColor}}if(n.edgeStyle){if(n.edgeStyle==="dropshadow"){o.firstChild.style.textShadow="2px 2px 3px "+dn+", 2px 2px 4px "+dn+", 2px 2px 5px "+dn}else if(n.edgeStyle==="raised"){o.firstChild.style.textShadow="1px 1px "+dn+", 2px 2px "+dn+", 3px 3px "+dn}else if(n.edgeStyle==="depressed"){o.firstChild.style.textShadow="1px 1px "+pn+", 0 1px "+pn+", -1px -1px "+dn+", 0 -1px "+dn}else if(n.edgeStyle==="uniform"){o.firstChild.style.textShadow="0 0 4px "+dn+", 0 0 4px "+dn+", 0 0 4px "+dn+", 0 0 4px "+dn}}if(n.fontPercent&&n.fontPercent!==1){var u=_.parseFloat(o.style.fontSize);o.style.fontSize=u*n.fontPercent+"px";o.style.height="auto";o.style.top="auto";o.style.bottom="2px"}if(n.fontFamily&&n.fontFamily!=="default"){if(n.fontFamily==="small-caps"){o.firstChild.style.fontVariant="small-caps"}else{o.firstChild.style.fontFamily=mn[n.fontFamily]}}}};return e}(Xe);Xe.registerComponent("TextTrackDisplay",yn);var _n=function(a){o(e,a);function e(){return a.apply(this,arguments)||this}var t=e.prototype;t.createEl=function e(){var t=this.player_.isAudio();var i=this.localize(t?"Audio Player":"Video Player");var r=U("span",{className:"vjs-control-text",innerHTML:this.localize("{1} is loading.",[i])});var n=a.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});n.appendChild(r);return n};return e}(Xe);Xe.registerComponent("LoadingSpinner",_n);var bn=function(i){o(e,i);function e(){return i.apply(this,arguments)||this}var t=e.prototype;t.createEl=function e(t,i,r){if(i===void 0){i={}}if(r===void 0){r={}}t="button";i=b({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass()},i);r=b({type:"button"},r);var n=Xe.prototype.createEl.call(this,t,i,r);this.createControlTextEl(n);return n};t.addChild=function e(t,i){if(i===void 0){i={}}var r=this.constructor.name;m.warn("Adding an actionable (user controllable) child to a Button ("+r+") is not supported; use a ClickableComponent instead.");return Xe.prototype.addChild.call(this,t,i)};t.enable=function e(){i.prototype.enable.call(this);this.el_.removeAttribute("disabled")};t.disable=function e(){i.prototype.disable.call(this);this.el_.setAttribute("disabled","disabled")};t.handleKeyPress=function e(t){if(t.which===32||t.which===13){return}i.prototype.handleKeyPress.call(this,t)};return e}(fn);Xe.registerComponent("Button",bn);var Tn=function(r){o(e,r);function e(e,t){var i;i=r.call(this,e,t)||this;i.mouseused_=false;i.on("mousedown",i.handleMouseDown);return i}var t=e.prototype;t.buildCSSClass=function e(){return"vjs-big-play-button"};t.handleClick=function e(t){var i=this.player_.play();if(this.mouseused_&&t.clientX&&t.clientY){Ot(i);return}var r=this.player_.getChild("controlBar");var n=r&&r.getChild("playToggle");if(!n){this.player_.focus();return}var a=function e(){return n.focus()};if(It(i)){i.then(a,function(){})}else{this.setTimeout(a,1)}};t.handleKeyPress=function e(t){this.mouseused_=false;r.prototype.handleKeyPress.call(this,t)};t.handleMouseDown=function e(t){this.mouseused_=true};return e}(bn);Tn.prototype.controlText_="Play Video";Xe.registerComponent("BigPlayButton",Tn);var Sn=function(r){o(e,r);function e(e,t){var i;i=r.call(this,e,t)||this;i.controlText(t&&t.controlText||i.localize("Close"));return i}var t=e.prototype;t.buildCSSClass=function e(){return"vjs-close-button "+r.prototype.buildCSSClass.call(this)};t.handleClick=function e(t){this.trigger({type:"close",bubbles:false})};return e}(bn);Xe.registerComponent("CloseButton",Sn);var kn=function(r){o(e,r);function e(e,t){var i;if(t===void 0){t={}}i=r.call(this,e,t)||this;t.replay=t.replay===undefined||t.replay;i.on(e,"play",i.handlePlay);i.on(e,"pause",i.handlePause);if(t.replay){i.on(e,"ended",i.handleEnded)}return i}var t=e.prototype;t.buildCSSClass=function e(){return"vjs-play-control "+r.prototype.buildCSSClass.call(this)};t.handleClick=function e(t){if(this.player_.paused()){this.player_.play()}else{this.player_.pause()}};t.handleSeeked=function e(t){this.removeClass("vjs-ended");if(this.player_.paused()){this.handlePause(t)}else{this.handlePlay(t)}};t.handlePlay=function e(t){this.removeClass("vjs-ended");this.removeClass("vjs-paused");this.addClass("vjs-playing");this.controlText("Pause")};t.handlePause=function e(t){this.removeClass("vjs-playing");this.addClass("vjs-paused");this.controlText("Play")};t.handleEnded=function e(t){this.removeClass("vjs-playing");this.addClass("vjs-ended");this.controlText("Replay");this.one(this.player_,"seeked",this.handleSeeked)};return e}(bn);kn.prototype.controlText_="Play";Xe.registerComponent("PlayToggle",kn);var wn=function e(t,i){t=t<0?0:t;var r=Math.floor(t%60);var n=Math.floor(t/60%60);var a=Math.floor(t/3600);var s=Math.floor(i/60%60);var o=Math.floor(i/3600);if(isNaN(t)||t===Infinity){a=n=r="-"}a=a>0||o>0?a+":":"";n=((a||s>=10)&&n<10?"0"+n:n)+":";r=r<10?"0"+r:r;return a+n+r};var Cn=wn;function En(e){Cn=e}function An(){Cn=wn}function Ln(e,t){if(t===void 0){t=e}return Cn(e,t)}var In=function(n){o(e,n);function e(e,t){var i;i=n.call(this,e,t)||this;i.throttledUpdateContent=Le(Ae(p(p(i)),i.updateContent),25);i.on(e,"timeupdate",i.throttledUpdateContent);return i}var t=e.prototype;t.createEl=function e(t){var i=this.buildCSSClass();var r=n.prototype.createEl.call(this,"div",{className:i+" vjs-time-control vjs-control",innerHTML:'<span class="vjs-control-text" role="presentation">'+this.localize(this.labelText_)+" </span>"});this.contentEl_=U("span",{className:i+"-display"},{"aria-live":"off",role:"presentation"});this.updateTextNode_();r.appendChild(this.contentEl_);return r};t.dispose=function e(){this.contentEl_=null;this.textNode_=null;n.prototype.dispose.call(this)};t.updateTextNode_=function e(){if(!this.contentEl_){return}while(this.contentEl_.firstChild){this.contentEl_.removeChild(this.contentEl_.firstChild)}this.textNode_=h.createTextNode(this.formattedTime_||this.formatTime_(0));this.contentEl_.appendChild(this.textNode_)};t.formatTime_=function e(t){return Ln(t)};t.updateFormattedTime_=function e(t){var i=this.formatTime_(t);if(i===this.formattedTime_){return}this.formattedTime_=i;this.requestAnimationFrame(this.updateTextNode_)};t.updateContent=function e(t){};return e}(Xe);In.prototype.labelText_="Time";In.prototype.controlText_="Time";Xe.registerComponent("TimeDisplay",In);var On=function(r){o(e,r);function e(e,t){var i;i=r.call(this,e,t)||this;i.on(e,"ended",i.handleEnded);return i}var t=e.prototype;t.buildCSSClass=function e(){return"vjs-current-time"};t.updateContent=function e(t){var i=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.updateFormattedTime_(i)};t.handleEnded=function e(t){if(!this.player_.duration()){return}this.updateFormattedTime_(this.player_.duration())};return e}(In);On.prototype.labelText_="Current Time";On.prototype.controlText_="Current Time";Xe.registerComponent("CurrentTimeDisplay",On);var Pn=function(r){o(e,r);function e(e,t){var i;i=r.call(this,e,t)||this;i.on(e,"durationchange",i.updateContent);i.on(e,"loadstart",i.updateContent);i.on(e,"loadedmetadata",i.throttledUpdateContent);return i}var t=e.prototype;t.buildCSSClass=function e(){return"vjs-duration"};t.updateContent=function e(t){var i=this.player_.duration();if(this.duration_!==i){this.duration_=i;this.updateFormattedTime_(i)}};return e}(In);Pn.prototype.labelText_="Duration";Pn.prototype.controlText_="Duration";Xe.registerComponent("DurationDisplay",Pn);var Un=function(t){o(e,t);function e(){return t.apply(this,arguments)||this}var i=e.prototype;i.createEl=function e(){return t.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/</span></div>"},{"aria-hidden":true})};return e}(Xe);Xe.registerComponent("TimeDivider",Un);var Dn=function(r){o(e,r);function e(e,t){var i;i=r.call(this,e,t)||this;i.on(e,"durationchange",i.throttledUpdateContent);i.on(e,"ended",i.handleEnded);return i}var t=e.prototype;t.buildCSSClass=function e(){return"vjs-remaining-time"};t.formatTime_=function e(t){return"-"+r.prototype.formatTime_.call(this,t)};t.updateContent=function e(t){if(!this.player_.duration()){return}if(this.player_.remainingTimeDisplay){this.updateFormattedTime_(this.player_.remainingTimeDisplay())}else{this.updateFormattedTime_(this.player_.remainingTime())}};t.handleEnded=function e(t){if(!this.player_.duration()){return}this.updateFormattedTime_(0)};return e}(In);Dn.prototype.labelText_="Remaining Time";Dn.prototype.controlText_="Remaining Time";Xe.registerComponent("RemainingTimeDisplay",Dn);var xn=function(r){o(e,r);function e(e,t){var i;i=r.call(this,e,t)||this;i.updateShowing();i.on(i.player(),"durationchange",i.updateShowing);return i}var t=e.prototype;t.createEl=function e(){var t=r.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});this.contentEl_=U("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+" </span>"+this.localize("LIVE")},{"aria-live":"off"});t.appendChild(this.contentEl_);return t};t.dispose=function e(){this.contentEl_=null;r.prototype.dispose.call(this)};t.updateShowing=function e(t){if(this.player().duration()===Infinity){this.show()}else{this.hide()}};return e}(Xe);Xe.registerComponent("LiveDisplay",xn);var Rn=function(r){o(e,r);function e(e,t){var i;i=r.call(this,e,t)||this;i.updateLiveEdgeStatus();if(i.player_.liveTracker){i.on(i.player_.liveTracker,"liveedgechange",i.updateLiveEdgeStatus)}return i}var t=e.prototype;t.createEl=function e(){var t=r.prototype.createEl.call(this,"button",{className:"vjs-seek-to-live-control vjs-control"});this.textEl_=U("span",{className:"vjs-seek-to-live-text",innerHTML:this.localize("LIVE")},{"aria-hidden":"true"});t.appendChild(this.textEl_);return t};t.updateLiveEdgeStatus=function e(t){if(!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()){this.setAttribute("aria-disabled",true);this.addClass("vjs-at-live-edge");this.controlText("Seek to live, currently playing live")}else{this.setAttribute("aria-disabled",false);this.removeClass("vjs-at-live-edge");this.controlText("Seek to live, currently behind live")}};t.handleClick=function e(){this.player_.liveTracker.seekToLiveEdge()};t.dispose=function e(){if(this.player_.liveTracker){this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatus)}this.textEl_=null;r.prototype.dispose.call(this)};return e}(bn);Rn.prototype.controlText_="Seek to live, currently playing live";Xe.registerComponent("SeekToLive",Rn);var Mn=function(n){o(e,n);function e(e,t){var i;i=n.call(this,e,t)||this;i.bar=i.getChild(i.options_.barName);i.vertical(!!i.options_.vertical);i.enable();return i}var t=e.prototype;t.enabled=function e(){return this.enabled_};t.enable=function e(){if(this.enabled()){return}this.on("mousedown",this.handleMouseDown);this.on("touchstart",this.handleMouseDown);this.on("focus",this.handleFocus);this.on("blur",this.handleBlur);this.on("click",this.handleClick);this.on(this.player_,"controlsvisible",this.update);if(this.playerEvent){this.on(this.player_,this.playerEvent,this.update)}this.removeClass("disabled");this.setAttribute("tabindex",0);this.enabled_=true};t.disable=function e(){if(!this.enabled()){return}var t=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown);this.off("touchstart",this.handleMouseDown);this.off("focus",this.handleFocus);this.off("blur",this.handleBlur);this.off("click",this.handleClick);this.off(this.player_,"controlsvisible",this.update);this.off(t,"mousemove",this.handleMouseMove);this.off(t,"mouseup",this.handleMouseUp);this.off(t,"touchmove",this.handleMouseMove);this.off(t,"touchend",this.handleMouseUp);this.removeAttribute("tabindex");this.addClass("disabled");if(this.playerEvent){this.off(this.player_,this.playerEvent,this.update)}this.enabled_=false};t.createEl=function e(t,i,r){if(i===void 0){i={}}if(r===void 0){r={}}i.className=i.className+" vjs-slider";i=b({tabIndex:0},i);r=b({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},r);return n.prototype.createEl.call(this,t,i,r)};t.handleMouseDown=function e(t){var i=this.bar.el_.ownerDocument;if(t.type==="mousedown"){t.preventDefault()}if(t.type==="touchstart"&&!ot){t.preventDefault()}z();this.addClass("vjs-sliding");this.trigger("slideractive");this.on(i,"mousemove",this.handleMouseMove);this.on(i,"mouseup",this.handleMouseUp);this.on(i,"touchmove",this.handleMouseMove);this.on(i,"touchend",this.handleMouseUp);this.handleMouseMove(t)};t.handleMouseMove=function e(t){};t.handleMouseUp=function e(){var t=this.bar.el_.ownerDocument;W();this.removeClass("vjs-sliding");this.trigger("sliderinactive");this.off(t,"mousemove",this.handleMouseMove);this.off(t,"mouseup",this.handleMouseUp);this.off(t,"touchmove",this.handleMouseMove);this.off(t,"touchend",this.handleMouseUp);this.update()};t.update=function e(){if(!this.el_){return}var t=this.getPercent();var i=this.bar;if(!i){return}if(typeof t!=="number"||t!==t||t<0||t===Infinity){t=0}var r=(t*100).toFixed(2)+"%";var n=i.el().style;if(this.vertical()){n.height=r}else{n.width=r}return t};t.calculateDistance=function e(t){var i=Y(this.el_,t);if(this.vertical()){return i.y}return i.x};t.handleFocus=function e(){this.on(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress)};t.handleKeyPress=function e(t){if(t.which===37||t.which===40){t.preventDefault();this.stepBack()}else if(t.which===38||t.which===39){t.preventDefault();this.stepForward()}};t.handleBlur=function e(){this.off(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress)};t.handleClick=function e(t){t.stopImmediatePropagation();t.preventDefault()};t.vertical=function e(t){if(t===undefined){return this.vertical_||false}this.vertical_=!!t;if(this.vertical_){this.addClass("vjs-slider-vertical")}else{this.addClass("vjs-slider-horizontal")}};return e}(Xe);Xe.registerComponent("Slider",Mn);var Bn=function(r){o(e,r);function e(e,t){var i;i=r.call(this,e,t)||this;i.partEls_=[];i.on(e,"progress",i.update);return i}var t=e.prototype;t.createEl=function e(){return r.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Loaded")+'</span>: <span class="vjs-control-text-loaded-percentage">0%</span></span>'})};t.dispose=function e(){this.partEls_=null;r.prototype.dispose.call(this)};t.update=function e(t){var i=this.player_.liveTracker;var r=this.player_.buffered();var n=i&&i.isLive()?i.seekableEnd():this.player_.duration();var a=this.player_.bufferedEnd();var s=this.partEls_;var o=this.$(".vjs-control-text-loaded-percentage");var u=function e(t,i,r){var n=t/i||0;n=(n>=1?1:n)*100;if(r){n=n.toFixed(2)}return n+"%"};this.el_.style.width=u(a,n);D(o,u(a,n,true));for(var l=0;l<r.length;l++){var c=r.start(l);var f=r.end(l);var h=s[l];if(!h){h=this.el_.appendChild(U());s[l]=h}h.style.left=u(c,a);h.style.width=u(f-c,a)}for(var d=s.length;d>r.length;d--){this.el_.removeChild(s[d-1])}s.length=r.length};return e}(Xe);Xe.registerComponent("LoadProgressBar",Bn);var Nn=function(t){o(e,t);function e(){return t.apply(this,arguments)||this}var i=e.prototype;i.createEl=function e(){return t.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})};i.update=function e(t,i,r){var n=G(this.el_);var a=G(this.player_.el());var s=t.width*i;if(!a||!n){return}var o=t.left-a.left+s;var u=t.width-s+(a.right-t.right);var l=n.width/2;if(o<l){l+=l-o}else if(u<l){l=u}if(l<0){l=0}else if(l>n.width){l=n.width}this.el_.style.right="-"+l+"px";D(this.el_,r)};i.updateTime=function e(n,a,s,o){var u=this;if(this.rafId_){this.cancelAnimationFrame(this.rafId_)}this.rafId_=this.requestAnimationFrame(function(){var e;var t=u.player_.duration();if(u.player_.liveTracker&&u.player_.liveTracker.isLive()){var i=u.player_.liveTracker.liveWindow();var r=i-a*i;e=(r<1?"":"-")+Ln(r,i)}else{e=Ln(s,t)}u.update(n,a,e);if(o){o()}})};return e}(Xe);Xe.registerComponent("TimeTooltip",Nn);var jn=function(t){o(e,t);function e(){return t.apply(this,arguments)||this}var i=e.prototype;i.createEl=function e(){return t.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})};i.update=function e(t,i){var r=this.getChild("timeTooltip");if(!r){return}var n=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();r.updateTime(t,i,n)};return e}(Xe);jn.prototype.options_={children:[]};if(!et&&!it){jn.prototype.options_.children.push("timeTooltip")}Xe.registerComponent("PlayProgressBar",jn);var Fn=function(r){o(e,r);function e(e,t){var i;i=r.call(this,e,t)||this;i.update=Le(Ae(p(p(i)),i.update),25);return i}var t=e.prototype;t.createEl=function e(){return r.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})};t.update=function e(t,i){var r=this;var n=i*this.player_.duration();this.getChild("timeTooltip").updateTime(t,i,n,function(){r.el_.style.left=t.width*i+"px"})};return e}(Xe);Fn.prototype.options_={children:["timeTooltip"]};Xe.registerComponent("MouseTimeDisplay",Fn);var Vn=5;var Hn=30;var qn=function(r){o(e,r);function e(e,t){var i;i=r.call(this,e,t)||this;i.setEventHandlers_();return i}var t=e.prototype;t.setEventHandlers_=function e(){var t=this;this.update=Le(Ae(this,this.update),Hn);this.on(this.player_,"timeupdate",this.update);this.on(this.player_,"ended",this.handleEnded);this.on(this.player_,"durationchange",this.update);if(this.player_.liveTracker){this.on(this.player_.liveTracker,"liveedgechange",this.update)}this.updateInterval=null;this.on(this.player_,["playing"],function(){t.clearInterval(t.updateInterval);t.updateInterval=t.setInterval(function(){t.requestAnimationFrame(function(){t.update()})},Hn)});this.on(this.player_,["ended","pause","waiting"],function(e){if(t.player_.liveTracker&&t.player_.liveTracker.isLive()&&e.type!=="ended"){return}t.clearInterval(t.updateInterval)});this.on(this.player_,["timeupdate","ended"],this.update)};t.createEl=function e(){return r.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})};t.update_=function e(t,i){var r=this.player_.liveTracker;var n=this.player_.duration();if(r&&r.isLive()){n=this.player_.liveTracker.liveCurrentTime()}if(r&&r.seekableEnd()===Infinity){this.disable()}else{this.enable()}this.el_.setAttribute("aria-valuenow",(i*100).toFixed(2));this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[Ln(t,n),Ln(n,n)],"{1} of {2}"));this.bar.update(G(this.el_),i)};t.update=function e(t){var i=r.prototype.update.call(this);this.update_(this.getCurrentTime_(),i);return i};t.getCurrentTime_=function e(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()};t.handleEnded=function e(t){this.update_(this.player_.duration(),1)};t.getPercent=function e(){var t=this.getCurrentTime_();var i;var r=this.player_.liveTracker;if(r&&r.isLive()){i=(t-r.seekableStart())/r.liveWindow();if(r.atLiveEdge()){i=1}}else{i=t/this.player_.duration()}return i>=1?1:i||0};t.handleMouseDown=function e(t){if(!ee(t)){return}t.stopPropagation();this.player_.scrubbing(true);this.videoWasPlaying=!this.player_.paused();this.player_.pause();r.prototype.handleMouseDown.call(this,t)};t.handleMouseMove=function e(t){if(!ee(t)){return}var i;var r=this.calculateDistance(t);var n=this.player_.liveTracker;if(!n||!n.isLive()){i=r*this.player_.duration();if(i===this.player_.duration()){i=i-.1}}else{var a=n.seekableStart();var s=n.liveCurrentTime();i=a+r*n.liveWindow();if(i>=s){i=s}if(i<=a){i=a+.1}if(i===Infinity){return}}this.player_.currentTime(i)};t.enable=function e(){r.prototype.enable.call(this);var t=this.getChild("mouseTimeDisplay");if(!t){return}t.show()};t.disable=function e(){r.prototype.disable.call(this);var t=this.getChild("mouseTimeDisplay");if(!t){return}t.hide()};t.handleMouseUp=function e(t){r.prototype.handleMouseUp.call(this,t);if(t){t.stopPropagation()}this.player_.scrubbing(false);this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:true});if(this.videoWasPlaying){Ot(this.player_.play())}};t.stepForward=function e(){this.player_.currentTime(this.player_.currentTime()+Vn)};t.stepBack=function e(){this.player_.currentTime(this.player_.currentTime()-Vn)};t.handleAction=function e(t){if(this.player_.paused()){this.player_.play()}else{this.player_.pause()}};t.handleKeyPress=function e(t){if(t.which===32||t.which===13){t.preventDefault();this.handleAction(t)}else if(r.prototype.handleKeyPress){r.prototype.handleKeyPress.call(this,t)}};return e}(Mn);qn.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"};if(!et&&!it){qn.prototype.options_.children.splice(1,0,"mouseTimeDisplay")}qn.prototype.playerEvent="timeupdate";Xe.registerComponent("SeekBar",qn);var zn=function(r){o(e,r);function e(e,t){var i;i=r.call(this,e,t)||this;i.handleMouseMove=Le(Ae(p(p(i)),i.handleMouseMove),25);i.throttledHandleMouseSeek=Le(Ae(p(p(i)),i.handleMouseSeek),25);i.enable();return i}var t=e.prototype;t.createEl=function e(){return r.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})};t.handleMouseMove=function e(t){var i=this.getChild("seekBar");if(i){var r=i.getChild("mouseTimeDisplay");var n=i.el();var a=G(n);var s=Y(n,t).x;if(s>1){s=1}else if(s<0){s=0}if(r){r.update(a,s)}}};t.handleMouseSeek=function e(t){var i=this.getChild("seekBar");if(i){i.handleMouseMove(t)}};t.enabled=function e(){return this.enabled_};t.disable=function e(){this.children().forEach(function(e){return e.disable&&e.disable()});if(!this.enabled()){return}this.off(["mousedown","touchstart"],this.handleMouseDown);this.off(this.el_,"mousemove",this.handleMouseMove);this.handleMouseUp();this.addClass("disabled");this.enabled_=false};t.enable=function e(){this.children().forEach(function(e){return e.enable&&e.enable()});if(this.enabled()){return}this.on(["mousedown","touchstart"],this.handleMouseDown);this.on(this.el_,"mousemove",this.handleMouseMove);this.removeClass("disabled");this.enabled_=true};t.handleMouseDown=function e(t){var i=this.el_.ownerDocument;var r=this.getChild("seekBar");if(r){r.handleMouseDown(t)}this.on(i,"mousemove",this.throttledHandleMouseSeek);this.on(i,"touchmove",this.throttledHandleMouseSeek);this.on(i,"mouseup",this.handleMouseUp);this.on(i,"touchend",this.handleMouseUp)};t.handleMouseUp=function e(t){var i=this.el_.ownerDocument;var r=this.getChild("seekBar");if(r){r.handleMouseUp(t)}this.off(i,"mousemove",this.throttledHandleMouseSeek);this.off(i,"touchmove",this.throttledHandleMouseSeek);this.off(i,"mouseup",this.handleMouseUp);this.off(i,"touchend",this.handleMouseUp)};return e}(Xe);zn.prototype.options_={children:["seekBar"]};Xe.registerComponent("ProgressControl",zn);var Wn=function(r){o(e,r);function e(e,t){var i;i=r.call(this,e,t)||this;i.on(e,"fullscreenchange",i.handleFullscreenChange);if(h[_t.fullscreenEnabled]===false){i.disable()}return i}var t=e.prototype;t.buildCSSClass=function e(){return"vjs-fullscreen-control "+r.prototype.buildCSSClass.call(this)};t.handleFullscreenChange=function e(t){if(this.player_.isFullscreen()){this.controlText("Non-Fullscreen")}else{this.controlText("Fullscreen")}};t.handleClick=function e(t){if(!this.player_.isFullscreen()){this.player_.requestFullscreen()}else{this.player_.exitFullscreen()}};return e}(bn);Wn.prototype.controlText_="Fullscreen";Xe.registerComponent("FullscreenToggle",Wn);var Gn=function e(t,i){if(i.tech_&&!i.tech_.featuresVolumeControl){t.addClass("vjs-hidden")}t.on(i,"loadstart",function(){if(!i.tech_.featuresVolumeControl){t.addClass("vjs-hidden")}else{t.removeClass("vjs-hidden")}})};var Xn=function(t){o(e,t);function e(){return t.apply(this,arguments)||this}var i=e.prototype;i.createEl=function e(){return t.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})};return e}(Xe);Xe.registerComponent("VolumeLevel",Xn);var Yn=function(r){o(e,r);function e(e,t){var i;i=r.call(this,e,t)||this;i.on("slideractive",i.updateLastVolume_);i.on(e,"volumechange",i.updateARIAAttributes);e.ready(function(){return i.updateARIAAttributes()});return i}var t=e.prototype;t.createEl=function e(){return r.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})};t.handleMouseDown=function e(t){if(!ee(t)){return}r.prototype.handleMouseDown.call(this,t)};t.handleMouseMove=function e(t){if(!ee(t)){return}this.checkMuted();this.player_.volume(this.calculateDistance(t))};t.checkMuted=function e(){if(this.player_.muted()){this.player_.muted(false)}};t.getPercent=function e(){if(this.player_.muted()){return 0}return this.player_.volume()};t.stepForward=function e(){this.checkMuted();this.player_.volume(this.player_.volume()+.1)};t.stepBack=function e(){this.checkMuted();this.player_.volume(this.player_.volume()-.1)};t.updateARIAAttributes=function e(t){var i=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",i);this.el_.setAttribute("aria-valuetext",i+"%")};t.volumeAsPercentage_=function e(){return Math.round(this.player_.volume()*100)};t.updateLastVolume_=function e(){var t=this;var i=this.player_.volume();this.one("sliderinactive",function(){if(t.player_.volume()===0){t.player_.lastVolume_(i)}})};return e}(Mn);Yn.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"};Yn.prototype.playerEvent="volumechange";Xe.registerComponent("VolumeBar",Yn);var $n=function(r){o(e,r);function e(e,t){var i;if(t===void 0){t={}}t.vertical=t.vertical||false;if(typeof t.volumeBar==="undefined"||S(t.volumeBar)){t.volumeBar=t.volumeBar||{};t.volumeBar.vertical=t.vertical}i=r.call(this,e,t)||this;Gn(p(p(i)),e);i.throttledHandleMouseMove=Le(Ae(p(p(i)),i.handleMouseMove),25);i.on("mousedown",i.handleMouseDown);i.on("touchstart",i.handleMouseDown);i.on(i.volumeBar,["focus","slideractive"],function(){i.volumeBar.addClass("vjs-slider-active");i.addClass("vjs-slider-active");i.trigger("slideractive")});i.on(i.volumeBar,["blur","sliderinactive"],function(){i.volumeBar.removeClass("vjs-slider-active");i.removeClass("vjs-slider-active");i.trigger("sliderinactive")});return i}var t=e.prototype;t.createEl=function e(){var t="vjs-volume-horizontal";if(this.options_.vertical){t="vjs-volume-vertical"}return r.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+t})};t.handleMouseDown=function e(t){var i=this.el_.ownerDocument;this.on(i,"mousemove",this.throttledHandleMouseMove);this.on(i,"touchmove",this.throttledHandleMouseMove);this.on(i,"mouseup",this.handleMouseUp);this.on(i,"touchend",this.handleMouseUp)};t.handleMouseUp=function e(t){var i=this.el_.ownerDocument;this.off(i,"mousemove",this.throttledHandleMouseMove);this.off(i,"touchmove",this.throttledHandleMouseMove);this.off(i,"mouseup",this.handleMouseUp);this.off(i,"touchend",this.handleMouseUp)};t.handleMouseMove=function e(t){this.volumeBar.handleMouseMove(t)};return e}(Xe);$n.prototype.options_={children:["volumeBar"]};Xe.registerComponent("VolumeControl",$n);var Kn=function e(t,i){if(i.tech_&&!i.tech_.featuresMuteControl){t.addClass("vjs-hidden")}t.on(i,"loadstart",function(){if(!i.tech_.featuresMuteControl){t.addClass("vjs-hidden")}else{t.removeClass("vjs-hidden")}})};var Jn=function(r){o(e,r);function e(e,t){var i;i=r.call(this,e,t)||this;Kn(p(p(i)),e);i.on(e,["loadstart","volumechange"],i.update);return i}var t=e.prototype;t.buildCSSClass=function e(){return"vjs-mute-control "+r.prototype.buildCSSClass.call(this)};t.handleClick=function e(t){var i=this.player_.volume();var r=this.player_.lastVolume_();if(i===0){var n=r<.1?.1:r;this.player_.volume(n);this.player_.muted(false)}else{this.player_.muted(this.player_.muted()?false:true)}};t.update=function e(t){this.updateIcon_();this.updateControlText_()};t.updateIcon_=function e(){var t=this.player_.volume();var i=3;if(et){this.player_.muted(this.player_.tech_.el_.muted)}if(t===0||this.player_.muted()){i=0}else if(t<.33){i=1}else if(t<.67){i=2}for(var r=0;r<4;r++){B(this.el_,"vjs-vol-"+r)}M(this.el_,"vjs-vol-"+i)};t.updateControlText_=function e(){var t=this.player_.muted()||this.player_.volume()===0;var i=t?"Unmute":"Mute";if(this.controlText()!==i){this.controlText(i)}};return e}(bn);Jn.prototype.controlText_="Mute";Xe.registerComponent("MuteToggle",Jn);var Qn=function(r){o(e,r);function e(e,t){var i;if(t===void 0){t={}}if(typeof t.inline!=="undefined"){t.inline=t.inline}else{t.inline=true}if(typeof t.volumeControl==="undefined"||S(t.volumeControl)){t.volumeControl=t.volumeControl||{};t.volumeControl.vertical=!t.inline}i=r.call(this,e,t)||this;i.on(e,["loadstart"],i.volumePanelState_);i.on(i.volumeControl,["slideractive"],i.sliderActive_);i.on(i.volumeControl,["sliderinactive"],i.sliderInactive_);return i}var t=e.prototype;t.sliderActive_=function e(){this.addClass("vjs-slider-active")};t.sliderInactive_=function e(){this.removeClass("vjs-slider-active")};t.volumePanelState_=function e(){if(this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")){this.addClass("vjs-hidden")}if(this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")){this.addClass("vjs-mute-toggle-only")}};t.createEl=function e(){var t="vjs-volume-panel-horizontal";if(!this.options_.inline){t="vjs-volume-panel-vertical"}return r.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+t})};return e}(Xe);Qn.prototype.options_={children:["muteToggle","volumeControl"]};Xe.registerComponent("VolumePanel",Qn);var Zn=function(r){o(e,r);function e(e,t){var i;i=r.call(this,e,t)||this;if(t){i.menuButton_=t.menuButton}i.focusedChild_=-1;i.on("keydown",i.handleKeyPress);return i}var t=e.prototype;t.addItem=function e(t){this.addChild(t);t.on("blur",Ae(this,this.handleBlur));t.on(["tap","click"],Ae(this,function(e){if(this.menuButton_){this.menuButton_.unpressButton();if(t.name()!=="CaptionSettingsMenuItem"){this.menuButton_.focus()}}}))};t.createEl=function e(){var t=this.options_.contentElType||"ul";this.contentEl_=U(t,{className:"vjs-menu-content"});this.contentEl_.setAttribute("role","menu");var i=r.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});i.appendChild(this.contentEl_);ve(i,"click",function(e){e.preventDefault();e.stopImmediatePropagation()});return i};t.dispose=function e(){this.contentEl_=null;r.prototype.dispose.call(this)};t.handleBlur=function e(t){var i=t.relatedTarget||h.activeElement;if(!this.children().some(function(e){return e.el()===i})){var r=this.menuButton_;if(r&&r.buttonPressed_&&i!==r.el().firstChild){r.unpressButton()}}};t.handleKeyPress=function e(t){if(t.which===37||t.which===40){t.preventDefault();this.stepForward()}else if(t.which===38||t.which===39){t.preventDefault();this.stepBack()}};t.stepForward=function e(){var t=0;if(this.focusedChild_!==undefined){t=this.focusedChild_+1}this.focus(t)};t.stepBack=function e(){var t=0;if(this.focusedChild_!==undefined){t=this.focusedChild_-1}this.focus(t)};t.focus=function e(t){if(t===void 0){t=0}var i=this.children().slice();var r=i.length&&i[0].className&&/vjs-menu-title/.test(i[0].className);if(r){i.shift()}if(i.length>0){if(t<0){t=0}else if(t>=i.length){t=i.length-1}this.focusedChild_=t;i[t].el_.focus()}};return e}(Xe);Xe.registerComponent("Menu",Zn);var ea=function(n){o(e,n);function e(e,t){var i;if(t===void 0){t={}}i=n.call(this,e,t)||this;i.menuButton_=new bn(e,t);i.menuButton_.controlText(i.controlText_);i.menuButton_.el_.setAttribute("aria-haspopup","true");var r=bn.prototype.buildCSSClass();i.menuButton_.el_.className=i.buildCSSClass()+" "+r;i.menuButton_.removeClass("vjs-control");i.addChild(i.menuButton_);i.update();i.enabled_=true;i.on(i.menuButton_,"tap",i.handleClick);i.on(i.menuButton_,"click",i.handleClick);i.on(i.menuButton_,"focus",i.handleFocus);i.on(i.menuButton_,"blur",i.handleBlur);i.on(i.menuButton_,"mouseenter",function(){i.menu.show()});i.on("keydown",i.handleSubmenuKeyPress);return i}var t=e.prototype;t.update=function e(){var t=this.createMenu();if(this.menu){this.menu.dispose();this.removeChild(this.menu)}this.menu=t;this.addChild(t);this.buttonPressed_=false;this.menuButton_.el_.setAttribute("aria-expanded","false");if(this.items&&this.items.length<=this.hideThreshold_){this.hide()}else{this.show()}};t.createMenu=function e(){var t=new Zn(this.player_,{menuButton:this});this.hideThreshold_=0;if(this.options_.title){var i=U("li",{className:"vjs-menu-title",innerHTML:ze(this.options_.title),tabIndex:-1});this.hideThreshold_+=1;t.children_.unshift(i);x(i,t.contentEl())}this.items=this.createItems();if(this.items){for(var r=0;r<this.items.length;r++){t.addItem(this.items[r])}}return t};t.createItems=function e(){};t.createEl=function e(){return n.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})};t.buildWrapperCSSClass=function e(){var t="vjs-menu-button";if(this.options_.inline===true){t+="-inline"}else{t+="-popup"}var i=bn.prototype.buildCSSClass();return"vjs-menu-button "+t+" "+i+" "+n.prototype.buildCSSClass.call(this)};t.buildCSSClass=function e(){var t="vjs-menu-button";if(this.options_.inline===true){t+="-inline"}else{t+="-popup"}return"vjs-menu-button "+t+" "+n.prototype.buildCSSClass.call(this)};t.controlText=function e(t,i){if(i===void 0){i=this.menuButton_.el()}return this.menuButton_.controlText(t,i)};t.handleClick=function e(t){if(this.buttonPressed_){this.unpressButton()}else{this.pressButton()}};t.focus=function e(){this.menuButton_.focus()};t.blur=function e(){this.menuButton_.blur()};t.handleFocus=function e(){ve(h,"keydown",Ae(this,this.handleKeyPress))};t.handleBlur=function e(){ge(h,"keydown",Ae(this,this.handleKeyPress))};t.handleKeyPress=function e(t){if(t.which===27||t.which===9){if(this.buttonPressed_){this.unpressButton()}if(t.which!==9){t.preventDefault();this.menuButton_.el_.focus()}}else if(t.which===13||t.which===38||t.which===40){if(!this.buttonPressed_){this.pressButton();t.preventDefault()}}};t.handleSubmenuKeyPress=function e(t){if(t.which===27||t.which===9){if(this.buttonPressed_){this.unpressButton()}if(t.which!==9){t.preventDefault();this.menuButton_.el_.focus()}}};t.pressButton=function e(){if(this.enabled_){this.buttonPressed_=true;this.menu.show();this.menu.lockShowing();this.menuButton_.el_.setAttribute("aria-expanded","true");if(et&&O()){return}this.menu.focus()}};t.unpressButton=function e(){if(this.enabled_){this.buttonPressed_=false;this.menu.unlockShowing();this.menu.hide();this.menuButton_.el_.setAttribute("aria-expanded","false")}};t.disable=function e(){this.unpressButton();this.enabled_=false;this.addClass("vjs-disabled");this.menuButton_.disable()};t.enable=function e(){this.enabled_=true;this.removeClass("vjs-disabled");this.menuButton_.enable()};return e}(Xe);Xe.registerComponent("MenuButton",ea);var ta=function(a){o(e,a);function e(e,t){var i;var r=t.tracks;i=a.call(this,e,t)||this;if(i.items.length<=1){i.hide()}if(!r){return p(i)}var n=Ae(p(p(i)),i.update);r.addEventListener("removetrack",n);r.addEventListener("addtrack",n);i.player_.on("ready",n);i.player_.on("dispose",function(){r.removeEventListener("removetrack",n);r.removeEventListener("addtrack",n)});return i}return e}(ea);Xe.registerComponent("TrackButton",ta);var ia=function(n){o(e,n);function e(e,t){var i;i=n.call(this,e,t)||this;i.selectable=t.selectable;i.isSelected_=t.selected||false;i.multiSelectable=t.multiSelectable;i.selected(i.isSelected_);if(i.selectable){if(i.multiSelectable){i.el_.setAttribute("role","menuitemcheckbox")}else{i.el_.setAttribute("role","menuitemradio")}}else{i.el_.setAttribute("role","menuitem")}return i}var t=e.prototype;t.createEl=function e(t,i,r){this.nonIconControl=true;return n.prototype.createEl.call(this,"li",b({className:"vjs-menu-item",innerHTML:'<span class="vjs-menu-item-text">'+this.localize(this.options_.label)+"</span>",tabIndex:-1},i),r)};t.handleClick=function e(t){this.selected(true)};t.selected=function e(t){if(this.selectable){if(t){this.addClass("vjs-selected");this.el_.setAttribute("aria-checked","true");this.controlText(", selected");this.isSelected_=true}else{this.removeClass("vjs-selected");this.el_.setAttribute("aria-checked","false");this.controlText("");this.isSelected_=false}}};return e}(fn);Xe.registerComponent("MenuItem",ia);var ra=function(u){o(e,u);function e(e,t){var n;var i=t.track;var r=e.textTracks();t.label=i.label||i.language||"Unknown";t.selected=i.mode==="showing";n=u.call(this,e,t)||this;n.track=i;var a=function e(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++){i[r]=arguments[r]}n.handleTracksChange.apply(p(p(n)),i)};var s=function e(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++){i[r]=arguments[r]}n.handleSelectedLanguageChange.apply(p(p(n)),i)};e.on(["loadstart","texttrackchange"],a);r.addEventListener("change",a);r.addEventListener("selectedlanguagechange",s);n.on("dispose",function(){e.off(["loadstart","texttrackchange"],a);r.removeEventListener("change",a);r.removeEventListener("selectedlanguagechange",s)});if(r.onchange===undefined){var o;n.on(["tap","click"],function(){if(typeof _.Event!=="object"){try{o=new _.Event("change")}catch(e){}}if(!o){o=h.createEvent("Event");o.initEvent("change",true,true)}r.dispatchEvent(o)})}n.handleTracksChange();return n}var t=e.prototype;t.handleClick=function e(t){var i=this.track.kind;var r=this.track.kinds;var n=this.player_.textTracks();if(!r){r=[i]}u.prototype.handleClick.call(this,t);if(!n){return}for(var a=0;a<n.length;a++){var s=n[a];if(s===this.track&&r.indexOf(s.kind)>-1){if(s.mode!=="showing"){s.mode="showing"}}else if(s.mode!=="disabled"){s.mode="disabled"}}};t.handleTracksChange=function e(t){var i=this.track.mode==="showing";if(i!==this.isSelected_){this.selected(i)}};t.handleSelectedLanguageChange=function e(t){if(this.track.mode==="showing"){var i=this.player_.cache_.selectedLanguage;if(i&&i.enabled&&i.language===this.track.language&&i.kind!==this.track.kind){return}this.player_.cache_.selectedLanguage={enabled:true,language:this.track.language,kind:this.track.kind}}};t.dispose=function e(){this.track=null;u.prototype.dispose.call(this)};return e}(ia);Xe.registerComponent("TextTrackMenuItem",ra);var na=function(i){o(e,i);function e(e,t){t.track={player:e,kind:t.kind,kinds:t.kinds,default:false,mode:"disabled"};if(!t.kinds){t.kinds=[t.kind]}if(t.label){t.track.label=t.label}else{t.track.label=t.kinds.join(" and ")+" off"}t.selectable=true;t.multiSelectable=false;return i.call(this,e,t)||this}var t=e.prototype;t.handleTracksChange=function e(t){var i=this.player().textTracks();var r=true;for(var n=0,a=i.length;n<a;n++){var s=i[n];if(this.options_.kinds.indexOf(s.kind)>-1&&s.mode==="showing"){r=false;break}}if(r!==this.isSelected_){this.selected(r)}};t.handleSelectedLanguageChange=function e(t){var i=this.player().textTracks();var r=true;for(var n=0,a=i.length;n<a;n++){var s=i[n];if(["captions","descriptions","subtitles"].indexOf(s.kind)>-1&&s.mode==="showing"){r=false;break}}if(r){this.player_.cache_.selectedLanguage={enabled:false}}};return e}(ra);Xe.registerComponent("OffTextTrackMenuItem",na);var aa=function(i){o(e,i);function e(e,t){if(t===void 0){t={}}t.tracks=e.textTracks();return i.call(this,e,t)||this}var t=e.prototype;t.createItems=function e(t,i){if(t===void 0){t=[]}if(i===void 0){i=ra}var r;if(this.label_){r=this.label_+" off"}t.push(new na(this.player_,{kinds:this.kinds_,kind:this.kind_,label:r}));this.hideThreshold_+=1;var n=this.player_.textTracks();if(!Array.isArray(this.kinds_)){this.kinds_=[this.kind_]}for(var a=0;a<n.length;a++){var s=n[a];if(this.kinds_.indexOf(s.kind)>-1){var o=new i(this.player_,{track:s,selectable:true,multiSelectable:false});o.addClass("vjs-"+s.kind+"-menu-item");t.push(o)}}return t};return e}(ta);Xe.registerComponent("TextTrackButton",aa);var sa=function(s){o(e,s);function e(e,t){var i;var r=t.track;var n=t.cue;var a=e.currentTime();t.selectable=true;t.multiSelectable=false;t.label=n.text;t.selected=n.startTime<=a&&a<n.endTime;i=s.call(this,e,t)||this;i.track=r;i.cue=n;r.addEventListener("cuechange",Ae(p(p(i)),i.update));return i}var t=e.prototype;t.handleClick=function e(t){s.prototype.handleClick.call(this);this.player_.currentTime(this.cue.startTime);this.update(this.cue.startTime)};t.update=function e(t){var i=this.cue;var r=this.player_.currentTime();this.selected(i.startTime<=r&&r<i.endTime)};return e}(ia);Xe.registerComponent("ChaptersTrackMenuItem",sa);var oa=function(r){o(e,r);function e(e,t,i){return r.call(this,e,t,i)||this}var t=e.prototype;t.buildCSSClass=function e(){return"vjs-chapters-button "+r.prototype.buildCSSClass.call(this)};t.buildWrapperCSSClass=function e(){return"vjs-chapters-button "+r.prototype.buildWrapperCSSClass.call(this)};t.update=function e(t){if(!this.track_||t&&(t.type==="addtrack"||t.type==="removetrack")){this.setTrack(this.findChaptersTrack())}r.prototype.update.call(this)};t.setTrack=function e(t){if(this.track_===t){return}if(!this.updateHandler_){this.updateHandler_=this.update.bind(this)}if(this.track_){var i=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);if(i){i.removeEventListener("load",this.updateHandler_)}this.track_=null}this.track_=t;if(this.track_){this.track_.mode="hidden";var r=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);if(r){r.addEventListener("load",this.updateHandler_)}}};t.findChaptersTrack=function e(){var t=this.player_.textTracks()||[];for(var i=t.length-1;i>=0;i--){var r=t[i];if(r.kind===this.kind_){return r}}};t.getMenuCaption=function e(){if(this.track_&&this.track_.label){return this.track_.label}return this.localize(ze(this.kind_))};t.createMenu=function e(){this.options_.title=this.getMenuCaption();return r.prototype.createMenu.call(this)};t.createItems=function e(){var t=[];if(!this.track_){return t}var i=this.track_.cues;if(!i){return t}for(var r=0,n=i.length;r<n;r++){var a=i[r];var s=new sa(this.player_,{track:this.track_,cue:a});t.push(s)}return t};return e}(aa);oa.prototype.kind_="chapters";oa.prototype.controlText_="Chapters";Xe.registerComponent("ChaptersButton",oa);var ua=function(s){o(e,s);function e(e,t,i){var r;r=s.call(this,e,t,i)||this;var n=e.textTracks();var a=Ae(p(p(r)),r.handleTracksChange);n.addEventListener("change",a);r.on("dispose",function(){n.removeEventListener("change",a)});return r}var t=e.prototype;t.handleTracksChange=function e(t){var i=this.player().textTracks();var r=false;for(var n=0,a=i.length;n<a;n++){var s=i[n];if(s.kind!==this.kind_&&s.mode==="showing"){r=true;break}}if(r){this.disable()}else{this.enable()}};t.buildCSSClass=function e(){return"vjs-descriptions-button "+s.prototype.buildCSSClass.call(this)};t.buildWrapperCSSClass=function e(){return"vjs-descriptions-button "+s.prototype.buildWrapperCSSClass.call(this)};return e}(aa);ua.prototype.kind_="descriptions";ua.prototype.controlText_="Descriptions";Xe.registerComponent("DescriptionsButton",ua);var la=function(r){o(e,r);function e(e,t,i){return r.call(this,e,t,i)||this}var t=e.prototype;t.buildCSSClass=function e(){return"vjs-subtitles-button "+r.prototype.buildCSSClass.call(this)};t.buildWrapperCSSClass=function e(){return"vjs-subtitles-button "+r.prototype.buildWrapperCSSClass.call(this)};return e}(aa);la.prototype.kind_="subtitles";la.prototype.controlText_="Subtitles";Xe.registerComponent("SubtitlesButton",la);var ca=function(r){o(e,r);function e(e,t){var i;t.track={player:e,kind:t.kind,label:t.kind+" settings",selectable:false,default:false,mode:"disabled"};t.selectable=false;t.name="CaptionSettingsMenuItem";i=r.call(this,e,t)||this;i.addClass("vjs-texttrack-settings");i.controlText(", opens "+t.kind+" settings dialog");return i}var t=e.prototype;t.handleClick=function e(t){this.player().getChild("textTrackSettings").open()};return e}(ra);Xe.registerComponent("CaptionSettingsMenuItem",ca);var fa=function(r){o(e,r);function e(e,t,i){return r.call(this,e,t,i)||this}var t=e.prototype;t.buildCSSClass=function e(){return"vjs-captions-button "+r.prototype.buildCSSClass.call(this)};t.buildWrapperCSSClass=function e(){return"vjs-captions-button "+r.prototype.buildWrapperCSSClass.call(this)};t.createItems=function e(){var t=[];if(!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")){t.push(new ca(this.player_,{kind:this.kind_}));this.hideThreshold_+=1}return r.prototype.createItems.call(this,t)};return e}(aa);fa.prototype.kind_="captions";fa.prototype.controlText_="Captions";Xe.registerComponent("CaptionsButton",fa);var ha=function(s){o(e,s);function e(){return s.apply(this,arguments)||this}var t=e.prototype;t.createEl=function e(t,i,r){var n='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);if(this.options_.track.kind==="captions"){n+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Captions")+"</span>\n      "}n+="</span>";var a=s.prototype.createEl.call(this,t,b({innerHTML:n},i),r);return a};return e}(ra);Xe.registerComponent("SubsCapsMenuItem",ha);var da=function(r){o(e,r);function e(e,t){var i;if(t===void 0){t={}}i=r.call(this,e,t)||this;i.label_="subtitles";if(["en","en-us","en-ca","fr-ca"].indexOf(i.player_.language_)>-1){i.label_="captions"}i.menuButton_.controlText(ze(i.label_));return i}var t=e.prototype;t.buildCSSClass=function e(){return"vjs-subs-caps-button "+r.prototype.buildCSSClass.call(this)};t.buildWrapperCSSClass=function e(){return"vjs-subs-caps-button "+r.prototype.buildWrapperCSSClass.call(this)};t.createItems=function e(){var t=[];if(!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")){t.push(new ca(this.player_,{kind:this.label_}));this.hideThreshold_+=1}t=r.prototype.createItems.call(this,t,ha);return t};return e}(aa);da.prototype.kinds_=["captions","subtitles"];da.prototype.controlText_="Subtitles";Xe.registerComponent("SubsCapsButton",da);var pa=function(s){o(e,s);function e(e,t){var n;var i=t.track;var r=e.audioTracks();t.label=i.label||i.language||"Unknown";t.selected=i.enabled;n=s.call(this,e,t)||this;n.track=i;n.addClass("vjs-"+i.kind+"-menu-item");var a=function e(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++){i[r]=arguments[r]}n.handleTracksChange.apply(p(p(n)),i)};r.addEventListener("change",a);n.on("dispose",function(){r.removeEventListener("change",a)});return n}var t=e.prototype;t.createEl=function e(t,i,r){var n='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);if(this.options_.track.kind==="main-desc"){n+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Descriptions")+"</span>\n      "}n+="</span>";var a=s.prototype.createEl.call(this,t,b({innerHTML:n},i),r);return a};t.handleClick=function e(t){var i=this.player_.audioTracks();s.prototype.handleClick.call(this,t);for(var r=0;r<i.length;r++){var n=i[r];n.enabled=n===this.track}};t.handleTracksChange=function e(t){this.selected(this.track.enabled)};return e}(ia);Xe.registerComponent("AudioTrackMenuItem",pa);var ma=function(i){o(e,i);function e(e,t){if(t===void 0){t={}}t.tracks=e.audioTracks();return i.call(this,e,t)||this}var t=e.prototype;t.buildCSSClass=function e(){return"vjs-audio-button "+i.prototype.buildCSSClass.call(this)};t.buildWrapperCSSClass=function e(){return"vjs-audio-button "+i.prototype.buildWrapperCSSClass.call(this)};t.createItems=function e(t){if(t===void 0){t=[]}this.hideThreshold_=1;var i=this.player_.audioTracks();for(var r=0;r<i.length;r++){var n=i[r];t.push(new pa(this.player_,{track:n,selectable:true,multiSelectable:false}))}return t};return e}(ta);ma.prototype.controlText_="Audio Track";Xe.registerComponent("AudioTrackButton",ma);var va=function(a){o(e,a);function e(e,t){var i;var r=t.rate;var n=parseFloat(r,10);t.label=r;t.selected=n===1;t.selectable=true;t.multiSelectable=false;i=a.call(this,e,t)||this;i.label=r;i.rate=n;i.on(e,"ratechange",i.update);return i}var t=e.prototype;t.handleClick=function e(t){a.prototype.handleClick.call(this);this.player().playbackRate(this.rate)};t.update=function e(t){this.selected(this.player().playbackRate()===this.rate)};return e}(ia);va.prototype.contentElType="button";Xe.registerComponent("PlaybackRateMenuItem",va);var ga=function(r){o(e,r);function e(e,t){var i;i=r.call(this,e,t)||this;i.updateVisibility();i.updateLabel();i.on(e,"loadstart",i.updateVisibility);i.on(e,"ratechange",i.updateLabel);return i}var t=e.prototype;t.createEl=function e(){var t=r.prototype.createEl.call(this);this.labelEl_=U("div",{className:"vjs-playback-rate-value",innerHTML:"1x"});t.appendChild(this.labelEl_);return t};t.dispose=function e(){this.labelEl_=null;r.prototype.dispose.call(this)};t.buildCSSClass=function e(){return"vjs-playback-rate "+r.prototype.buildCSSClass.call(this)};t.buildWrapperCSSClass=function e(){return"vjs-playback-rate "+r.prototype.buildWrapperCSSClass.call(this)};t.createMenu=function e(){var t=new Zn(this.player());var i=this.playbackRates();if(i){for(var r=i.length-1;r>=0;r--){t.addChild(new va(this.player(),{rate:i[r]+"x"}))}}return t};t.updateARIAAttributes=function e(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())};t.handleClick=function e(t){var i=this.player().playbackRate();var r=this.playbackRates();var n=r[0];for(var a=0;a<r.length;a++){if(r[a]>i){n=r[a];break}}this.player().playbackRate(n)};t.playbackRates=function e(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates};t.playbackRateSupported=function e(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0};t.updateVisibility=function e(t){if(this.playbackRateSupported()){this.removeClass("vjs-hidden")}else{this.addClass("vjs-hidden")}};t.updateLabel=function e(t){if(this.playbackRateSupported()){this.labelEl_.innerHTML=this.player().playbackRate()+"x"}};return e}(ea);ga.prototype.controlText_="Playback Rate";Xe.registerComponent("PlaybackRateMenuButton",ga);var ya=function(t){o(e,t);function e(){return t.apply(this,arguments)||this}var i=e.prototype;i.buildCSSClass=function e(){return"vjs-spacer "+t.prototype.buildCSSClass.call(this)};i.createEl=function e(){return t.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})};return e}(Xe);Xe.registerComponent("Spacer",ya);var _a=function(i){o(e,i);function e(){return i.apply(this,arguments)||this}var t=e.prototype;t.buildCSSClass=function e(){return"vjs-custom-control-spacer "+i.prototype.buildCSSClass.call(this)};t.createEl=function e(){var t=i.prototype.createEl.call(this,{className:this.buildCSSClass()});t.innerHTML=" ";return t};return e}(ya);Xe.registerComponent("CustomControlSpacer",_a);var ba=function(t){o(e,t);function e(){return t.apply(this,arguments)||this}var i=e.prototype;i.createEl=function e(){return t.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})};return e}(Xe);ba.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]};Xe.registerComponent("ControlBar",ba);var Ta=function(r){o(e,r);function e(e,t){var i;i=r.call(this,e,t)||this;i.on(e,"error",i.open);return i}var t=e.prototype;t.buildCSSClass=function e(){return"vjs-error-display "+r.prototype.buildCSSClass.call(this)};t.content=function e(){var t=this.player().error();return t?this.localize(t.message):""};return e}(Bt);Ta.prototype.options_=Ge(Bt.prototype.options_,{pauseOnOpen:false,fillAlways:true,temporary:false,uncloseable:true});Xe.registerComponent("ErrorDisplay",Ta);var Sa="vjs-text-track-settings";var ka=["#000","Black"];var wa=["#00F","Blue"];var Ca=["#0FF","Cyan"];var Ea=["#0F0","Green"];var Aa=["#F0F","Magenta"];var La=["#F00","Red"];var Ia=["#FFF","White"];var Oa=["#FF0","Yellow"];var Pa=["1","Opaque"];var Ua=["0.5","Semi-Transparent"];var Da=["0","Transparent"];var xa={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[ka,Ia,La,Ea,wa,Oa,Aa,Ca]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[Pa,Ua,Da]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[Ia,ka,La,Ea,wa,Oa,Aa,Ca]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function e(t){return t==="1.00"?null:Number(t)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[Pa,Ua]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[Da,Ua,Pa]}};xa.windowColor.options=xa.backgroundColor.options;function Ra(e,t){if(t){e=t(e)}if(e&&e!=="none"){return e}}function Ma(e,t){var i=e.options[e.options.selectedIndex].value;return Ra(i,t)}function Ba(e,t,i){if(!t){return}for(var r=0;r<e.options.length;r++){if(Ra(e.options[r].value,i)===t){e.selectedIndex=r;break}}}var Na=function(r){o(e,r);function e(e,t){var i;t.temporary=false;i=r.call(this,e,t)||this;i.updateDisplay=Ae(p(p(i)),i.updateDisplay);i.fill();i.hasBeenOpened_=i.hasBeenFilled_=true;i.endDialog=U("p",{className:"vjs-control-text",textContent:i.localize("End of dialog window.")});i.el().appendChild(i.endDialog);i.setDefaults();if(t.persistTextTrackSettings===undefined){i.options_.persistTextTrackSettings=i.options_.playerOptions.persistTextTrackSettings}i.on(i.$(".vjs-done-button"),"click",function(){i.saveSettings();i.close()});i.on(i.$(".vjs-default-button"),"click",function(){i.setDefaults();i.updateDisplay()});y(xa,function(e){i.on(i.$(e.selector),"change",i.updateDisplay)});if(i.options_.persistTextTrackSettings){i.restoreSettings()}return i}var t=e.prototype;t.dispose=function e(){this.endDialog=null;r.prototype.dispose.call(this)};t.createElSelect_=function e(t,i,r){var n=this;if(i===void 0){i=""}if(r===void 0){r="label"}var a=xa[t];var s=a.id.replace("%s",this.id_);var o=[i,s].join(" ").trim();return["<"+r+' id="'+s+'" class="'+(r==="label"?"vjs-label":"")+'">',this.localize(a.label),"</"+r+">",'<select aria-labelledby="'+o+'">'].concat(a.options.map(function(e){var t=s+"-"+e[1].replace(/\W+/g,"");return['<option id="'+t+'" value="'+e[0]+'" ','aria-labelledby="'+o+" "+t+'">',n.localize(e[1]),"</option>"].join("")})).concat("</select>").join("")};t.createElFgColor_=function e(){var t="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+t+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",t),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",t),"</span>","</fieldset>"].join("")};t.createElBgColor_=function e(){var t="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+t+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",t),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",t),"</span>","</fieldset>"].join("")};t.createElWinColor_=function e(){var t="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+t+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",t),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",t),"</span>","</fieldset>"].join("")};t.createElColors_=function e(){return U("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})};t.createElFont_=function e(){return U("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})};t.createElControls_=function e(){var t=this.localize("restore all settings to the default values");return U("div",{className:"vjs-track-settings-controls",innerHTML:['<button type="button" class="vjs-default-button" title="'+t+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+t+"</span>","</button>",'<button type="button" class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})};t.content=function e(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]};t.label=function e(){return this.localize("Caption Settings Dialog")};t.description=function e(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")};t.buildCSSClass=function e(){return r.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"};t.getValues=function e(){var n=this;return i(xa,function(e,t,i){var r=Ma(n.$(t.selector),t.parser);if(r!==undefined){e[i]=r}return e},{})};t.setValues=function e(i){var r=this;y(xa,function(e,t){Ba(r.$(e.selector),i[t],e.parser)})};t.setDefaults=function e(){var i=this;y(xa,function(e){var t=e.hasOwnProperty("default")?e.default:0;i.$(e.selector).selectedIndex=t})};t.restoreSettings=function e(){var t;try{t=JSON.parse(_.localStorage.getItem(Sa))}catch(e){m.warn(e)}if(t){this.setValues(t)}};t.saveSettings=function e(){if(!this.options_.persistTextTrackSettings){return}var t=this.getValues();try{if(Object.keys(t).length){_.localStorage.setItem(Sa,JSON.stringify(t))}else{_.localStorage.removeItem(Sa)}}catch(e){m.warn(e)}};t.updateDisplay=function e(){var t=this.player_.getChild("textTrackDisplay");if(t){t.updateDisplay()}};t.conditionalBlur_=function e(){this.previouslyActiveEl_=null;this.off(h,"keydown",this.handleKeyDown);var t=this.player_.controlBar;var i=t&&t.subsCapsButton;var r=t&&t.captionsButton;if(i){i.focus()}else if(r){r.focus()}};return e}(Bt);Xe.registerComponent("TextTrackSettings",Na);var ja=function(a){o(e,a);function e(e,t){var i;var r=t.ResizeObserver||_.ResizeObserver;if(t.ResizeObserver===null){r=false}var n=Ge({createEl:!r,reportTouchActivity:false},t);i=a.call(this,e,n)||this;i.ResizeObserver=t.ResizeObserver||_.ResizeObserver;i.loadListener_=null;i.resizeObserver_=null;i.debouncedHandler_=Ie(function(){i.resizeHandler()},100,false,p(p(i)));if(r){i.resizeObserver_=new i.ResizeObserver(i.debouncedHandler_);i.resizeObserver_.observe(e.el())}else{i.loadListener_=function(){if(!i.el_||!i.el_.contentWindow){return}ve(i.el_.contentWindow,"resize",i.debouncedHandler_)};i.one("load",i.loadListener_)}return i}var t=e.prototype;t.createEl=function e(){return a.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager"})};t.resizeHandler=function e(){if(!this.player_||!this.player_.trigger){return}this.player_.trigger("playerresize")};t.dispose=function e(){if(this.debouncedHandler_){this.debouncedHandler_.cancel()}if(this.resizeObserver_){if(this.player_.el()){this.resizeObserver_.unobserve(this.player_.el())}this.resizeObserver_.disconnect()}if(this.el_&&this.el_.contentWindow){ge(this.el_.contentWindow,"resize",this.debouncedHandler_)}if(this.loadListener_){this.off("load",this.loadListener_)}this.ResizeObserver=null;this.resizeObserver=null;this.debouncedHandler_=null;this.loadListener_=null};return e}(Xe);Xe.registerComponent("ResizeManager",ja);var Fa=function(n){o(e,n);function e(e,t){var i;var r=Ge({createEl:false},t);i=n.call(this,e,r)||this;i.reset_();i.on(i.player_,"durationchange",i.handleDurationchange);return i}var t=e.prototype;t.isBehind_=function e(){if(!this.timeupdateSeen_){return false}var t=this.liveCurrentTime();var i=this.player_.currentTime();var r=this.seekableIncrement_;var n=r*2+.07;return t!==Infinity&&t-n>=i};t.trackLive_=function e(){this.pastSeekEnd_=this.pastSeekEnd_;var t=this.player_.seekable();if(!t||!t.length){return}var i=this.seekableEnd();if(i!==this.lastSeekEnd_){if(this.lastSeekEnd_){this.seekableIncrement_=Math.abs(i-this.lastSeekEnd_)}this.pastSeekEnd_=0;this.lastSeekEnd_=i;this.trigger("seekableendchange")}this.pastSeekEnd_=this.pastSeekEnd()+.03;if(this.isBehind_()!==this.behindLiveEdge()){this.behindLiveEdge_=this.isBehind_();this.trigger("liveedgechange")}};t.handleDurationchange=function e(){if(this.player_.duration()===Infinity){this.startTracking()}else{this.stopTracking()}};t.startTracking=function e(){var t=this;if(this.isTracking()){return}this.trackingInterval_=this.setInterval(this.trackLive_,30);this.trackLive_();this.on(this.player_,"play",this.trackLive_);this.on(this.player_,"pause",this.trackLive_);this.one(this.player_,"play",this.handlePlay);if(!this.timeupdateSeen_){this.handleTimeupdate=function(){t.timeupdateSeen_=true;t.handleTimeupdate=null};this.one(this.player_,"timeupdate",this.handleTimeupdate)}};t.handlePlay=function e(){this.one(this.player_,"timeupdate",this.seekToLiveEdge)};t.reset_=function e(){this.pastSeekEnd_=0;this.lastSeekEnd_=null;this.behindLiveEdge_=null;this.timeupdateSeen_=false;this.clearInterval(this.trackingInterval_);this.trackingInterval_=null;this.seekableIncrement_=12;this.off(this.player_,"play",this.trackLive_);this.off(this.player_,"pause",this.trackLive_);this.off(this.player_,"play",this.handlePlay);this.off(this.player_,"timeupdate",this.seekToLiveEdge);if(this.handleTimeupdate){this.off(this.player_,"timeupdate",this.handleTimeupdate);this.handleTimeupdate=null}};t.stopTracking=function e(){if(!this.isTracking()){return}this.reset_()};t.seekableEnd=function e(){var t=this.player_.seekable();var i=[];var r=t?t.length:0;while(r--){i.push(t.end(r))}return i.length?i.sort()[i.length-1]:Infinity};t.seekableStart=function e(){var t=this.player_.seekable();var i=[];var r=t?t.length:0;while(r--){i.push(t.start(r))}return i.length?i.sort()[0]:0};t.liveWindow=function e(){var t=this.liveCurrentTime();if(t===Infinity){return Infinity}return t-this.seekableStart()};t.isLive=function e(){return this.isTracking()};t.atLiveEdge=function e(){return!this.behindLiveEdge()};t.liveCurrentTime=function e(){return this.pastSeekEnd()+this.seekableEnd()};t.pastSeekEnd=function e(){return this.pastSeekEnd_};t.behindLiveEdge=function e(){return this.behindLiveEdge_};t.isTracking=function e(){return typeof this.trackingInterval_==="number"};t.seekToLiveEdge=function e(){if(this.atLiveEdge()){return}this.player_.currentTime(this.liveCurrentTime());if(this.player_.paused()){this.player_.play()}};t.dispose=function e(){this.stopTracking();n.prototype.dispose.call(this)};return e}(Xe);Xe.registerComponent("LiveTracker",Fa);var Va=function e(t){var i=t.el();if(i.hasAttribute("src")){t.triggerSourceset(i.src);return true}var r=t.$$("source");var n=[];var a="";if(!r.length){return false}for(var s=0;s<r.length;s++){var o=r[s].src;if(o&&n.indexOf(o)===-1){n.push(o)}}if(!n.length){return false}if(n.length===1){a=n[0]}t.triggerSourceset(a);return true};var Ha=Object.defineProperty({},"innerHTML",{get:function e(){return this.cloneNode(true).innerHTML},set:function e(t){var i=h.createElement(this.nodeName.toLowerCase());i.innerHTML=t;var r=h.createDocumentFragment();while(i.childNodes.length){r.appendChild(i.childNodes[0])}this.innerText="";_.Element.prototype.appendChild.call(this,r);return this.innerHTML}});var qa=function e(t,i){var r={};for(var n=0;n<t.length;n++){r=Object.getOwnPropertyDescriptor(t[n],i);if(r&&r.set&&r.get){break}}r.enumerable=true;r.configurable=true;return r};var za=function e(t){return qa([t.el(),_.HTMLMediaElement.prototype,_.Element.prototype,Ha],"innerHTML")};var Wa=function e(a){var s=a.el();if(s.resetSourceWatch_){return}var t={};var i=za(a);var r=function e(n){return function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++){t[i]=arguments[i]}var r=n.apply(s,t);Va(a);return r}};["append","appendChild","insertAdjacentHTML"].forEach(function(e){if(!s[e]){return}t[e]=s[e];s[e]=r(t[e])});Object.defineProperty(s,"innerHTML",Ge(i,{set:r(i.set)}));s.resetSourceWatch_=function(){s.resetSourceWatch_=null;Object.keys(t).forEach(function(e){s[e]=t[e]});Object.defineProperty(s,"innerHTML",i)};a.one("sourceset",s.resetSourceWatch_)};var Ga=Object.defineProperty({},"src",{get:function e(){if(this.hasAttribute("src")){return Zt(_.Element.prototype.getAttribute.call(this,"src"))}return""},set:function e(t){_.Element.prototype.setAttribute.call(this,"src",t);return t}});var Xa=function e(t){return qa([t.el(),_.HTMLMediaElement.prototype,Ga],"src")};var Ya=function e(r){if(!r.featuresSourceset){return}var n=r.el();if(n.resetSourceset_){return}var a=Xa(r);var s=n.setAttribute;var t=n.load;Object.defineProperty(n,"src",Ge(a,{set:function e(t){var i=a.set.call(n,t);r.triggerSourceset(n.src);return i}}));n.setAttribute=function(e,t){var i=s.call(n,e,t);if(/src/i.test(e)){r.triggerSourceset(n.src)}return i};n.load=function(){var e=t.call(n);if(!Va(r)){r.triggerSourceset("");Wa(r)}return e};if(n.currentSrc){r.triggerSourceset(n.currentSrc)}else if(!Va(r)){Wa(r)}n.resetSourceset_=function(){n.resetSourceset_=null;n.load=t;n.setAttribute=s;Object.defineProperty(n,"src",a);if(n.resetSourceWatch_){n.resetSourceWatch_()}}};function $a(){var t=e(["Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\n            This may prevent text tracks from loading."]);$a=function e(){return t};return t}var Ka=function(f){o(l,f);function l(e,t){var i;i=f.call(this,e,t)||this;var r=e.source;var n=false;if(r&&(i.el_.currentSrc!==r.src||e.tag&&e.tag.initNetworkState_===3)){i.setSource(r)}else{i.handleLateInit_(i.el_)}if(e.enableSourceset){i.setupSourcesetHandling_()}if(i.el_.hasChildNodes()){var a=i.el_.childNodes;var s=a.length;var o=[];while(s--){var u=a[s];var l=u.nodeName.toLowerCase();if(l==="track"){if(!i.featuresNativeTextTracks){o.push(u)}else{i.remoteTextTrackEls().addTrackElement_(u);i.remoteTextTracks().addTrack(u.track);i.textTracks().addTrack(u.track);if(!n&&!i.el_.hasAttribute("crossorigin")&&ti(u.src)){n=true}}}}for(var c=0;c<o.length;c++){i.el_.removeChild(o[c])}}i.proxyNativeTracks_();if(i.featuresNativeTextTracks&&n){m.warn(g($a()))}i.restoreMetadataTracksInIOSNativePlayer_();if((ht||Qe||nt)&&e.nativeControlsForTouch===true){i.setControls(true)}i.proxyWebkitFullscreen_();i.triggerReady();return i}var e=l.prototype;e.dispose=function e(){if(this.el_&&this.el_.resetSourceset_){this.el_.resetSourceset_()}l.disposeMediaElement(this.el_);this.options_=null;f.prototype.dispose.call(this)};e.setupSourcesetHandling_=function e(){Ya(this)};e.restoreMetadataTracksInIOSNativePlayer_=function e(){var r=this.textTracks();var n;var t=function e(){n=[];for(var t=0;t<r.length;t++){var i=r[t];if(i.kind==="metadata"){n.push({track:i,storedMode:i.mode})}}};t();r.addEventListener("change",t);this.on("dispose",function(){return r.removeEventListener("change",t)});var i=function e(){for(var t=0;t<n.length;t++){var i=n[t];if(i.track.mode==="disabled"&&i.track.mode!==i.storedMode){i.track.mode=i.storedMode}}r.removeEventListener("change",e)};this.on("webkitbeginfullscreen",function(){r.removeEventListener("change",t);r.removeEventListener("change",i);r.addEventListener("change",i)});this.on("webkitendfullscreen",function(){r.removeEventListener("change",t);r.addEventListener("change",t);r.removeEventListener("change",i)})};e.overrideNative_=function e(t,i){var r=this;if(i!==this["featuresNative"+t+"Tracks"]){return}var n=t.toLowerCase();if(this[n+"TracksListeners_"]){Object.keys(this[n+"TracksListeners_"]).forEach(function(e){var t=r.el()[n+"Tracks"];t.removeEventListener(e,r[n+"TracksListeners_"][e])})}this["featuresNative"+t+"Tracks"]=!i;this[n+"TracksListeners_"]=null;this.proxyNativeTracksForType_(n)};e.overrideNativeAudioTracks=function e(t){this.overrideNative_("Audio",t)};e.overrideNativeVideoTracks=function e(t){this.overrideNative_("Video",t)};e.proxyNativeTracksForType_=function e(t){var r=this;var i=Ki[t];var a=this.el()[i.getterName];var s=this[i.getterName]();if(!this["featuresNative"+i.capitalName+"Tracks"]||!a||!a.addEventListener){return}var n={change:function e(t){s.trigger({type:"change",target:s,currentTarget:s,srcElement:s})},addtrack:function e(t){s.addTrack(t.track)},removetrack:function e(t){s.removeTrack(t.track)}};var o=function e(){var t=[];for(var i=0;i<s.length;i++){var r=false;for(var n=0;n<a.length;n++){if(a[n]===s[i]){r=true;break}}if(!r){t.push(s[i])}}while(t.length){s.removeTrack(t.shift())}};this[i.getterName+"Listeners_"]=n;Object.keys(n).forEach(function(t){var i=n[t];a.addEventListener(t,i);r.on("dispose",function(e){return a.removeEventListener(t,i)})});this.on("loadstart",o);this.on("dispose",function(e){return r.off("loadstart",o)})};e.proxyNativeTracks_=function e(){var t=this;Ki.names.forEach(function(e){t.proxyNativeTracksForType_(e)})};e.createEl=function e(){var t=this.options_.tag;if(!t||!(this.options_.playerElIngest||this.movingMediaElementInDOM)){if(t){var i=t.cloneNode(true);if(t.parentNode){t.parentNode.insertBefore(i,t)}l.disposeMediaElement(t);t=i}else{t=h.createElement("video");var r=this.options_.tag&&F(this.options_.tag);var n=Ge({},r);if(!ht||this.options_.nativeControlsForTouch!==true){delete n.controls}j(t,b(n,{id:this.options_.techId,class:"vjs-tech"}))}t.playerId=this.options_.playerId}if(typeof this.options_.preload!=="undefined"){H(t,"preload",this.options_.preload)}var a=["loop","muted","playsinline","autoplay"];for(var s=0;s<a.length;s++){var o=a[s];var u=this.options_[o];if(typeof u!=="undefined"){if(u){H(t,o,o)}else{q(t,o)}t[o]=u}}return t};e.handleLateInit_=function e(t){if(t.networkState===0||t.networkState===3){return}if(t.readyState===0){var i=false;var r=function e(){i=true};this.on("loadstart",r);var n=function e(){if(!i){this.trigger("loadstart")}};this.on("loadedmetadata",n);this.ready(function(){this.off("loadstart",r);this.off("loadedmetadata",n);if(!i){this.trigger("loadstart")}});return}var a=["loadstart"];a.push("loadedmetadata");if(t.readyState>=2){a.push("loadeddata")}if(t.readyState>=3){a.push("canplay")}if(t.readyState>=4){a.push("canplaythrough")}this.ready(function(){a.forEach(function(e){this.trigger(e)},this)})};e.setCurrentTime=function e(t){try{this.el_.currentTime=t}catch(e){m(e,"Video is not ready. (Video.js)")}};e.duration=function e(){var t=this;if(this.el_.duration===Infinity&&it&&ot&&this.el_.currentTime===0){var i=function e(){if(t.el_.currentTime>0){if(t.el_.duration===Infinity){t.trigger("durationchange")}t.off("timeupdate",e)}};this.on("timeupdate",i);return NaN}return this.el_.duration||NaN};e.width=function e(){return this.el_.offsetWidth};e.height=function e(){return this.el_.offsetHeight};e.proxyWebkitFullscreen_=function e(){var t=this;if(!("webkitDisplayingFullscreen"in this.el_)){return}var i=function e(){this.trigger("fullscreenchange",{isFullscreen:false})};var r=function e(){if("webkitPresentationMode"in this.el_&&this.el_.webkitPresentationMode!=="picture-in-picture"){this.one("webkitendfullscreen",i);this.trigger("fullscreenchange",{isFullscreen:true})}};this.on("webkitbeginfullscreen",r);this.on("dispose",function(){t.off("webkitbeginfullscreen",r);t.off("webkitendfullscreen",i)})};e.supportsFullScreen=function e(){if(typeof this.el_.webkitEnterFullScreen==="function"){var t=_.navigator&&_.navigator.userAgent||"";if(/Android/.test(t)||!/Chrome|Mac OS X 10.5/.test(t)){return true}}return false};e.enterFullScreen=function e(){var t=this.el_;if(t.paused&&t.networkState<=t.HAVE_METADATA){this.el_.play();this.setTimeout(function(){t.pause();t.webkitEnterFullScreen()},0)}else{t.webkitEnterFullScreen()}};e.exitFullScreen=function e(){this.el_.webkitExitFullScreen()};e.src=function e(t){if(t===undefined){return this.el_.src}this.setSrc(t)};e.reset=function e(){l.resetMediaElement(this.el_)};e.currentSrc=function e(){if(this.currentSource_){return this.currentSource_.src}return this.el_.currentSrc};e.setControls=function e(t){this.el_.controls=!!t};e.addTextTrack=function e(t,i,r){if(!this.featuresNativeTextTracks){return f.prototype.addTextTrack.call(this,t,i,r)}return this.el_.addTextTrack(t,i,r)};e.createRemoteTextTrack=function e(t){if(!this.featuresNativeTextTracks){return f.prototype.createRemoteTextTrack.call(this,t)}var i=h.createElement("track");if(t.kind){i.kind=t.kind}if(t.label){i.label=t.label}if(t.language||t.srclang){i.srclang=t.language||t.srclang}if(t.default){i.default=t.default}if(t.id){i.id=t.id}if(t.src){i.src=t.src}return i};e.addRemoteTextTrack=function e(t,i){var r=f.prototype.addRemoteTextTrack.call(this,t,i);if(this.featuresNativeTextTracks){this.el().appendChild(r)}return r};e.removeRemoteTextTrack=function e(t){f.prototype.removeRemoteTextTrack.call(this,t);if(this.featuresNativeTextTracks){var i=this.$$("track");var r=i.length;while(r--){if(t===i[r]||t===i[r].track){this.el().removeChild(i[r])}}}};e.getVideoPlaybackQuality=function e(){if(typeof this.el().getVideoPlaybackQuality==="function"){return this.el().getVideoPlaybackQuality()}var t={};if(typeof this.el().webkitDroppedFrameCount!=="undefined"&&typeof this.el().webkitDecodedFrameCount!=="undefined"){t.droppedVideoFrames=this.el().webkitDroppedFrameCount;t.totalVideoFrames=this.el().webkitDecodedFrameCount}if(_.performance&&typeof _.performance.now==="function"){t.creationTime=_.performance.now()}else if(_.performance&&_.performance.timing&&typeof _.performance.timing.navigationStart==="number"){t.creationTime=_.Date.now()-_.performance.timing.navigationStart}return t};return l}(Fr);if(L()){Ka.TEST_VID=h.createElement("video");var Ja=h.createElement("track");Ja.kind="captions";Ja.srclang="en";Ja.label="English";Ka.TEST_VID.appendChild(Ja)}Ka.isSupported=function(){try{Ka.TEST_VID.volume=.5}catch(e){return false}return!!(Ka.TEST_VID&&Ka.TEST_VID.canPlayType)};Ka.canPlayType=function(e){return Ka.TEST_VID.canPlayType(e)};Ka.canPlaySource=function(e,t){return Ka.canPlayType(e.type)};Ka.canControlVolume=function(){try{var e=Ka.TEST_VID.volume;Ka.TEST_VID.volume=e/2+.1;return e!==Ka.TEST_VID.volume}catch(e){return false}};Ka.canMuteVolume=function(){try{var e=Ka.TEST_VID.muted;Ka.TEST_VID.muted=!e;if(Ka.TEST_VID.muted){H(Ka.TEST_VID,"muted","muted")}else{q(Ka.TEST_VID,"muted","muted")}return e!==Ka.TEST_VID.muted}catch(e){return false}};Ka.canControlPlaybackRate=function(){if(it&&ot&&ut<58){return false}try{var e=Ka.TEST_VID.playbackRate;Ka.TEST_VID.playbackRate=e/2+.1;return e!==Ka.TEST_VID.playbackRate}catch(e){return false}};Ka.canOverrideAttributes=function(){try{var e=function e(){};Object.defineProperty(h.createElement("video"),"src",{get:e,set:e});Object.defineProperty(h.createElement("audio"),"src",{get:e,set:e});Object.defineProperty(h.createElement("video"),"innerHTML",{get:e,set:e});Object.defineProperty(h.createElement("audio"),"innerHTML",{get:e,set:e})}catch(e){return false}return true};Ka.supportsNativeTextTracks=function(){return ft||et&&ot};Ka.supportsNativeVideoTracks=function(){return!!(Ka.TEST_VID&&Ka.TEST_VID.videoTracks)};Ka.supportsNativeAudioTracks=function(){return!!(Ka.TEST_VID&&Ka.TEST_VID.audioTracks)};Ka.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"];Ka.prototype.featuresVolumeControl=Ka.canControlVolume();Ka.prototype.featuresMuteControl=Ka.canMuteVolume();Ka.prototype.featuresPlaybackRate=Ka.canControlPlaybackRate();Ka.prototype.featuresSourceset=Ka.canOverrideAttributes();Ka.prototype.movingMediaElementInDOM=!et;Ka.prototype.featuresFullscreenResize=true;Ka.prototype.featuresProgressEvents=true;Ka.prototype.featuresTimeupdateEvents=true;Ka.prototype.featuresNativeTextTracks=Ka.supportsNativeTextTracks();Ka.prototype.featuresNativeVideoTracks=Ka.supportsNativeVideoTracks();Ka.prototype.featuresNativeAudioTracks=Ka.supportsNativeAudioTracks();var Qa=Ka.TEST_VID&&Ka.TEST_VID.constructor.prototype.canPlayType;var Za=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;Ka.patchCanPlayType=function(){if(rt>=4&&!at&&!ot){Ka.TEST_VID.constructor.prototype.canPlayType=function(e){if(e&&Za.test(e)){return"maybe"}return Qa.call(this,e)}}};Ka.unpatchCanPlayType=function(){var e=Ka.TEST_VID.constructor.prototype.canPlayType;Ka.TEST_VID.constructor.prototype.canPlayType=Qa;return e};Ka.patchCanPlayType();Ka.disposeMediaElement=function(e){if(!e){return}if(e.parentNode){e.parentNode.removeChild(e)}while(e.hasChildNodes()){e.removeChild(e.firstChild)}e.removeAttribute("src");if(typeof e.load==="function"){(function(){try{e.load()}catch(e){}})()}};Ka.resetMediaElement=function(e){if(!e){return}var t=e.querySelectorAll("source");var i=t.length;while(i--){e.removeChild(t[i])}e.removeAttribute("src");if(typeof e.load==="function"){(function(){try{e.load()}catch(e){}})()}};["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(e){Ka.prototype[e]=function(){return this.el_[e]||this.el_.hasAttribute(e)}});["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(t){Ka.prototype["set"+ze(t)]=function(e){this.el_[t]=e;if(e){this.el_.setAttribute(t,t)}else{this.el_.removeAttribute(t)}}});["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","played","networkState","readyState","videoWidth","videoHeight"].forEach(function(e){Ka.prototype[e]=function(){return this.el_[e]}});["volume","src","poster","preload","playbackRate","defaultPlaybackRate"].forEach(function(t){Ka.prototype["set"+ze(t)]=function(e){this.el_[t]=e}});["pause","load","play"].forEach(function(e){Ka.prototype[e]=function(){return this.el_[e]()}});Fr.withSourceHandlers(Ka);Ka.nativeSourceHandler={};Ka.nativeSourceHandler.canPlayType=function(e){try{return Ka.TEST_VID.canPlayType(e)}catch(e){return""}};Ka.nativeSourceHandler.canHandleSource=function(e,t){if(e.type){return Ka.nativeSourceHandler.canPlayType(e.type)}else if(e.src){var i=ei(e.src);return Ka.nativeSourceHandler.canPlayType("video/"+i)}return""};Ka.nativeSourceHandler.handleSource=function(e,t,i){t.setSrc(e.src)};Ka.nativeSourceHandler.dispose=function(){};Ka.registerSourceHandler(Ka.nativeSourceHandler);Fr.registerTech("Html5",Ka);function es(){var t=e(["\n        Using the tech directly can be dangerous. I hope you know what you're doing.\n        See https://github.com/videojs/video.js/issues/2617 for more info.\n      "]);es=function e(){return t};return t}var ts=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"];var is={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"};var rs=["tiny","xsmall","small","medium","large","xlarge","huge"];var ns={};rs.forEach(function(e){var t=e.charAt(0)==="x"?"x-"+e.substring(1):e;ns[e]="vjs-layout-"+t});var as={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:Infinity};var ss=function(f){o(c,f);function c(e,t,i){var r;e.id=e.id||t.id||"vjs_video_"+ae();t=b(c.getTagSettings(e),t);t.initChildren=false;t.createEl=false;t.evented=false;t.reportTouchActivity=false;if(!t.language){if(typeof e.closest==="function"){var n=e.closest("[lang]");if(n&&n.getAttribute){t.language=n.getAttribute("lang")}}else{var a=e;while(a&&a.nodeType===1){if(F(a).hasOwnProperty("lang")){t.language=a.getAttribute("lang");break}a=a.parentNode}}}r=f.call(this,null,t,i)||this;r.log=v(r.id_);r.isPosterFromTech_=false;r.queuedCallbacks_=[];r.isReady_=false;r.hasStarted_=false;r.userActive_=false;if(!r.options_||!r.options_.techOrder||!r.options_.techOrder.length){throw new Error("No techOrder specified. Did you overwrite "+"videojs.options instead of just changing the "+"properties you want to override?")}r.tag=e;r.tagAttributes=e&&F(e);r.language(r.options_.language);if(t.languages){var s={};Object.getOwnPropertyNames(t.languages).forEach(function(e){s[e.toLowerCase()]=t.languages[e]});r.languages_=s}else{r.languages_=c.prototype.options_.languages}r.cache_={};r.poster_=t.poster||"";r.controls_=!!t.controls;r.cache_.lastVolume=1;e.controls=false;e.removeAttribute("controls");if(e.hasAttribute("autoplay")){r.options_.autoplay=true}else{r.autoplay(r.options_.autoplay)}r.scrubbing_=false;r.el_=r.createEl();r.cache_.lastPlaybackRate=r.defaultPlaybackRate();Ve(p(p(r)),{eventBusKey:"el_"});if(r.fluid_){r.on("playerreset",r.updateStyleEl_)}var o=Ge(r.options_);if(t.plugins){var u=t.plugins;Object.keys(u).forEach(function(e){if(typeof this[e]==="function"){this[e](u[e])}else{throw new Error('plugin "'+e+'" does not exist')}},p(p(r)))}r.options_.playerOptions=o;r.middleware_=[];r.initChildren();r.isAudio(e.nodeName.toLowerCase()==="audio");if(r.controls()){r.addClass("vjs-controls-enabled")}else{r.addClass("vjs-controls-disabled")}r.el_.setAttribute("role","region");if(r.isAudio()){r.el_.setAttribute("aria-label",r.localize("Audio Player"))}else{r.el_.setAttribute("aria-label",r.localize("Video Player"))}if(r.isAudio()){r.addClass("vjs-audio")}if(r.flexNotSupported_()){r.addClass("vjs-no-flex")}if(!et){r.addClass("vjs-workinghover")}c.players[r.id_]=p(p(r));var l=d.split(".")[0];r.addClass("vjs-v"+l);r.userActive(true);r.reportUserActivity();r.one("play",r.listenForUserActivity_);r.on("fullscreenchange",r.handleFullscreenChange_);r.on("stageclick",r.handleStageClick_);r.breakpoints(r.options_.breakpoints);r.responsive(r.options_.responsive);r.changingSrc_=false;r.playWaitingForReady_=false;r.playOnLoadstart_=null;return r}var e=c.prototype;e.dispose=function e(){this.trigger("dispose");this.off("dispose");if(this.styleEl_&&this.styleEl_.parentNode){this.styleEl_.parentNode.removeChild(this.styleEl_);this.styleEl_=null}c.players[this.id_]=null;if(this.tag&&this.tag.player){this.tag.player=null}if(this.el_&&this.el_.player){this.el_.player=null}if(this.tech_){this.tech_.dispose();this.isPosterFromTech_=false;this.poster_=""}if(this.playerElIngest_){this.playerElIngest_=null}if(this.tag){this.tag=null}tn(this);f.prototype.dispose.call(this)};e.createEl=function e(){var t=this.tag;var i;var r=this.playerElIngest_=t.parentNode&&t.parentNode.hasAttribute&&t.parentNode.hasAttribute("data-vjs-player");var n=this.tag.tagName.toLowerCase()==="video-js";if(r){i=this.el_=t.parentNode}else if(!n){i=this.el_=f.prototype.createEl.call(this,"div")}var a=F(t);if(n){i=this.el_=t;t=this.tag=h.createElement("video");while(i.children.length){t.appendChild(i.firstChild)}if(!R(i,"video-js")){M(i,"video-js")}i.appendChild(t);r=this.playerElIngest_=i;Object.keys(i).forEach(function(e){t[e]=i[e]})}t.setAttribute("tabindex","-1");a.tabindex="-1";if(lt){t.setAttribute("role","application");a.role="application"}t.removeAttribute("width");t.removeAttribute("height");if("width"in a){delete a.width}if("height"in a){delete a.height}Object.getOwnPropertyNames(a).forEach(function(e){if(!(n&&e==="class")){i.setAttribute(e,a[e])}if(n){t.setAttribute(e,a[e])}});t.playerId=t.id;t.id+="_html5_api";t.className="vjs-tech";t.player=i.player=this;this.addClass("vjs-paused");if(_.VIDEOJS_NO_DYNAMIC_STYLE!==true){this.styleEl_=Ce("vjs-styles-dimensions");var s=te(".vjs-styles-defaults");var o=te("head");o.insertBefore(this.styleEl_,s?s.nextSibling:o.firstChild)}this.fill_=false;this.fluid_=false;this.width(this.options_.width);this.height(this.options_.height);this.fill(this.options_.fill);this.fluid(this.options_.fluid);this.aspectRatio(this.options_.aspectRatio);var u=t.getElementsByTagName("a");for(var l=0;l<u.length;l++){var c=u.item(l);M(c,"vjs-hidden");c.setAttribute("hidden","hidden")}t.initNetworkState_=t.networkState;if(t.parentNode&&!r){t.parentNode.insertBefore(i,t)}x(t,i);this.children_.unshift(t);this.el_.setAttribute("lang",this.language_);this.el_=i;return i};e.width=function e(t){return this.dimension("width",t)};e.height=function e(t){return this.dimension("height",t)};e.dimension=function e(t,i){var r=t+"_";if(i===undefined){return this[r]||0}if(i===""){this[r]=undefined;this.updateStyleEl_();return}var n=parseFloat(i);if(isNaN(n)){m.error('Improper value "'+i+'" supplied for for '+t);return}this[r]=n;this.updateStyleEl_()};e.fluid=function e(t){if(t===undefined){return!!this.fluid_}this.fluid_=!!t;if(Ue(this)){this.off("playerreset",this.updateStyleEl_)}if(t){this.addClass("vjs-fluid");this.fill(false);De(function(){this.on("playerreset",this.updateStyleEl_)})}else{this.removeClass("vjs-fluid")}this.updateStyleEl_()};e.fill=function e(t){if(t===undefined){return!!this.fill_}this.fill_=!!t;if(t){this.addClass("vjs-fill");this.fluid(false)}else{this.removeClass("vjs-fill")}};e.aspectRatio=function e(t){if(t===undefined){return this.aspectRatio_}if(!/^\d+\:\d+$/.test(t)){throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.")}this.aspectRatio_=t;this.fluid(true);this.updateStyleEl_()};e.updateStyleEl_=function e(){if(_.VIDEOJS_NO_DYNAMIC_STYLE===true){var t=typeof this.width_==="number"?this.width_:this.options_.width;var i=typeof this.height_==="number"?this.height_:this.options_.height;var r=this.tech_&&this.tech_.el();if(r){if(t>=0){r.width=t}if(i>=0){r.height=i}}return}var n;var a;var s;var o;if(this.aspectRatio_!==undefined&&this.aspectRatio_!=="auto"){s=this.aspectRatio_}else if(this.videoWidth()>0){s=this.videoWidth()+":"+this.videoHeight()}else{s="16:9"}var u=s.split(":");var l=u[1]/u[0];if(this.width_!==undefined){n=this.width_}else if(this.height_!==undefined){n=this.height_/l}else{n=this.videoWidth()||300}if(this.height_!==undefined){a=this.height_}else{a=n*l}if(/^[^a-zA-Z]/.test(this.id())){o="dimensions-"+this.id()}else{o=this.id()+"-dimensions"}this.addClass(o);Ee(this.styleEl_,"\n      ."+o+" {\n        width: "+n+"px;\n        height: "+a+"px;\n      }\n\n      ."+o+".vjs-fluid {\n        padding-top: "+l*100+"%;\n      }\n    ")};e.loadTech_=function e(t,i){var r=this;if(this.tech_){this.unloadTech_()}var n=ze(t);var a=t.charAt(0).toLowerCase()+t.slice(1);if(n!=="Html5"&&this.tag){Fr.getTech("Html5").disposeMediaElement(this.tag);this.tag.player=null;this.tag=null}this.techName_=n;this.isReady_=false;var s=typeof this.autoplay()==="string"?false:this.autoplay();var o={source:i,autoplay:s,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+a+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||false,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset};Qi.names.forEach(function(e){var t=Qi[e];o[t.getterName]=r[t.privateName]});b(o,this.options_[n]);b(o,this.options_[a]);b(o,this.options_[t.toLowerCase()]);if(this.tag){o.tag=this.tag}if(i&&i.src===this.cache_.src&&this.cache_.currentTime>0){o.startTime=this.cache_.currentTime}var u=Fr.getTech(t);if(!u){throw new Error("No Tech named '"+n+"' exists! '"+n+"' should be registered using videojs.registerTech()'")}this.tech_=new u(o);this.tech_.ready(Ae(this,this.handleTechReady_),true);xt.jsonToTextTracks(this.textTracksJson_||[],this.tech_);ts.forEach(function(e){r.on(r.tech_,e,r["handleTech"+ze(e)+"_"])});Object.keys(is).forEach(function(t){r.on(r.tech_,t,function(e){if(r.tech_.playbackRate()===0&&r.tech_.seeking()){r.queuedCallbacks_.push({callback:r["handleTech"+is[t]+"_"].bind(r),event:e});return}r["handleTech"+is[t]+"_"](e)})});this.on(this.tech_,"loadstart",this.handleTechLoadStart_);this.on(this.tech_,"sourceset",this.handleTechSourceset_);this.on(this.tech_,"waiting",this.handleTechWaiting_);this.on(this.tech_,"ended",this.handleTechEnded_);this.on(this.tech_,"seeking",this.handleTechSeeking_);this.on(this.tech_,"play",this.handleTechPlay_);this.on(this.tech_,"firstplay",this.handleTechFirstPlay_);this.on(this.tech_,"pause",this.handleTechPause_);this.on(this.tech_,"durationchange",this.handleTechDurationChange_);this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_);this.on(this.tech_,"error",this.handleTechError_);this.on(this.tech_,"loadedmetadata",this.updateStyleEl_);this.on(this.tech_,"posterchange",this.handleTechPosterChange_);this.on(this.tech_,"textdata",this.handleTechTextData_);this.on(this.tech_,"ratechange",this.handleTechRateChange_);this.usingNativeControls(this.techGet_("controls"));if(this.controls()&&!this.usingNativeControls()){this.addTechControlsListeners_()}if(this.tech_.el().parentNode!==this.el()&&(n!=="Html5"||!this.tag)){x(this.tech_.el(),this.el())}if(this.tag){this.tag.player=null;this.tag=null}};e.unloadTech_=function e(){var i=this;Qi.names.forEach(function(e){var t=Qi[e];i[t.privateName]=i[t.getterName]()});this.textTracksJson_=xt.textTracksToJson(this.tech_);this.isReady_=false;this.tech_.dispose();this.tech_=false;if(this.isPosterFromTech_){this.poster_="";this.trigger("posterchange")}this.isPosterFromTech_=false};e.tech=function e(t){if(t===undefined){m.warn(g(es()))}return this.tech_};e.addTechControlsListeners_=function e(){this.removeTechControlsListeners_();this.on(this.tech_,"mousedown",this.handleTechClick_);this.on(this.tech_,"dblclick",this.handleTechDoubleClick_);this.on(this.tech_,"touchstart",this.handleTechTouchStart_);this.on(this.tech_,"touchmove",this.handleTechTouchMove_);this.on(this.tech_,"touchend",this.handleTechTouchEnd_);this.on(this.tech_,"tap",this.handleTechTap_)};e.removeTechControlsListeners_=function e(){this.off(this.tech_,"tap",this.handleTechTap_);this.off(this.tech_,"touchstart",this.handleTechTouchStart_);this.off(this.tech_,"touchmove",this.handleTechTouchMove_);this.off(this.tech_,"touchend",this.handleTechTouchEnd_);this.off(this.tech_,"mousedown",this.handleTechClick_);this.off(this.tech_,"dblclick",this.handleTechDoubleClick_)};e.handleTechReady_=function e(){this.triggerReady();if(this.cache_.volume){this.techCall_("setVolume",this.cache_.volume)}this.handleTechPosterChange_();this.handleTechDurationChange_()};e.handleTechLoadStart_=function e(){this.removeClass("vjs-ended");this.removeClass("vjs-seeking");this.error(null);this.handleTechDurationChange_();if(!this.paused()){this.trigger("loadstart");this.trigger("firstplay")}else{this.hasStarted(false);this.trigger("loadstart")}this.manualAutoplay_(this.autoplay())};e.manualAutoplay_=function e(t){var r=this;if(!this.tech_||typeof t!=="string"){return}var i=function e(){var t=r.muted();r.muted(true);var i=r.play();if(!i||!i.then||!i.catch){return}return i.catch(function(e){r.muted(t)})};var n;if(t==="any"){n=this.play();if(n&&n.then&&n.catch){n.catch(function(){return i()})}}else if(t==="muted"){n=i()}else{n=this.play()}if(!n||!n.then||!n.catch){return}return n.then(function(){r.trigger({type:"autoplay-success",autoplay:t})}).catch(function(e){r.trigger({type:"autoplay-failure",autoplay:t})})};e.updateSourceCaches_=function e(t){if(t===void 0){t=""}var i=t;var r="";if(typeof i!=="string"){i=t.src;r=t.type}this.cache_.source=this.cache_.source||{};this.cache_.sources=this.cache_.sources||[];if(i&&!r){r=on(this,i)}this.cache_.source=Ge({},t,{src:i,type:r});var n=this.cache_.sources.filter(function(e){return e.src&&e.src===i});var a=[];var s=this.$$("source");var o=[];for(var u=0;u<s.length;u++){var l=F(s[u]);a.push(l);if(l.src&&l.src===i){o.push(l.src)}}if(o.length&&!n.length){this.cache_.sources=a}else if(!n.length){this.cache_.sources=[this.cache_.source]}this.cache_.src=i};e.handleTechSourceset_=function e(t){var r=this;if(!this.changingSrc_){var i=function e(t){return r.updateSourceCaches_(t)};var n=this.currentSource().src;var a=t.src;if(n&&!/^blob:/.test(n)&&/^blob:/.test(a)){if(!this.lastSource_||this.lastSource_.tech!==a&&this.lastSource_.player!==n){i=function e(){}}}i(a);if(!t.src){var s=function e(t){if(t.type!=="sourceset"){var i=r.techGet("currentSrc");r.lastSource_.tech=i;r.updateSourceCaches_(i)}r.tech_.off(["sourceset","loadstart"],e)};this.tech_.one(["sourceset","loadstart"],s)}}this.lastSource_={player:this.currentSource().src,tech:t.src};this.trigger({src:t.src,type:"sourceset"})};e.hasStarted=function e(t){if(t===undefined){return this.hasStarted_}if(t===this.hasStarted_){return}this.hasStarted_=t;if(this.hasStarted_){this.addClass("vjs-has-started");this.trigger("firstplay")}else{this.removeClass("vjs-has-started")}};e.handleTechPlay_=function e(){this.removeClass("vjs-ended");this.removeClass("vjs-paused");this.addClass("vjs-playing");this.hasStarted(true);this.trigger("play")};e.handleTechRateChange_=function e(){if(this.tech_.playbackRate()>0&&this.cache_.lastPlaybackRate===0){this.queuedCallbacks_.forEach(function(e){return e.callback(e.event)});this.queuedCallbacks_=[]}this.cache_.lastPlaybackRate=this.tech_.playbackRate();this.trigger("ratechange")};e.handleTechWaiting_=function e(){var t=this;this.addClass("vjs-waiting");this.trigger("waiting");var i=this.currentTime();var r=function e(){if(i!==t.currentTime()){t.removeClass("vjs-waiting");t.off("timeupdate",e)}};this.on("timeupdate",r)};e.handleTechCanPlay_=function e(){this.removeClass("vjs-waiting");this.trigger("canplay")};e.handleTechCanPlayThrough_=function e(){this.removeClass("vjs-waiting");this.trigger("canplaythrough")};e.handleTechPlaying_=function e(){this.removeClass("vjs-waiting");this.trigger("playing")};e.handleTechSeeking_=function e(){this.addClass("vjs-seeking");this.trigger("seeking")};e.handleTechSeeked_=function e(){this.removeClass("vjs-seeking");this.trigger("seeked")};e.handleTechFirstPlay_=function e(){if(this.options_.starttime){m.warn("Passing the `starttime` option to the player will be deprecated in 6.0");this.currentTime(this.options_.starttime)}this.addClass("vjs-has-started");this.trigger("firstplay")};e.handleTechPause_=function e(){this.removeClass("vjs-playing");this.addClass("vjs-paused");this.trigger("pause")};e.handleTechEnded_=function e(){this.addClass("vjs-ended");if(this.options_.loop){this.currentTime(0);this.play()}else if(!this.paused()){this.pause()}this.trigger("ended")};e.handleTechDurationChange_=function e(){this.duration(this.techGet_("duration"))};e.handleTechClick_=function e(t){if(!ee(t)){return}if(!this.controls_){return}if(this.paused()){Ot(this.play())}else{this.pause()}};e.handleTechDoubleClick_=function e(t){if(!this.controls_){return}var i=Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),function(e){return e.contains(t.target)});if(!i){if(this.isFullscreen()){this.exitFullscreen()}else{this.requestFullscreen()}}};e.handleTechTap_=function e(){this.userActive(!this.userActive())};e.handleTechTouchStart_=function e(){this.userWasActive=this.userActive()};e.handleTechTouchMove_=function e(){if(this.userWasActive){this.reportUserActivity()}};e.handleTechTouchEnd_=function e(t){t.preventDefault()};e.handleFullscreenChange_=function e(){if(this.isFullscreen()){this.addClass("vjs-fullscreen")}else{this.removeClass("vjs-fullscreen")}};e.handleStageClick_=function e(){this.reportUserActivity()};e.handleTechFullscreenChange_=function e(t,i){if(i){this.isFullscreen(i.isFullscreen)}this.trigger("fullscreenchange")};e.handleTechError_=function e(){var t=this.tech_.error();this.error(t)};e.handleTechTextData_=function e(){var t=null;if(arguments.length>1){t=arguments[1]}this.trigger("textdata",t)};e.getCache=function e(){return this.cache_};e.techCall_=function e(t,i){this.ready(function(){if(t in Jr){return Yr(this.middleware_,this.tech_,t,i)}else if(t in Qr){return $r(this.middleware_,this.tech_,t,i)}try{if(this.tech_){this.tech_[t](i)}}catch(e){m(e);throw e}},true)};e.techGet_=function e(t){if(!this.tech_||!this.tech_.isReady_){return}if(t in Kr){return Xr(this.middleware_,this.tech_,t)}else if(t in Qr){return $r(this.middleware_,this.tech_,t)}try{return this.tech_[t]()}catch(e){if(this.tech_[t]===undefined){m("Video.js: "+t+" method not defined for "+this.techName_+" playback technology.",e);throw e}if(e.name==="TypeError"){m("Video.js: "+t+" unavailable on "+this.techName_+" playback technology element.",e);this.tech_.isReady_=false;throw e}m(e);throw e}};e.play=function e(){var t=this;var i=this.options_.Promise||_.Promise;if(i){return new i(function(e){t.play_(e)})}return this.play_()};e.play_=function e(t){var i=this;if(t===void 0){t=Ot}if(this.playOnLoadstart_){this.off("loadstart",this.playOnLoadstart_)}if(!this.isReady_){if(this.playWaitingForReady_){return}this.playWaitingForReady_=true;this.ready(function(){i.playWaitingForReady_=false;t(i.play())})}else if(!this.changingSrc_&&(this.src()||this.currentSrc())){t(this.techGet_("play"));return}else{this.playOnLoadstart_=function(){i.playOnLoadstart_=null;t(i.play())};this.one("loadstart",this.playOnLoadstart_)}};e.pause=function e(){this.techCall_("pause")};e.paused=function e(){return this.techGet_("paused")===false?false:true};e.played=function e(){return this.techGet_("played")||gt(0,0)};e.scrubbing=function e(t){if(typeof t==="undefined"){return this.scrubbing_}this.scrubbing_=!!t;if(t){this.addClass("vjs-scrubbing")}else{this.removeClass("vjs-scrubbing")}};e.currentTime=function e(t){if(typeof t!=="undefined"){if(t<0){t=0}this.techCall_("setCurrentTime",t);return}this.cache_.currentTime=this.techGet_("currentTime")||0;return this.cache_.currentTime};e.duration=function e(t){if(t===undefined){return this.cache_.duration!==undefined?this.cache_.duration:NaN}t=parseFloat(t);if(t<0){t=Infinity}if(t!==this.cache_.duration){this.cache_.duration=t;if(t===Infinity){this.addClass("vjs-live");if(this.options_.liveui&&this.player_.liveTracker){this.addClass("vjs-liveui")}}else{this.removeClass("vjs-live");this.removeClass("vjs-liveui")}if(!isNaN(t)){this.trigger("durationchange")}}};e.remainingTime=function e(){return this.duration()-this.currentTime()};e.remainingTimeDisplay=function e(){return Math.floor(this.duration())-Math.floor(this.currentTime())};e.buffered=function e(){var e=this.techGet_("buffered");if(!e||!e.length){e=gt(0,0)}return e};e.bufferedPercent=function e(){return yt(this.buffered(),this.duration())};e.bufferedEnd=function e(){var t=this.buffered();var i=this.duration();var r=t.end(t.length-1);if(r>i){r=i}return r};e.volume=function e(t){var i;if(t!==undefined){i=Math.max(0,Math.min(1,parseFloat(t)));this.cache_.volume=i;this.techCall_("setVolume",i);if(i>0){this.lastVolume_(i)}return}i=parseFloat(this.techGet_("volume"));return isNaN(i)?1:i};e.muted=function e(t){if(t!==undefined){this.techCall_("setMuted",t);return}return this.techGet_("muted")||false};e.defaultMuted=function e(t){if(t!==undefined){return this.techCall_("setDefaultMuted",t)}return this.techGet_("defaultMuted")||false};e.lastVolume_=function e(t){if(t!==undefined&&t!==0){this.cache_.lastVolume=t;return}return this.cache_.lastVolume};e.supportsFullScreen=function e(){return this.techGet_("supportsFullScreen")||false};e.isFullscreen=function e(t){if(t!==undefined){this.isFullscreen_=!!t;return}return!!this.isFullscreen_};e.requestFullscreen=function e(){var i=_t;this.isFullscreen(true);if(i.requestFullscreen){ve(h,i.fullscreenchange,Ae(this,function e(t){this.isFullscreen(h[i.fullscreenElement]);if(this.isFullscreen()===false){ge(h,i.fullscreenchange,e)}this.trigger("fullscreenchange")}));this.el_[i.requestFullscreen]()}else if(this.tech_.supportsFullScreen()){this.techCall_("enterFullScreen")}else{this.enterFullWindow();this.trigger("fullscreenchange")}};e.exitFullscreen=function e(){var t=_t;this.isFullscreen(false);if(t.requestFullscreen){h[t.exitFullscreen]()}else if(this.tech_.supportsFullScreen()){this.techCall_("exitFullScreen")}else{this.exitFullWindow();this.trigger("fullscreenchange")}};e.enterFullWindow=function e(){this.isFullWindow=true;this.docOrigOverflow=h.documentElement.style.overflow;ve(h,"keydown",Ae(this,this.fullWindowOnEscKey));h.documentElement.style.overflow="hidden";M(h.body,"vjs-full-window");this.trigger("enterFullWindow")};e.fullWindowOnEscKey=function e(t){if(t.keyCode===27){if(this.isFullscreen()===true){this.exitFullscreen()}else{this.exitFullWindow()}}};e.exitFullWindow=function e(){this.isFullWindow=false;ge(h,"keydown",this.fullWindowOnEscKey);h.documentElement.style.overflow=this.docOrigOverflow;B(h.body,"vjs-full-window");this.trigger("exitFullWindow")};e.canPlayType=function e(t){var i;for(var r=0,n=this.options_.techOrder;r<n.length;r++){var a=n[r];var s=Fr.getTech(a);if(!s){s=Xe.getComponent(a)}if(!s){m.error('The "'+a+'" tech is undefined. Skipped browser support check for that tech.');continue}if(s.isSupported()){i=s.canPlayType(t);if(i){return i}}}return""};e.selectSource=function e(t){var a=this;var i=this.options_.techOrder.map(function(e){return[e,Fr.getTech(e)]}).filter(function(e){var t=e[0],i=e[1];if(i){return i.isSupported()}m.error('The "'+t+'" tech is undefined. Skipped browser support check for that tech.');return false});var r=function e(t,i,r){var n;t.some(function(t){return i.some(function(e){n=r(t,e);if(n){return true}})});return n};var n;var s=function e(i){return function(e,t){return i(t,e)}};var o=function e(t,i){var r=t[0],n=t[1];if(n.canPlaySource(i,a.options_[r.toLowerCase()])){return{source:i,tech:r}}};if(this.options_.sourceOrder){n=r(t,i,s(o))}else{n=r(i,t,o)}return n||false};e.src=function e(t){var r=this;if(typeof t==="undefined"){return this.cache_.src||""}var n=un(t);if(!n.length){this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0);return}this.changingSrc_=true;this.cache_.sources=n;this.updateSourceCaches_(n[0]);Wr(this,n[0],function(e,t){r.middleware_=t;r.cache_.sources=n;r.updateSourceCaches_(e);var i=r.src_(e);if(i){if(n.length>1){return r.src(n.slice(1))}r.changingSrc_=false;r.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0);r.triggerReady();return}Gr(t,r.tech_)})};e.src_=function e(t){var i=this;var r=this.selectSource([t]);if(!r){return true}if(!We(r.tech,this.techName_)){this.changingSrc_=true;this.loadTech_(r.tech,r.source);this.tech_.ready(function(){i.changingSrc_=false});return false}this.ready(function(){if(this.tech_.constructor.prototype.hasOwnProperty("setSource")){this.techCall_("setSource",t)}else{this.techCall_("src",t.src)}this.changingSrc_=false},true);return false};e.load=function e(){this.techCall_("load")};e.reset=function e(){if(this.tech_){this.tech_.clearTracks("text")}this.loadTech_(this.options_.techOrder[0],null);this.techCall_("reset");if(Ue(this)){this.trigger("playerreset")}};e.currentSources=function e(){var t=this.currentSource();var i=[];if(Object.keys(t).length!==0){i.push(t)}return this.cache_.sources||i};e.currentSource=function e(){return this.cache_.source||{}};e.currentSrc=function e(){return this.currentSource()&&this.currentSource().src||""};e.currentType=function e(){return this.currentSource()&&this.currentSource().type||""};e.preload=function e(t){if(t!==undefined){this.techCall_("setPreload",t);this.options_.preload=t;return}return this.techGet_("preload")};e.autoplay=function e(t){if(t===undefined){return this.options_.autoplay||false}var i;if(typeof t==="string"&&/(any|play|muted)/.test(t)){this.options_.autoplay=t;this.manualAutoplay_(t);i=false}else if(!t){this.options_.autoplay=false}else{this.options_.autoplay=true}i=i||this.options_.autoplay;if(this.tech_){this.techCall_("setAutoplay",i)}};e.playsinline=function e(t){if(t!==undefined){this.techCall_("setPlaysinline",t);this.options_.playsinline=t;return this}return this.techGet_("playsinline")};e.loop=function e(t){if(t!==undefined){this.techCall_("setLoop",t);this.options_.loop=t;return}return this.techGet_("loop")};e.poster=function e(t){if(t===undefined){return this.poster_}if(!t){t=""}if(t===this.poster_){return}this.poster_=t;this.techCall_("setPoster",t);this.isPosterFromTech_=false;this.trigger("posterchange")};e.handleTechPosterChange_=function e(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var t=this.tech_.poster()||"";if(t!==this.poster_){this.poster_=t;this.isPosterFromTech_=true;this.trigger("posterchange")}}};e.controls=function e(t){if(t===undefined){return!!this.controls_}t=!!t;if(this.controls_===t){return}this.controls_=t;if(this.usingNativeControls()){this.techCall_("setControls",t)}if(this.controls_){this.removeClass("vjs-controls-disabled");this.addClass("vjs-controls-enabled");this.trigger("controlsenabled");if(!this.usingNativeControls()){this.addTechControlsListeners_()}}else{this.removeClass("vjs-controls-enabled");this.addClass("vjs-controls-disabled");this.trigger("controlsdisabled");if(!this.usingNativeControls()){this.removeTechControlsListeners_()}}};e.usingNativeControls=function e(t){if(t===undefined){return!!this.usingNativeControls_}t=!!t;if(this.usingNativeControls_===t){return}this.usingNativeControls_=t;if(this.usingNativeControls_){this.addClass("vjs-using-native-controls");this.trigger("usingnativecontrols")}else{this.removeClass("vjs-using-native-controls");this.trigger("usingcustomcontrols")}};e.error=function e(t){if(t===undefined){return this.error_||null}if(t===null){this.error_=t;this.removeClass("vjs-error");if(this.errorDisplay){this.errorDisplay.close()}return}this.error_=new Ct(t);this.addClass("vjs-error");m.error("(CODE:"+this.error_.code+" "+Ct.errorTypes[this.error_.code]+")",this.error_.message,this.error_);this.trigger("error");return};e.reportUserActivity=function e(t){this.userActivity_=true};e.userActive=function e(t){if(t===undefined){return this.userActive_}t=!!t;if(t===this.userActive_){return}this.userActive_=t;if(this.userActive_){this.userActivity_=true;this.removeClass("vjs-user-inactive");this.addClass("vjs-user-active");this.trigger("useractive");return}if(this.tech_){this.tech_.one("mousemove",function(e){e.stopPropagation();e.preventDefault()})}this.userActivity_=false;this.removeClass("vjs-user-active");this.addClass("vjs-user-inactive");this.trigger("userinactive")};e.listenForUserActivity_=function e(){var i;var r;var n;var a=Ae(this,this.reportUserActivity);var t=function e(t){if(t.screenX!==r||t.screenY!==n){r=t.screenX;n=t.screenY;a()}};var s=function e(){a();this.clearInterval(i);i=this.setInterval(a,250)};var o=function e(t){a();this.clearInterval(i)};this.on("mousedown",s);this.on("mousemove",t);this.on("mouseup",o);this.on("keydown",a);this.on("keyup",a);var u;this.setInterval(function(){if(!this.userActivity_){return}this.userActivity_=false;this.userActive(true);this.clearTimeout(u);var e=this.options_.inactivityTimeout;if(e<=0){return}u=this.setTimeout(function(){if(!this.userActivity_){this.userActive(false)}},e)},250)};e.playbackRate=function e(t){if(t!==undefined){this.techCall_("setPlaybackRate",t);return}if(this.tech_&&this.tech_.featuresPlaybackRate){return this.cache_.lastPlaybackRate||this.techGet_("playbackRate")}return 1};e.defaultPlaybackRate=function e(t){if(t!==undefined){return this.techCall_("setDefaultPlaybackRate",t)}if(this.tech_&&this.tech_.featuresPlaybackRate){return this.techGet_("defaultPlaybackRate")}return 1};e.isAudio=function e(t){if(t!==undefined){this.isAudio_=!!t;return}return!!this.isAudio_};e.addTextTrack=function e(t,i,r){if(this.tech_){return this.tech_.addTextTrack(t,i,r)}};e.addRemoteTextTrack=function e(t,i){if(this.tech_){return this.tech_.addRemoteTextTrack(t,i)}};e.removeRemoteTextTrack=function e(t){if(t===void 0){t={}}var i=t,r=i.track;if(!r){r=t}if(this.tech_){return this.tech_.removeRemoteTextTrack(r)}};e.getVideoPlaybackQuality=function e(){return this.techGet_("getVideoPlaybackQuality")};e.videoWidth=function e(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0};e.videoHeight=function e(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0};e.language=function e(t){if(t===undefined){return this.language_}this.language_=String(t).toLowerCase()};e.languages=function e(){return Ge(c.prototype.options_.languages,this.languages_)};e.toJSON=function e(){var t=Ge(this.options_);var i=t.tracks;t.tracks=[];for(var r=0;r<i.length;r++){var n=i[r];n=Ge(n);n.player=undefined;t.tracks[r]=n}return t};e.createModal=function e(t,i){var r=this;i=i||{};i.content=t||"";var n=new Bt(this,i);this.addChild(n);n.on("dispose",function(){r.removeChild(n)});n.open();return n};e.updateCurrentBreakpoint_=function e(){if(!this.responsive()){return}var t=this.currentBreakpoint();var i=this.currentWidth();for(var r=0;r<rs.length;r++){var n=rs[r];var a=this.breakpoints_[n];if(i<=a){if(t===n){return}if(t){this.removeClass(ns[t])}this.addClass(ns[n]);this.breakpoint_=n;break}}};e.removeCurrentBreakpoint_=function e(){var t=this.currentBreakpointClass();this.breakpoint_="";if(t){this.removeClass(t)}};e.breakpoints=function e(t){if(t===undefined){return b(this.breakpoints_)}this.breakpoint_="";this.breakpoints_=b({},as,t);this.updateCurrentBreakpoint_();return b(this.breakpoints_)};e.responsive=function e(t){if(t===undefined){return this.responsive_}t=Boolean(t);var i=this.responsive_;if(t===i){return}this.responsive_=t;if(t){this.on("playerresize",this.updateCurrentBreakpoint_);this.updateCurrentBreakpoint_()}else{this.off("playerresize",this.updateCurrentBreakpoint_);this.removeCurrentBreakpoint_()}return t};e.currentBreakpoint=function e(){return this.breakpoint_};e.currentBreakpointClass=function e(){return ns[this.breakpoint_]||""};c.getTagSettings=function e(t){var i={sources:[],tracks:[]};var r=F(t);var n=r["data-setup"];if(R(t,"vjs-fill")){r.fill=true}if(R(t,"vjs-fluid")){r.fluid=true}if(n!==null){var a=At(n||"{}"),s=a[0],o=a[1];if(s){m.error(s)}b(r,o)}b(i,r);if(t.hasChildNodes()){var u=t.childNodes;for(var l=0,c=u.length;l<c;l++){var f=u[l];var h=f.nodeName.toLowerCase();if(h==="source"){i.sources.push(F(f))}else if(h==="track"){i.tracks.push(F(f))}}}return i};e.flexNotSupported_=function e(){var t=h.createElement("i");return!("flexBasis"in t.style||"webkitFlexBasis"in t.style||"mozFlexBasis"in t.style||"msFlexBasis"in t.style||"msFlexOrder"in t.style)};return c}(Xe);Qi.names.forEach(function(e){var t=Qi[e];ss.prototype[t.getterName]=function(){if(this.tech_){return this.tech_[t.getterName]()}this[t.privateName]=this[t.privateName]||new t.ListClass;return this[t.privateName]}});ss.players={};var os=_.navigator;ss.prototype.options_={techOrder:Fr.defaultTechOrder_,html5:{},flash:{},inactivityTimeout:2e3,playbackRates:[],liveui:false,children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:os&&(os.languages&&os.languages[0]||os.userLanguage||os.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",breakpoints:{},responsive:false};["ended","seeking","seekable","networkState","readyState"].forEach(function(e){ss.prototype[e]=function(){return this.techGet_(e)}});ts.forEach(function(e){ss.prototype["handleTech"+ze(e)+"_"]=function(){return this.trigger(e)}});Xe.registerComponent("Player",ss);var us="plugin";var ls="activePlugins_";var cs={};var fs=function e(t){return cs.hasOwnProperty(t)};var hs=function e(t){return fs(t)?cs[t]:undefined};var ds=function e(t,i){t[ls]=t[ls]||{};t[ls][i]=true};var ps=function e(t,i,r){var n=(r?"before":"")+"pluginsetup";t.trigger(n,i);t.trigger(n+":"+i.name,i)};var ms=function e(i,r){var t=function e(){ps(this,{name:i,plugin:r,instance:null},true);var t=r.apply(this,arguments);ds(this,i);ps(this,{name:i,plugin:r,instance:t});return t};Object.keys(r).forEach(function(e){t[e]=r[e]});return t};var vs=function e(n,a){a.prototype.name=n;return function(){ps(this,{name:n,plugin:a,instance:null},true);for(var e=arguments.length,t=new Array(e),i=0;i<e;i++){t[i]=arguments[i]}var r=s(a,[this].concat(t));this[n]=function(){return r};ps(this,r.getEventHash());return r}};var gs=function(){function r(e){if(this.constructor===r){throw new Error("Plugin must be sub-classed; not directly instantiated.")}this.player=e;Ve(this);delete this.trigger;qe(this,this.constructor.defaultState);ds(e,this.name);this.dispose=Ae(this,this.dispose);e.on("dispose",this.dispose)}var e=r.prototype;e.version=function e(){return this.constructor.VERSION};e.getEventHash=function e(t){if(t===void 0){t={}}t.name=this.name;t.plugin=this.constructor;t.instance=this;return t};e.trigger=function e(t,i){if(i===void 0){i={}}return ye(this.eventBusEl_,t,this.getEventHash(i))};e.handleStateChanged=function e(t){};e.dispose=function e(){var t=this.name,i=this.player;this.trigger("dispose");this.off();i.off("dispose",this.dispose);i[ls][t]=false;this.player=this.state=null;i[t]=vs(t,cs[t])};r.isBasic=function e(t){var i=typeof t==="string"?hs(t):t;return typeof i==="function"&&!r.prototype.isPrototypeOf(i.prototype)};r.registerPlugin=function e(t,i){if(typeof t!=="string"){throw new Error('Illegal plugin name, "'+t+'", must be a string, was '+typeof t+".")}if(fs(t)){m.warn('A plugin named "'+t+'" already exists. You may want to avoid re-registering plugins!')}else if(ss.prototype.hasOwnProperty(t)){throw new Error('Illegal plugin name, "'+t+'", cannot share a name with an existing player method!')}if(typeof i!=="function"){throw new Error('Illegal plugin for "'+t+'", must be a function, was '+typeof i+".")}cs[t]=i;if(t!==us){if(r.isBasic(i)){ss.prototype[t]=ms(t,i)}else{ss.prototype[t]=vs(t,i)}}return i};r.deregisterPlugin=function e(t){if(t===us){throw new Error("Cannot de-register base plugin.")}if(fs(t)){delete cs[t];delete ss.prototype[t]}};r.getPlugins=function e(t){if(t===void 0){t=Object.keys(cs)}var i;t.forEach(function(e){var t=hs(e);if(t){i=i||{};i[e]=t}});return i};r.getPluginVersion=function e(t){var i=hs(t);return i&&i.VERSION||""};return r}();gs.getPlugin=hs;gs.BASE_PLUGIN_NAME=us;gs.registerPlugin(us,gs);ss.prototype.usingPlugin=function(e){return!!this[ls]&&this[ls][e]===true};ss.prototype.hasPlugin=function(e){return!!fs(e)};var ys=function e(t,i){if(typeof i!=="function"&&i!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof i)}t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:false,writable:true,configurable:true}});if(i){t.super_=i}};var _s=function e(t,i){if(i===void 0){i={}}var r=function e(){t.apply(this,arguments)};var n={};if(typeof i==="object"){if(i.constructor!==Object.prototype.constructor){r=i.constructor}n=i}else if(typeof i==="function"){r=i}ys(r,t);for(var a in n){if(n.hasOwnProperty(a)){r.prototype[a]=n[a]}}return r};var bs=function e(t){return t.indexOf("#")===0?t.slice(1):t};function Ts(e,i,t){var r=Ts.getPlayer(e);if(r){if(i){m.warn('Player "'+e+'" is already initialised. Options will not be applied.')}if(t){r.ready(t)}return r}var n=typeof e==="string"?te("#"+bs(e)):e;if(!I(n)){throw new TypeError("The element or ID supplied is not valid. (videojs)")}if(!h.body.contains(n)){m.warn("The element supplied is not included in the DOM")}i=i||{};Ts.hooks("beforesetup").forEach(function(e){var t=e(n,Ge(i));if(!T(t)||Array.isArray(t)){m.error("please return an object in beforesetup hooks");return}i=Ge(i,t)});var a=Xe.getComponent("Player");r=new a(n,i,t);Ts.hooks("setup").forEach(function(e){return e(r)});return r}Ts.hooks_={};Ts.hooks=function(e,t){Ts.hooks_[e]=Ts.hooks_[e]||[];if(t){Ts.hooks_[e]=Ts.hooks_[e].concat(t)}return Ts.hooks_[e]};Ts.hook=function(e,t){Ts.hooks(e,t)};Ts.hookOnce=function(i,e){Ts.hooks(i,[].concat(e).map(function(t){var e=function e(){Ts.removeHook(i,e);return t.apply(void 0,arguments)};return e}))};Ts.removeHook=function(e,t){var i=Ts.hooks(e).indexOf(t);if(i<=-1){return false}Ts.hooks_[e]=Ts.hooks_[e].slice();Ts.hooks_[e].splice(i,1);return true};if(_.VIDEOJS_NO_DYNAMIC_STYLE!==true&&L()){var Ss=te(".vjs-styles-defaults");if(!Ss){Ss=Ce("vjs-styles-defaults");var ks=te("head");if(ks){ks.insertBefore(Ss,ks.firstChild)}Ee(Ss,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")}}we(1,Ts);Ts.VERSION=d;Ts.options=ss.prototype.options_;Ts.getPlayers=function(){return ss.players};Ts.getPlayer=function(e){var t=ss.players;var i;if(typeof e==="string"){var r=bs(e);var n=t[r];if(n){return n}i=te("#"+r)}else{i=e}if(I(i)){var a=i,s=a.player,o=a.playerId;if(s||t[o]){return s||t[o]}}};Ts.getAllPlayers=function(){return Object.keys(ss.players).map(function(e){return ss.players[e]}).filter(Boolean)};Ts.players=ss.players;Ts.getComponent=Xe.getComponent;Ts.registerComponent=function(e,t){if(Fr.isTech(t)){m.warn("The "+e+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)")}Xe.registerComponent.call(Xe,e,t)};Ts.getTech=Fr.getTech;Ts.registerTech=Fr.registerTech;Ts.use=zr;Object.defineProperty(Ts,"middleware",{value:{},writeable:false,enumerable:true});Object.defineProperty(Ts.middleware,"TERMINATOR",{value:qr,writeable:false,enumerable:true});Ts.browser=dt;Ts.TOUCH_ENABLED=ht;Ts.extend=_s;Ts.mergeOptions=Ge;Ts.bind=Ae;Ts.registerPlugin=gs.registerPlugin;Ts.deregisterPlugin=gs.deregisterPlugin;Ts.plugin=function(e,t){m.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead");return gs.registerPlugin(e,t)};Ts.getPlugins=gs.getPlugins;Ts.getPlugin=gs.getPlugin;Ts.getPluginVersion=gs.getPluginVersion;Ts.addLanguage=function(e,t){var i;e=(""+e).toLowerCase();Ts.options.languages=Ge(Ts.options.languages,(i={},i[e]=t,i));return Ts.options.languages[e]};Ts.log=m;Ts.createLogger=v;Ts.createTimeRange=Ts.createTimeRanges=gt;Ts.formatTime=Ln;Ts.setFormatTime=En;Ts.resetFormatTime=An;Ts.parseUrl=Qt;Ts.isCrossOrigin=ti;Ts.EventTarget=Oe;Ts.on=ve;Ts.one=_e;Ts.off=ge;Ts.trigger=ye;Ts.xhr=Ui;Ts.TextTrack=Hi;Ts.AudioTrack=qi;Ts.VideoTrack=zi;["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(function(e){Ts[e]=function(){m.warn("videojs."+e+"() is deprecated; use videojs.dom."+e+"() instead");return re[e].apply(null,arguments)}});Ts.computedStyle=k;Ts.dom=re;Ts.url=ii;var ws=oi(function(t,e){(function(e){var r=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/;var f=/^([^\/?#]*)(.*)$/;var i=/(?:\/|^)\.(?=\/)/g;var n=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g;var h={buildAbsoluteURL:function e(t,i,r){r=r||{};t=t.trim();i=i.trim();if(!i){if(!r.alwaysNormalize){return t}var n=h.parseURL(t);if(!n){throw new Error("Error trying to parse base URL.")}n.path=h.normalizePath(n.path);return h.buildURLFromParts(n)}var a=h.parseURL(i);if(!a){throw new Error("Error trying to parse relative URL.")}if(a.scheme){if(!r.alwaysNormalize){return i}a.path=h.normalizePath(a.path);return h.buildURLFromParts(a)}var s=h.parseURL(t);if(!s){throw new Error("Error trying to parse base URL.")}if(!s.netLoc&&s.path&&s.path[0]!=="/"){var o=f.exec(s.path);s.netLoc=o[1];s.path=o[2]}if(s.netLoc&&!s.path){s.path="/"}var u={scheme:s.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc){u.netLoc=s.netLoc;if(a.path[0]!=="/"){if(!a.path){u.path=s.path;if(!a.params){u.params=s.params;if(!a.query){u.query=s.query}}}else{var l=s.path;var c=l.substring(0,l.lastIndexOf("/")+1)+a.path;u.path=h.normalizePath(c)}}}if(u.path===null){u.path=r.alwaysNormalize?h.normalizePath(a.path):a.path}return h.buildURLFromParts(u)},parseURL:function e(t){var i=r.exec(t);if(!i){return null}return{scheme:i[1]||"",netLoc:i[2]||"",path:i[3]||"",params:i[4]||"",query:i[5]||"",fragment:i[6]||""}},normalizePath:function e(t){t=t.split("").reverse().join("").replace(i,"");while(t.length!==(t=t.replace(n,"")).length){}return t.split("").reverse().join("")},buildURLFromParts:function e(t){return t.scheme+t.netLoc+t.path+t.params+t.query+t.fragment}};t.exports=h})(si)});var Cs=function e(t,i){if(!(t instanceof i)){throw new TypeError("Cannot call a class as a function")}};var Es=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i){if(Object.prototype.hasOwnProperty.call(i,r)){e[r]=i[r]}}}return e};var As=function e(t,i){if(typeof i!=="function"&&i!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof i)}t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:false,writable:true,configurable:true}});if(i)Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i};var Ls=function e(t,i){if(!t){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return i&&(typeof i==="object"||typeof i==="function")?i:t};var Is=function(){function e(){Cs(this,e);this.listeners={}}e.prototype.on=function e(t,i){if(!this.listeners[t]){this.listeners[t]=[]}this.listeners[t].push(i)};e.prototype.off=function e(t,i){if(!this.listeners[t]){return false}var r=this.listeners[t].indexOf(i);this.listeners[t].splice(r,1);return r>-1};e.prototype.trigger=function e(t){var i=this.listeners[t];var r=void 0;var n=void 0;var a=void 0;if(!i){return}if(arguments.length===2){n=i.length;for(r=0;r<n;++r){i[r].call(this,arguments[1])}}else{a=Array.prototype.slice.call(arguments,1);n=i.length;for(r=0;r<n;++r){i[r].apply(this,a)}}};e.prototype.dispose=function e(){this.listeners={}};e.prototype.pipe=function e(t){this.on("data",function(e){t.push(e)})};return e}();var Os=function(t){As(i,t);function i(){Cs(this,i);var e=Ls(this,t.call(this));e.buffer="";return e}i.prototype.push=function e(t){var i=void 0;this.buffer+=t;i=this.buffer.indexOf("\n");for(;i>-1;i=this.buffer.indexOf("\n")){this.trigger("data",this.buffer.substring(0,i));this.buffer=this.buffer.substring(i+1)}};return i}(Is);var Ps=function e(){var t="[^=]*";var i='"[^"]*"|[^,]*';var r="(?:"+t+")=(?:"+i+")";return new RegExp("(?:^|,)("+r+")")};var Us=function e(t){var i=t.split(Ps());var r={};var n=i.length;var a=void 0;while(n--){if(i[n]===""){continue}a=/([^=]*)=(.*)/.exec(i[n]).slice(1);a[0]=a[0].replace(/^\s+|\s+$/g,"");a[1]=a[1].replace(/^\s+|\s+$/g,"");a[1]=a[1].replace(/^['"](.*)['"]$/g,"$1");r[a[0]]=a[1]}return r};var Ds=function(t){As(i,t);function i(){Cs(this,i);var e=Ls(this,t.call(this));e.customParsers=[];return e}i.prototype.push=function e(t){var i=void 0;var r=void 0;t=t.replace(/^[\u0000\s]+|[\u0000\s]+$/g,"");if(t.length===0){return}if(t[0]!=="#"){this.trigger("data",{type:"uri",uri:t});return}for(var n=0;n<this.customParsers.length;n++){if(this.customParsers[n].call(this,t)){return}}if(t.indexOf("#EXT")!==0){this.trigger("data",{type:"comment",text:t.slice(1)});return}t=t.replace("\r","");i=/^#EXTM3U/.exec(t);if(i){this.trigger("data",{type:"tag",tagType:"m3u"});return}i=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(t);if(i){r={type:"tag",tagType:"inf"};if(i[1]){r.duration=parseFloat(i[1])}if(i[2]){r.title=i[2]}this.trigger("data",r);return}i=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(t);if(i){r={type:"tag",tagType:"targetduration"};if(i[1]){r.duration=parseInt(i[1],10)}this.trigger("data",r);return}i=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(t);if(i){r={type:"tag",tagType:"totalduration"};if(i[1]){r.duration=parseInt(i[1],10)}this.trigger("data",r);return}i=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(t);if(i){r={type:"tag",tagType:"version"};if(i[1]){r.version=parseInt(i[1],10)}this.trigger("data",r);return}i=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(t);if(i){r={type:"tag",tagType:"media-sequence"};if(i[1]){r.number=parseInt(i[1],10)}this.trigger("data",r);return}i=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(t);if(i){r={type:"tag",tagType:"discontinuity-sequence"};if(i[1]){r.number=parseInt(i[1],10)}this.trigger("data",r);return}i=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(t);if(i){r={type:"tag",tagType:"playlist-type"};if(i[1]){r.playlistType=i[1]}this.trigger("data",r);return}i=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(t);if(i){r={type:"tag",tagType:"byterange"};if(i[1]){r.length=parseInt(i[1],10)}if(i[2]){r.offset=parseInt(i[2],10)}this.trigger("data",r);return}i=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(t);if(i){r={type:"tag",tagType:"allow-cache"};if(i[1]){r.allowed=!/NO/.test(i[1])}this.trigger("data",r);return}i=/^#EXT-X-MAP:?(.*)$/.exec(t);if(i){r={type:"tag",tagType:"map"};if(i[1]){var a=Us(i[1]);if(a.URI){r.uri=a.URI}if(a.BYTERANGE){var s=a.BYTERANGE.split("@"),o=s[0],u=s[1];r.byterange={};if(o){r.byterange.length=parseInt(o,10)}if(u){r.byterange.offset=parseInt(u,10)}}}this.trigger("data",r);return}i=/^#EXT-X-STREAM-INF:?(.*)$/.exec(t);if(i){r={type:"tag",tagType:"stream-inf"};if(i[1]){r.attributes=Us(i[1]);if(r.attributes.RESOLUTION){var l=r.attributes.RESOLUTION.split("x");var c={};if(l[0]){c.width=parseInt(l[0],10)}if(l[1]){c.height=parseInt(l[1],10)}r.attributes.RESOLUTION=c}if(r.attributes.BANDWIDTH){r.attributes.BANDWIDTH=parseInt(r.attributes.BANDWIDTH,10)}if(r.attributes["PROGRAM-ID"]){r.attributes["PROGRAM-ID"]=parseInt(r.attributes["PROGRAM-ID"],10)}}this.trigger("data",r);return}i=/^#EXT-X-MEDIA:?(.*)$/.exec(t);if(i){r={type:"tag",tagType:"media"};if(i[1]){r.attributes=Us(i[1])}this.trigger("data",r);return}i=/^#EXT-X-ENDLIST/.exec(t);if(i){this.trigger("data",{type:"tag",tagType:"endlist"});return}i=/^#EXT-X-DISCONTINUITY/.exec(t);if(i){this.trigger("data",{type:"tag",tagType:"discontinuity"});return}i=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(t);if(i){r={type:"tag",tagType:"program-date-time"};if(i[1]){r.dateTimeString=i[1];r.dateTimeObject=new Date(i[1])}this.trigger("data",r);return}i=/^#EXT-X-KEY:?(.*)$/.exec(t);if(i){r={type:"tag",tagType:"key"};if(i[1]){r.attributes=Us(i[1]);if(r.attributes.IV){if(r.attributes.IV.substring(0,2).toLowerCase()==="0x"){r.attributes.IV=r.attributes.IV.substring(2)}r.attributes.IV=r.attributes.IV.match(/.{8}/g);r.attributes.IV[0]=parseInt(r.attributes.IV[0],16);r.attributes.IV[1]=parseInt(r.attributes.IV[1],16);r.attributes.IV[2]=parseInt(r.attributes.IV[2],16);r.attributes.IV[3]=parseInt(r.attributes.IV[3],16);r.attributes.IV=new Uint32Array(r.attributes.IV)}}this.trigger("data",r);return}i=/^#EXT-X-START:?(.*)$/.exec(t);if(i){r={type:"tag",tagType:"start"};if(i[1]){r.attributes=Us(i[1]);r.attributes["TIME-OFFSET"]=parseFloat(r.attributes["TIME-OFFSET"]);r.attributes.PRECISE=/YES/.test(r.attributes.PRECISE)}this.trigger("data",r);return}i=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(t);if(i){r={type:"tag",tagType:"cue-out-cont"};if(i[1]){r.data=i[1]}else{r.data=""}this.trigger("data",r);return}i=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(t);if(i){r={type:"tag",tagType:"cue-out"};if(i[1]){r.data=i[1]}else{r.data=""}this.trigger("data",r);return}i=/^#EXT-X-CUE-IN:?(.*)?$/.exec(t);if(i){r={type:"tag",tagType:"cue-in"};if(i[1]){r.data=i[1]}else{r.data=""}this.trigger("data",r);return}this.trigger("data",{type:"tag",data:t.slice(4)})};i.prototype.addParser=function e(t){var i=this;var r=t.expression,n=t.customType,a=t.dataParser,s=t.segment;if(typeof a!=="function"){a=function e(t){return t}}this.customParsers.push(function(e){var t=r.exec(e);if(t){i.trigger("data",{type:"custom",data:a(e),customType:n,segment:s});return true}})};return i}(Is);var xs=function(i){As(r,i);function r(){Cs(this,r);var e=Ls(this,i.call(this));e.lineStream=new Os;e.parseStream=new Ds;e.lineStream.pipe(e.parseStream);var t=e;var a=[];var s={};var o=void 0;var u=void 0;var l=function e(){};var c={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}};var f=0;e.manifest={allowCache:true,discontinuityStarts:[],segments:[]};e.parseStream.on("data",function(i){var r=void 0;var n=void 0;({tag:function e(){({"allow-cache":function e(){this.manifest.allowCache=i.allowed;if(!("allowed"in i)){this.trigger("info",{message:"defaulting allowCache to YES"});this.manifest.allowCache=true}},byterange:function e(){var e={};if("length"in i){s.byterange=e;e.length=i.length;if(!("offset"in i)){this.trigger("info",{message:"defaulting offset to zero"});i.offset=0}}if("offset"in i){s.byterange=e;e.offset=i.offset}},endlist:function e(){this.manifest.endList=true},inf:function e(){if(!("mediaSequence"in this.manifest)){this.manifest.mediaSequence=0;this.trigger("info",{message:"defaulting media sequence to zero"})}if(!("discontinuitySequence"in this.manifest)){this.manifest.discontinuitySequence=0;this.trigger("info",{message:"defaulting discontinuity sequence to zero"})}if(i.duration>0){s.duration=i.duration}if(i.duration===0){s.duration=.01;this.trigger("info",{message:"updating zero segment duration to a small value"})}this.manifest.segments=a},key:function e(){if(!i.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if(i.attributes.METHOD==="NONE"){u=null;return}if(!i.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(!i.attributes.METHOD){this.trigger("warn",{message:"defaulting key method to AES-128"})}u={method:i.attributes.METHOD||"AES-128",uri:i.attributes.URI};if(typeof i.attributes.IV!=="undefined"){u.iv=i.attributes.IV}},"media-sequence":function e(){if(!isFinite(i.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+i.number});return}this.manifest.mediaSequence=i.number},"discontinuity-sequence":function e(){if(!isFinite(i.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+i.number});return}this.manifest.discontinuitySequence=i.number;f=i.number},"playlist-type":function e(){if(!/VOD|EVENT/.test(i.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+i.playlist});return}this.manifest.playlistType=i.playlistType},map:function e(){o={};if(i.uri){o.uri=i.uri}if(i.byterange){o.byterange=i.byterange}},"stream-inf":function e(){this.manifest.playlists=a;this.manifest.mediaGroups=this.manifest.mediaGroups||c;if(!i.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}if(!s.attributes){s.attributes={}}Es(s.attributes,i.attributes)},media:function e(){this.manifest.mediaGroups=this.manifest.mediaGroups||c;if(!(i.attributes&&i.attributes.TYPE&&i.attributes["GROUP-ID"]&&i.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}var t=this.manifest.mediaGroups[i.attributes.TYPE];t[i.attributes["GROUP-ID"]]=t[i.attributes["GROUP-ID"]]||{};r=t[i.attributes["GROUP-ID"]];n={default:/yes/i.test(i.attributes.DEFAULT)};if(n["default"]){n.autoselect=true}else{n.autoselect=/yes/i.test(i.attributes.AUTOSELECT)}if(i.attributes.LANGUAGE){n.language=i.attributes.LANGUAGE}if(i.attributes.URI){n.uri=i.attributes.URI}if(i.attributes["INSTREAM-ID"]){n.instreamId=i.attributes["INSTREAM-ID"]}if(i.attributes.CHARACTERISTICS){n.characteristics=i.attributes.CHARACTERISTICS}if(i.attributes.FORCED){n.forced=/yes/i.test(i.attributes.FORCED)}r[i.attributes.NAME]=n},discontinuity:function e(){f+=1;s.discontinuity=true;this.manifest.discontinuityStarts.push(a.length)},"program-date-time":function e(){if(typeof this.manifest.dateTimeString==="undefined"){this.manifest.dateTimeString=i.dateTimeString;this.manifest.dateTimeObject=i.dateTimeObject}s.dateTimeString=i.dateTimeString;s.dateTimeObject=i.dateTimeObject},targetduration:function e(){if(!isFinite(i.duration)||i.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+i.duration});return}this.manifest.targetDuration=i.duration},totalduration:function e(){if(!isFinite(i.duration)||i.duration<0){this.trigger("warn",{message:"ignoring invalid total duration: "+i.duration});return}this.manifest.totalDuration=i.duration},start:function e(){if(!i.attributes||isNaN(i.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:i.attributes["TIME-OFFSET"],precise:i.attributes.PRECISE}},"cue-out":function e(){s.cueOut=i.data},"cue-out-cont":function e(){s.cueOutCont=i.data},"cue-in":function e(){s.cueIn=i.data}}[i.tagType]||l).call(t)},uri:function e(){s.uri=i.uri;a.push(s);if(this.manifest.targetDuration&&!("duration"in s)){this.trigger("warn",{message:"defaulting segment duration to the target duration"});s.duration=this.manifest.targetDuration}if(u){s.key=u}s.timeline=f;if(o){s.map=o}s={}},comment:function e(){},custom:function e(){if(i.segment){s.custom=s.custom||{};s.custom[i.customType]=i.data}else{this.manifest.custom=this.manifest.custom||{};this.manifest.custom[i.customType]=i.data}}})[i.type].call(t)});return e}r.prototype.push=function e(t){this.lineStream.push(t)};r.prototype.end=function e(){this.lineStream.push("\n")};r.prototype.addParser=function e(t){this.parseStream.addParser(t)};return r}(Is);var Rs=function e(t){return!!t&&typeof t==="object"};var Ms=function r(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++){t[i]=arguments[i]}return t.reduce(function(t,i){Object.keys(i).forEach(function(e){if(Array.isArray(t[e])&&Array.isArray(i[e])){t[e]=t[e].concat(i[e])}else if(Rs(t[e])&&Rs(i[e])){t[e]=r(t[e],i[e])}else{t[e]=i[e]}});return t},{})};var Bs=function e(t){return Object.keys(t).map(function(e){return t[e]})};var Ns=function e(t,i){var r=[];for(var n=t;n<i;n++){r.push(n)}return r};var js=function e(t){return t.reduce(function(e,t){return e.concat(t)},[])};var Fs=function e(t){if(!t.length){return[]}var i=[];for(var r=0;r<t.length;r++){i.push(t[r])}return i};var Vs=function e(t,r){return t.reduce(function(e,t,i){if(t[r]){e.push(i)}return e},[])};var Hs=function e(t){var i=Bs(t.reduce(function(e,t){var i=t.attributes.id+(t.attributes.lang||"");if(e[i]){var r;t.segments[0].discontinuity=true;(r=e[i].segments).push.apply(r,t.segments);if(t.attributes.contentProtection){e[i].attributes.contentProtection=t.attributes.contentProtection}}else{e[i]=t}return e},{}));return i.map(function(e){e.discontinuityStarts=Vs(e.segments,"discontinuity");return e})};var qs=function e(t){var i;var r=t.attributes,n=t.segments;var a={attributes:(i={NAME:r.id,BANDWIDTH:r.bandwidth,CODECS:r.codecs},i["PROGRAM-ID"]=1,i),uri:"",endList:(r.type||"static")==="static",timeline:r.periodIndex,resolvedUri:"",targetDuration:r.duration,segments:n,mediaSequence:n.length?n[0].number:1};if(r.contentProtection){a.contentProtection=r.contentProtection}return a};var zs=function e(t){var i;var r=t.attributes,n=t.segments;if(typeof n==="undefined"){n=[{uri:r.baseUrl,timeline:r.periodIndex,resolvedUri:r.baseUrl||"",duration:r.sourceDuration,number:0}];r.duration=r.sourceDuration}return{attributes:(i={NAME:r.id,BANDWIDTH:r.bandwidth},i["PROGRAM-ID"]=1,i),uri:"",endList:(r.type||"static")==="static",timeline:r.periodIndex,resolvedUri:r.baseUrl||"",targetDuration:r.duration,segments:n,mediaSequence:n.length?n[0].number:1}};var Ws=function e(t){return t.reduce(function(e,t){var i=t.attributes.role&&t.attributes.role.value||"main";var r=t.attributes.lang||"";var n="main";if(r){n=t.attributes.lang+" ("+i+")"}if(e[n]&&e[n].playlists[0].attributes.BANDWIDTH>t.attributes.bandwidth){return e}e[n]={language:r,autoselect:true,default:i==="main",playlists:[qs(t)],uri:""};return e},{})};var Gs=function e(t){return t.reduce(function(e,t){var i=t.attributes.lang||"text";if(e[i]){return e}e[i]={language:i,default:false,autoselect:false,playlists:[zs(t)],uri:""};return e},{})};var Xs=function e(t){var i;var r=t.attributes,n=t.segments;var a={attributes:(i={NAME:r.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:r.width,height:r.height},CODECS:r.codecs,BANDWIDTH:r.bandwidth},i["PROGRAM-ID"]=1,i),uri:"",endList:(r.type||"static")==="static",timeline:r.periodIndex,resolvedUri:"",targetDuration:r.duration,segments:n,mediaSequence:n.length?n[0].number:1};if(r.contentProtection){a.contentProtection=r.contentProtection}return a};var Ys=function e(t){var i;if(!t.length){return{}}var r=t[0].attributes,n=r.sourceDuration,a=r.minimumUpdatePeriod,s=a===void 0?0:a;var o=function e(t){var i=t.attributes;return i.mimeType==="video/mp4"||i.contentType==="video"};var u=function e(t){var i=t.attributes;return i.mimeType==="audio/mp4"||i.contentType==="audio"};var l=function e(t){var i=t.attributes;return i.mimeType==="text/vtt"||i.contentType==="text"};var c=Hs(t.filter(o)).map(Xs);var f=Hs(t.filter(u));var h=t.filter(l);var d={allowCache:true,discontinuityStarts:[],segments:[],endList:true,mediaGroups:(i={AUDIO:{},VIDEO:{}},i["CLOSED-CAPTIONS"]={},i.SUBTITLES={},i),uri:"",duration:n,playlists:c,minimumUpdatePeriod:s*1e3};if(f.length){d.mediaGroups.AUDIO.audio=Ws(f)}if(h.length){d.mediaGroups.SUBTITLES.subs=Gs(h)}return d};var $s=typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function Ks(e,t){return t={exports:{}},e(t,t.exports),t.exports}var Js=Ks(function(t,e){(function(e){var r=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/;var f=/^([^\/?#]*)(.*)$/;var i=/(?:\/|^)\.(?=\/)/g;var n=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g;var h={buildAbsoluteURL:function e(t,i,r){r=r||{};t=t.trim();i=i.trim();if(!i){if(!r.alwaysNormalize){return t}var n=h.parseURL(t);if(!n){throw new Error("Error trying to parse base URL.")}n.path=h.normalizePath(n.path);return h.buildURLFromParts(n)}var a=h.parseURL(i);if(!a){throw new Error("Error trying to parse relative URL.")}if(a.scheme){if(!r.alwaysNormalize){return i}a.path=h.normalizePath(a.path);return h.buildURLFromParts(a)}var s=h.parseURL(t);if(!s){throw new Error("Error trying to parse base URL.")}if(!s.netLoc&&s.path&&s.path[0]!=="/"){var o=f.exec(s.path);s.netLoc=o[1];s.path=o[2]}if(s.netLoc&&!s.path){s.path="/"}var u={scheme:s.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc){u.netLoc=s.netLoc;if(a.path[0]!=="/"){if(!a.path){u.path=s.path;if(!a.params){u.params=s.params;if(!a.query){u.query=s.query}}}else{var l=s.path;var c=l.substring(0,l.lastIndexOf("/")+1)+a.path;u.path=h.normalizePath(c)}}}if(u.path===null){u.path=r.alwaysNormalize?h.normalizePath(a.path):a.path}return h.buildURLFromParts(u)},parseURL:function e(t){var i=r.exec(t);if(!i){return null}return{scheme:i[1]||"",netLoc:i[2]||"",path:i[3]||"",params:i[4]||"",query:i[5]||"",fragment:i[6]||""}},normalizePath:function e(t){t=t.split("").reverse().join("").replace(i,"");while(t.length!==(t=t.replace(n,"")).length){}return t.split("").reverse().join("")},buildURLFromParts:function e(t){return t.scheme+t.netLoc+t.path+t.params+t.query+t.fragment}};t.exports=h})($s)});var Qs=function e(t,i){if(/^[a-z]+:/i.test(i)){return i}if(!/\/\//i.test(t)){t=Js.buildAbsoluteURL(_.location.href,t)}return Js.buildAbsoluteURL(t,i)};var Zs=function e(t){var i=t.baseUrl,r=i===void 0?"":i,n=t.source,a=n===void 0?"":n,s=t.range,o=s===void 0?"":s;var u={uri:a,resolvedUri:Qs(r||"",a)};if(o){var l=o.split("-");var c=parseInt(l[0],10);var f=parseInt(l[1],10);u.byterange={length:f-c,offset:c}}return u};var eo=function e(t,i,r){var n=t.NOW,a=t.clientOffset,s=t.availabilityStartTime,o=t.timescale,u=o===void 0?1:o,l=t.start,c=l===void 0?0:l,f=t.minimumUpdatePeriod,h=f===void 0?0:f;var d=(n+a)/1e3;var p=s+c;var m=d+h;var v=m-p;return Math.ceil((v*u-i)/r)};var to=function e(t,i){var r=t.type,n=r===void 0?"static":r,a=t.minimumUpdatePeriod,s=a===void 0?0:a,o=t.media,u=o===void 0?"":o,l=t.sourceDuration,c=t.timescale,f=c===void 0?1:c,h=t.startNumber,d=h===void 0?1:h,p=t.periodIndex;var m=[];var v=-1;for(var g=0;g<i.length;g++){var y=i[g];var _=y.d;var b=y.r||0;var T=y.t||0;if(v<0){v=T}if(T&&T>v){v=T}var S=void 0;if(b<0){var k=g+1;if(k===i.length){if(n==="dynamic"&&s>0&&u.indexOf("$Number$")>0){S=eo(t,v,_)}else{S=(l*f-v)/_}}else{S=(i[k].t-v)/_}}else{S=b+1}var w=d+m.length+S;var C=d+m.length;while(C<w){m.push({number:C,duration:_/f,time:v,timeline:p});v+=_;C++}}return m};var io={static:function e(t){var i=t.duration,r=t.timescale,n=r===void 0?1:r,a=t.sourceDuration;return{start:0,end:Math.ceil(a/(i/n))}},dynamic:function e(t){var i=t.NOW,r=t.clientOffset,n=t.availabilityStartTime,a=t.timescale,s=a===void 0?1:a,o=t.duration,u=t.start,l=u===void 0?0:u,c=t.minimumUpdatePeriod,f=c===void 0?0:c,h=t.timeShiftBufferDepth,d=h===void 0?Infinity:h;var p=(i+r)/1e3;var m=n+l;var v=p+f;var g=v-m;var y=Math.ceil(g*s/o);var _=Math.floor((p-m-d)*s/o);var b=Math.floor((p-m)*s/o);return{start:Math.max(0,_),end:Math.min(y,b)}}};var ro=function e(u){return function(e,t){var i=u.duration,r=u.timescale,n=r===void 0?1:r,a=u.periodIndex,s=u.startNumber,o=s===void 0?1:s;return{number:o+e,duration:i/n,timeline:a,time:t*i}}};var no=function e(t){var i=t.type,r=i===void 0?"static":i,n=t.duration,a=t.timescale,s=a===void 0?1:a,o=t.sourceDuration;var u=io[r](t),l=u.start,c=u.end;var f=Ns(l,c).map(ro(t));if(r==="static"){var h=f.length-1;f[h].duration=o-n/s*h}return f};var ao=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g;var so=function e(a){return function(e,t,i,r){if(e==="$$"){return"$"}if(typeof a[t]==="undefined"){return e}var n=""+a[t];if(t==="RepresentationID"){return n}if(!i){r=1}else{r=parseInt(r,10)}if(n.length>=r){return n}return""+new Array(r-n.length+1).join("0")+n}};var oo=function e(t,i){return t.replace(ao,so(i))};var uo=function e(t,i){if(!t.duration&&!i){return[{number:t.startNumber||1,duration:t.sourceDuration,time:0,timeline:t.periodIndex}]}if(t.duration){return no(t)}return to(t,i)};var lo=function e(i,t){var r={RepresentationID:i.id,Bandwidth:i.bandwidth||0};var n=i.initialization,a=n===void 0?{sourceURL:"",range:""}:n;var s=Zs({baseUrl:i.baseUrl,source:oo(a.sourceURL,r),range:a.range});var o=uo(i,t);return o.map(function(e){r.Number=e.number;r.Time=e.time;var t=oo(i.media||"",r);return{uri:t,timeline:e.timeline,duration:e.duration,resolvedUri:Qs(i.baseUrl||"",t),map:s,number:e.number}})};var co={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",MISSING_SEGMENT_INFORMATION:"MISSING_SEGMENT_INFORMATION",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"};var fo=function e(t,i){var r=t.baseUrl,n=t.initialization,a=n===void 0?{}:n;var s=Zs({baseUrl:r,source:a.sourceURL,range:a.range});var o=Zs({baseUrl:r,source:i.media,range:i.mediaRange});o.map=s;return o};var ho=function e(t,i){var r=t.duration,n=t.segmentUrls,a=n===void 0?[]:n;if(!r&&!i||r&&i){throw new Error(co.SEGMENT_TIME_UNSPECIFIED)}var s=a.map(function(e){return fo(t,e)});var o;if(r){o=no(t)}if(i){o=to(t,i)}var u=o.map(function(e,t){if(s[t]){var i=s[t];i.timeline=e.timeline;i.duration=e.duration;i.number=e.number;return i}}).filter(function(e){return e});return u};var po=function e(t){var i=t.baseUrl,r=t.initialization,n=r===void 0?{}:r,a=t.sourceDuration,s=t.timescale,o=s===void 0?1:s,u=t.indexRange,l=u===void 0?"":u,c=t.duration;if(!i){throw new Error(co.NO_BASE_URL)}var f=Zs({baseUrl:i,source:n.sourceURL,range:n.range});var h=Zs({baseUrl:i,source:i,range:l});h.map=f;if(c){var d=no(t);if(d.length){h.duration=d[0].duration;h.timeline=d[0].timeline}}else if(a){h.duration=a/o;h.timeline=0}h.number=0;return[h]};var mo=function e(t){var i=t.attributes,r=t.segmentInfo;var n;var a;if(r.template){a=lo;n=Ms(i,r.template)}else if(r.base){a=po;n=Ms(i,r.base)}else if(r.list){a=ho;n=Ms(i,r.list)}if(!a){return{attributes:i}}var s=a(n,r.timeline);if(n.duration){var o=n,u=o.duration,l=o.timescale,c=l===void 0?1:l;n.duration=u/c}else if(s.length){n.duration=s.reduce(function(e,t){return Math.max(e,Math.ceil(t.duration))},0)}else{n.duration=0}return{attributes:n,segments:s}};var vo=function e(t){return t.map(mo)};var go=function e(t,i){return Fs(t.childNodes).filter(function(e){var t=e.tagName;return t===i})};var yo=function e(t){return t.textContent.trim()};var _o=function e(t){var i=365*24*60*60;var r=30*24*60*60;var n=24*60*60;var a=60*60;var s=60;var o=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/;var u=o.exec(t);if(!u){return 0}var l=u.slice(1),c=l[0],f=l[1],h=l[2],d=l[3],p=l[4],m=l[5];return parseFloat(c||0)*i+parseFloat(f||0)*r+parseFloat(h||0)*n+parseFloat(d||0)*a+parseFloat(p||0)*s+parseFloat(m||0)};var bo=function e(t){var i=/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/;if(i.test(t)){t+="Z"}return Date.parse(t)};var To={mediaPresentationDuration:function e(t){return _o(t)},availabilityStartTime:function e(t){return bo(t)/1e3},minimumUpdatePeriod:function e(t){return _o(t)},timeShiftBufferDepth:function e(t){return _o(t)},start:function e(t){return _o(t)},width:function e(t){return parseInt(t,10)},height:function e(t){return parseInt(t,10)},bandwidth:function e(t){return parseInt(t,10)},startNumber:function e(t){return parseInt(t,10)},timescale:function e(t){return parseInt(t,10)},duration:function e(t){var i=parseInt(t,10);if(isNaN(i)){return _o(t)}return i},d:function e(t){return parseInt(t,10)},t:function e(t){return parseInt(t,10)},r:function e(t){return parseInt(t,10)},DEFAULT:function e(t){return t}};var So=function e(t){if(!(t&&t.attributes)){return{}}return Fs(t.attributes).reduce(function(e,t){var i=To[t.name]||To.DEFAULT;e[t.name]=i(t.value);return e},{})};function ko(e){var t=_.atob(e);var i=new Uint8Array(t.length);for(var r=0;r<t.length;r++){i[r]=t.charCodeAt(r)}return i}var wo={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"};var Co=function e(t,i){if(!i.length){return t}return js(t.map(function(t){return i.map(function(e){return Qs(t,yo(e))})}))};var Eo=function e(t){var i=go(t,"SegmentTemplate")[0];var r=go(t,"SegmentList")[0];var n=r&&go(r,"SegmentURL").map(function(e){return Ms({tag:"SegmentURL"},So(e))});var a=go(t,"SegmentBase")[0];var s=r||i;var o=s&&go(s,"SegmentTimeline")[0];var u=r||a||i;var l=u&&go(u,"Initialization")[0];var c=i&&So(i);if(c&&l){c.initialization=l&&So(l)}else if(c&&c.initialization){c.initialization={sourceURL:c.initialization}}var f={template:c,timeline:o&&go(o,"S").map(function(e){return So(e)}),list:r&&Ms(So(r),{segmentUrls:n,initialization:So(l)}),base:a&&Ms(So(a),{initialization:So(l)})};Object.keys(f).forEach(function(e){if(!f[e]){delete f[e]}});return f};var Ao=function e(a,s,o){return function(e){var t=go(e,"BaseURL");var i=Co(s,t);var r=Ms(a,So(e));var n=Eo(e);return i.map(function(e){return{segmentInfo:Ms(o,n),attributes:Ms(r,{baseUrl:e})}})}};var Lo=function e(t){return t.reduce(function(e,t){var i=So(t);var r=wo[i.schemeIdUri];if(r){e[r]={attributes:i};var n=go(t,"cenc:pssh")[0];if(n){var a=yo(n);var s=a&&ko(a);e[r].pssh=s}}return e},{})};var Io=function e(c,f,h){return function(e){var t=So(e);var i=Co(f,go(e,"BaseURL"));var r=go(e,"Role")[0];var n={role:So(r)};var a=Ms(c,t,n);var s=Lo(go(e,"ContentProtection"));if(Object.keys(s).length){a=Ms(a,{contentProtection:s})}var o=Eo(e);var u=go(e,"Representation");var l=Ms(h,o);return js(u.map(Ao(a,i,l)))}};var Oo=function e(l,c){return function(e,t){var i=Co(c,go(e,"BaseURL"));var r=So(e);var n=parseInt(r.id,10);var a=_.isNaN(n)?t:n;var s=Ms(l,{periodIndex:a});var o=go(e,"AdaptationSet");var u=Eo(e);return js(o.map(Io(s,i,u)))}};var Po=function e(t,i){if(i===void 0){i={}}var r=i,n=r.manifestUri,a=n===void 0?"":n,s=r.NOW,o=s===void 0?Date.now():s,u=r.clientOffset,l=u===void 0?0:u;var c=go(t,"Period");if(!c.length){throw new Error(co.INVALID_NUMBER_OF_PERIOD)}var f=So(t);var h=Co([a],go(t,"BaseURL"));f.sourceDuration=f.mediaPresentationDuration||0;f.NOW=o;f.clientOffset=l;return js(c.map(Oo(f,h)))};var Uo=function e(t){if(t===""){throw new Error(co.DASH_EMPTY_MANIFEST)}var i=new _.DOMParser;var r=i.parseFromString(t,"application/xml");var n=r&&r.documentElement.tagName==="MPD"?r.documentElement:null;if(!n||n&&n.getElementsByTagName("parsererror").length>0){throw new Error(co.DASH_INVALID_XML)}return n};var Do=function e(t){var i=go(t,"UTCTiming")[0];if(!i){return null}var r=So(i);switch(r.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":r.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":r.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":r.method="DIRECT";r.value=Date.parse(r.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(co.UNSUPPORTED_UTC_TIMING_SCHEME)}return r};var xo=function e(t,i){return Ys(vo(Po(Uo(t),i)))};var Ro=function e(t){return Do(Uo(t))};var Mo=function e(t){return t>>>0};var Bo={toUnsigned:Mo};var No=Bo.toUnsigned;var jo,Fo,Vo,Ho,qo;jo=function e(t,i){var r=[],n,a,s,o,u;if(!i.length){return null}for(n=0;n<t.byteLength;){a=No(t[n]<<24|t[n+1]<<16|t[n+2]<<8|t[n+3]);s=Fo(t.subarray(n+4,n+8));o=a>1?n+a:t.byteLength;if(s===i[0]){if(i.length===1){r.push(t.subarray(n+8,o))}else{u=jo(t.subarray(n+8,o),i.slice(1));if(u.length){r=r.concat(u)}}}n=o}return r};Fo=function e(t){var i="";i+=String.fromCharCode(t[0]);i+=String.fromCharCode(t[1]);i+=String.fromCharCode(t[2]);i+=String.fromCharCode(t[3]);return i};Vo=function e(t){var i={},r=jo(t,["moov","trak"]);return r.reduce(function(e,t){var i,r,n,a,s;i=jo(t,["tkhd"])[0];if(!i){return null}r=i[0];n=r===0?12:20;a=No(i[n]<<24|i[n+1]<<16|i[n+2]<<8|i[n+3]);s=jo(t,["mdia","mdhd"])[0];if(!s){return null}r=s[0];n=r===0?12:20;e[a]=No(s[n]<<24|s[n+1]<<16|s[n+2]<<8|s[n+3]);return e},i)};Ho=function e(a,t){var i,r,n;i=jo(t,["moof","traf"]);r=[].concat.apply([],i.map(function(n){return jo(n,["tfhd"]).map(function(e){var t,i,r;t=No(e[4]<<24|e[5]<<16|e[6]<<8|e[7]);i=a[t]||9e4;r=jo(n,["tfdt"]).map(function(e){var t,i;t=e[0];i=No(e[4]<<24|e[5]<<16|e[6]<<8|e[7]);if(t===1){i*=Math.pow(2,32);i+=No(e[8]<<24|e[9]<<16|e[10]<<8|e[11])}return i})[0];r=r||Infinity;return r/i})}));n=Math.min.apply(null,r);return isFinite(n)?n:0};qo=function e(t){var i=jo(t,["moov","trak"]);var u=[];i.forEach(function(e){var t=jo(e,["mdia","hdlr"]);var o=jo(e,["tkhd"]);t.forEach(function(e,t){var i=Fo(e.subarray(8,12));var r=o[t];var n;var a;var s;if(i==="vide"){n=new DataView(r.buffer,r.byteOffset,r.byteLength);a=n.getUint8(0);s=a===0?n.getUint32(12):n.getUint32(20);u.push(s)}})});return u};var zo={findBox:jo,parseType:Fo,timescale:Vo,startTime:Ho,videoTrackIds:qo};var Wo=Math.pow(2,32)-1;var Go,Xo,Yo,$o,Ko,Jo,Qo,Zo,eu,tu,iu,ru,nu,au,su,ou,uu,lu,cu,fu,hu,du,pu,mu,vu,gu,yu,_u,bu,Tu,Su,ku,wu,Cu,Eu,Au;(function(){var e;pu={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]};if(typeof Uint8Array==="undefined"){return}for(e in pu){if(pu.hasOwnProperty(e)){pu[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]}}mu=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]);gu=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]);vu=new Uint8Array([0,0,0,1]);yu=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);_u=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);bu={video:yu,audio:_u};ku=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);Su=new Uint8Array([0,0,0,0,0,0,0,0]);wu=new Uint8Array([0,0,0,0,0,0,0,0]);Cu=wu;Eu=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);Au=wu;Tu=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])})();Go=function e(t){var i=[],r=0,n,a,s;for(n=1;n<arguments.length;n++){i.push(arguments[n])}n=i.length;while(n--){r+=i[n].byteLength}a=new Uint8Array(r+8);s=new DataView(a.buffer,a.byteOffset,a.byteLength);s.setUint32(0,a.byteLength);a.set(t,4);for(n=0,r=8;n<i.length;n++){a.set(i[n],r);r+=i[n].byteLength}return a};Xo=function e(){return Go(pu.dinf,Go(pu.dref,ku))};Yo=function e(t){return Go(pu.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,t.audioobjecttype<<3|t.samplingfrequencyindex>>>1,t.samplingfrequencyindex<<7|t.channelcount<<3,6,1,2]))};$o=function e(){return Go(pu.ftyp,mu,vu,mu,gu)};ou=function e(t){return Go(pu.hdlr,bu[t])};Ko=function e(t){return Go(pu.mdat,t)};su=function e(t){var i=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,t.duration>>>24&255,t.duration>>>16&255,t.duration>>>8&255,t.duration&255,85,196,0,0]);if(t.samplerate){i[12]=t.samplerate>>>24&255;i[13]=t.samplerate>>>16&255;i[14]=t.samplerate>>>8&255;i[15]=t.samplerate&255}return Go(pu.mdhd,i)};au=function e(t){return Go(pu.mdia,su(t),ou(t.type),Qo(t))};Jo=function e(t){return Go(pu.mfhd,new Uint8Array([0,0,0,0,(t&4278190080)>>24,(t&16711680)>>16,(t&65280)>>8,t&255]))};Qo=function e(t){return Go(pu.minf,t.type==="video"?Go(pu.vmhd,Tu):Go(pu.smhd,Su),Xo(),lu(t))};Zo=function e(t,i){var r=[],n=i.length;while(n--){r[n]=fu(i[n])}return Go.apply(null,[pu.moof,Jo(t)].concat(r))};eu=function e(t){var i=t.length,r=[];while(i--){r[i]=ru(t[i])}return Go.apply(null,[pu.moov,iu(4294967295)].concat(r).concat(tu(t)))};tu=function e(t){var i=t.length,r=[];while(i--){r[i]=hu(t[i])}return Go.apply(null,[pu.mvex].concat(r))};iu=function e(t){var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(t&4278190080)>>24,(t&16711680)>>16,(t&65280)>>8,t&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Go(pu.mvhd,i)};uu=function e(t){var i=t.samples||[],r=new Uint8Array(4+i.length),n,a;for(a=0;a<i.length;a++){n=i[a].flags;r[a+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy}return Go(pu.sdtp,r)};lu=function e(t){return Go(pu.stbl,cu(t),Go(pu.stts,Au),Go(pu.stsc,Cu),Go(pu.stsz,Eu),Go(pu.stco,wu))};(function(){var i,r;cu=function e(t){return Go(pu.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),t.type==="video"?i(t):r(t))};i=function e(t){var i=t.sps||[],r=t.pps||[],n=[],a=[],s;for(s=0;s<i.length;s++){n.push((i[s].byteLength&65280)>>>8);n.push(i[s].byteLength&255);n=n.concat(Array.prototype.slice.call(i[s]))}for(s=0;s<r.length;s++){a.push((r[s].byteLength&65280)>>>8);a.push(r[s].byteLength&255);a=a.concat(Array.prototype.slice.call(r[s]))}return Go(pu.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(t.width&65280)>>8,t.width&255,(t.height&65280)>>8,t.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),Go(pu.avcC,new Uint8Array([1,t.profileIdc,t.profileCompatibility,t.levelIdc,255].concat([i.length]).concat(n).concat([r.length]).concat(a))),Go(pu.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))};r=function e(t){return Go(pu.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(t.channelcount&65280)>>8,t.channelcount&255,(t.samplesize&65280)>>8,t.samplesize&255,0,0,0,0,(t.samplerate&65280)>>8,t.samplerate&255,0,0]),Yo(t))}})();nu=function e(t){var i=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(t.id&4278190080)>>24,(t.id&16711680)>>16,(t.id&65280)>>8,t.id&255,0,0,0,0,(t.duration&4278190080)>>24,(t.duration&16711680)>>16,(t.duration&65280)>>8,t.duration&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(t.width&65280)>>8,t.width&255,0,0,(t.height&65280)>>8,t.height&255,0,0]);return Go(pu.tkhd,i)};fu=function e(t){var i,r,n,a,s,o,u;i=Go(pu.tfhd,new Uint8Array([0,0,0,58,(t.id&4278190080)>>24,(t.id&16711680)>>16,(t.id&65280)>>8,t.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0]));o=Math.floor(t.baseMediaDecodeTime/(Wo+1));u=Math.floor(t.baseMediaDecodeTime%(Wo+1));r=Go(pu.tfdt,new Uint8Array([1,0,0,0,o>>>24&255,o>>>16&255,o>>>8&255,o&255,u>>>24&255,u>>>16&255,u>>>8&255,u&255]));s=32+20+8+16+8+8;if(t.type==="audio"){n=du(t,s);return Go(pu.traf,i,r,n)}a=uu(t);n=du(t,a.length+s);return Go(pu.traf,i,r,n,a)};ru=function e(t){t.duration=t.duration||4294967295;return Go(pu.trak,nu(t),au(t))};hu=function e(t){var i=new Uint8Array([0,0,0,0,(t.id&4278190080)>>24,(t.id&16711680)>>16,(t.id&65280)>>8,t.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);if(t.type!=="video"){i[i.length-1]=0}return Go(pu.trex,i)};(function(){var r,n,o;o=function e(t,i){var r=0,n=0,a=0,s=0;if(t.length){if(t[0].duration!==undefined){r=1}if(t[0].size!==undefined){n=2}if(t[0].flags!==undefined){a=4}if(t[0].compositionTimeOffset!==undefined){s=8}}return[0,0,r|n|a|s,1,(t.length&4278190080)>>>24,(t.length&16711680)>>>16,(t.length&65280)>>>8,t.length&255,(i&4278190080)>>>24,(i&16711680)>>>16,(i&65280)>>>8,i&255]};n=function e(t,i){var r,n,a,s;n=t.samples||[];i+=8+12+16*n.length;r=o(n,i);for(s=0;s<n.length;s++){a=n[s];r=r.concat([(a.duration&4278190080)>>>24,(a.duration&16711680)>>>16,(a.duration&65280)>>>8,a.duration&255,(a.size&4278190080)>>>24,(a.size&16711680)>>>16,(a.size&65280)>>>8,a.size&255,a.flags.isLeading<<2|a.flags.dependsOn,a.flags.isDependedOn<<6|a.flags.hasRedundancy<<4|a.flags.paddingValue<<1|a.flags.isNonSyncSample,a.flags.degradationPriority&240<<8,a.flags.degradationPriority&15,(a.compositionTimeOffset&4278190080)>>>24,(a.compositionTimeOffset&16711680)>>>16,(a.compositionTimeOffset&65280)>>>8,a.compositionTimeOffset&255])}return Go(pu.trun,new Uint8Array(r))};r=function e(t,i){var r,n,a,s;n=t.samples||[];i+=8+12+8*n.length;r=o(n,i);for(s=0;s<n.length;s++){a=n[s];r=r.concat([(a.duration&4278190080)>>>24,(a.duration&16711680)>>>16,(a.duration&65280)>>>8,a.duration&255,(a.size&4278190080)>>>24,(a.size&16711680)>>>16,(a.size&65280)>>>8,a.size&255])}return Go(pu.trun,new Uint8Array(r))};du=function e(t,i){if(t.type==="audio"){return r(t,i)}return n(t,i)}})();var Lu={ftyp:$o,mdat:Ko,moof:Zo,moov:eu,initSegment:function e(t){var i=$o(),r=eu(t),n;n=new Uint8Array(i.byteLength+r.byteLength);n.set(i);n.set(r,i.byteLength);return n}};var Iu=function e(){this.init=function(){var a={};this.on=function(e,t){if(!a[e]){a[e]=[]}a[e]=a[e].concat(t)};this.off=function(e,t){var i;if(!a[e]){return false}i=a[e].indexOf(t);a[e]=a[e].slice();a[e].splice(i,1);return i>-1};this.trigger=function(e){var t,i,r,n;t=a[e];if(!t){return}if(arguments.length===2){r=t.length;for(i=0;i<r;++i){t[i].call(this,arguments[1])}}else{n=[];i=arguments.length;for(i=1;i<arguments.length;++i){n.push(arguments[i])}r=t.length;for(i=0;i<r;++i){t[i].apply(this,n)}}};this.dispose=function(){a={}}}};Iu.prototype.pipe=function(t){this.on("data",function(e){t.push(e)});this.on("done",function(e){t.flush(e)});return t};Iu.prototype.push=function(e){this.trigger("data",e)};Iu.prototype.flush=function(e){this.trigger("done",e)};var Ou=Iu;var Pu=function e(t){var i,r,n=[],a=[];n.byteLength=0;for(i=0;i<t.length;i++){r=t[i];if(r.nalUnitType==="access_unit_delimiter_rbsp"){if(n.length){n.duration=r.dts-n.dts;a.push(n)}n=[r];n.byteLength=r.data.byteLength;n.pts=r.pts;n.dts=r.dts}else{if(r.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"){n.keyFrame=true}n.duration=r.dts-n.dts;n.byteLength+=r.data.byteLength;n.push(r)}}if(a.length&&(!n.duration||n.duration<=0)){n.duration=a[a.length-1].duration}a.push(n);return a};var Uu=function e(t){var i,r,n=[],a=[];n.byteLength=0;n.nalCount=0;n.duration=0;n.pts=t[0].pts;n.dts=t[0].dts;a.byteLength=0;a.nalCount=0;a.duration=0;a.pts=t[0].pts;a.dts=t[0].dts;for(i=0;i<t.length;i++){r=t[i];if(r.keyFrame){if(n.length){a.push(n);a.byteLength+=n.byteLength;a.nalCount+=n.nalCount;a.duration+=n.duration}n=[r];n.nalCount=r.length;n.byteLength=r.byteLength;n.pts=r.pts;n.dts=r.dts;n.duration=r.duration}else{n.duration+=r.duration;n.nalCount+=r.length;n.byteLength+=r.byteLength;n.push(r)}}if(a.length&&n.duration<=0){n.duration=a[a.length-1].duration}a.byteLength+=n.byteLength;a.nalCount+=n.nalCount;a.duration+=n.duration;a.push(n);return a};var Du=function e(t){var i;if(!t[0][0].keyFrame&&t.length>1){i=t.shift();t.byteLength-=i.byteLength;t.nalCount-=i.nalCount;t[0][0].dts=i.dts;t[0][0].pts=i.pts;t[0][0].duration+=i.duration}return t};var xu=function e(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}};var Ru=function e(t,i){var r=xu();r.dataOffset=i;r.compositionTimeOffset=t.pts-t.dts;r.duration=t.duration;r.size=4*t.length;r.size+=t.byteLength;if(t.keyFrame){r.flags.dependsOn=2;r.flags.isNonSyncSample=0}return r};var Mu=function e(t,i){var r,n,a,s,o,u=i||0,l=[];for(r=0;r<t.length;r++){s=t[r];for(n=0;n<s.length;n++){o=s[n];a=Ru(o,u);u+=a.size;l.push(a)}}return l};var Bu=function e(t){var i,r,n,a,s,o,u=0,l=t.byteLength,c=t.nalCount,f=l+4*c,h=new Uint8Array(f),d=new DataView(h.buffer);for(i=0;i<t.length;i++){a=t[i];for(r=0;r<a.length;r++){s=a[r];for(n=0;n<s.length;n++){o=s[n];d.setUint32(u,o.data.byteLength);u+=4;h.set(o.data,u);u+=o.data.byteLength}}}return h};var Nu={groupNalsIntoFrames:Pu,groupFramesIntoGops:Uu,extendFirstKeyFrame:Du,generateSampleTable:Mu,concatenateNalData:Bu};var ju=[33,16,5,32,164,27];var Fu=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252];var Vu=function e(t){var i=[];while(t--){i.push(0)}return i};var Hu=function e(i){return Object.keys(i).reduce(function(e,t){e[t]=new Uint8Array(i[t].reduce(function(e,t){return e.concat(t)},[]));return e},{})};var qu={96e3:[ju,[227,64],Vu(154),[56]],88200:[ju,[231],Vu(170),[56]],64e3:[ju,[248,192],Vu(240),[56]],48e3:[ju,[255,192],Vu(268),[55,148,128],Vu(54),[112]],44100:[ju,[255,192],Vu(268),[55,163,128],Vu(84),[112]],32e3:[ju,[255,192],Vu(268),[55,234],Vu(226),[112]],24e3:[ju,[255,192],Vu(268),[55,255,128],Vu(268),[111,112],Vu(126),[224]],16e3:[ju,[255,192],Vu(268),[55,255,128],Vu(268),[111,255],Vu(269),[223,108],Vu(195),[1,192]],12e3:[Fu,Vu(268),[3,127,248],Vu(268),[6,255,240],Vu(268),[13,255,224],Vu(268),[27,253,128],Vu(259),[56]],11025:[Fu,Vu(268),[3,127,248],Vu(268),[6,255,240],Vu(268),[13,255,224],Vu(268),[27,255,192],Vu(268),[55,175,128],Vu(108),[112]],8e3:[Fu,Vu(268),[3,121,16],Vu(47),[7]]};var zu=Hu(qu);var Wu=9e4,Gu,Xu,Yu,$u,Ku,Ju;Gu=function e(t){return t*Wu};Xu=function e(t,i){return t*i};Yu=function e(t){return t/Wu};$u=function e(t,i){return t/i};Ku=function e(t,i){return Gu($u(t,i))};Ju=function e(t,i){return Xu(Yu(t),i)};var Qu={secondsToVideoTs:Gu,secondsToAudioTs:Xu,videoTsToSeconds:Yu,audioTsToSeconds:$u,audioTsToVideoTs:Ku,videoTsToAudioTs:Ju};var Zu=9e4;var el=function e(t){var i,r,n=0;for(i=0;i<t.length;i++){r=t[i];n+=r.data.byteLength}return n};var tl=function e(t,i,r,n){var a,s=0,o=0,u=0,l=0,c,f;if(!i.length){return}a=Qu.audioTsToVideoTs(t.baseMediaDecodeTime,t.samplerate);s=Math.ceil(Zu/(t.samplerate/1024));if(r&&n){o=a-Math.max(r,n);u=Math.floor(o/s);l=u*s}if(u<1||l>Zu/2){return}c=zu[t.samplerate];if(!c){c=i[0].data}for(f=0;f<u;f++){i.splice(f,0,{data:c})}t.baseMediaDecodeTime-=Math.floor(Qu.videoTsToAudioTs(l,t.samplerate))};var il=function e(t,i,r){if(i.minSegmentDts>=r){return t}i.minSegmentDts=Infinity;return t.filter(function(e){if(e.dts>=r){i.minSegmentDts=Math.min(i.minSegmentDts,e.dts);i.minSegmentPts=i.minSegmentDts;return true}return false})};var rl=function e(t){var i,r,n=[];for(i=0;i<t.length;i++){r=t[i];n.push({size:r.data.byteLength,duration:1024})}return n};var nl=function e(t){var i,r,n=0,a=new Uint8Array(el(t));for(i=0;i<t.length;i++){r=t[i];a.set(r.data,n);n+=r.data.byteLength}return a};var al={prefixWithSilence:tl,trimAdtsFramesByEarliestDts:il,generateSampleTable:rl,concatenateFrameData:nl};var sl=9e4;var ol=function e(t,i){if(typeof i.pts==="number"){if(t.timelineStartInfo.pts===undefined){t.timelineStartInfo.pts=i.pts}if(t.minSegmentPts===undefined){t.minSegmentPts=i.pts}else{t.minSegmentPts=Math.min(t.minSegmentPts,i.pts)}if(t.maxSegmentPts===undefined){t.maxSegmentPts=i.pts}else{t.maxSegmentPts=Math.max(t.maxSegmentPts,i.pts)}}if(typeof i.dts==="number"){if(t.timelineStartInfo.dts===undefined){t.timelineStartInfo.dts=i.dts}if(t.minSegmentDts===undefined){t.minSegmentDts=i.dts}else{t.minSegmentDts=Math.min(t.minSegmentDts,i.dts)}if(t.maxSegmentDts===undefined){t.maxSegmentDts=i.dts}else{t.maxSegmentDts=Math.max(t.maxSegmentDts,i.dts)}}};var ul=function e(t){delete t.minSegmentDts;delete t.maxSegmentDts;delete t.minSegmentPts;delete t.maxSegmentPts};var ll=function e(t,i){var r,n,a=t.minSegmentDts;if(!i){a-=t.timelineStartInfo.dts}r=t.timelineStartInfo.baseMediaDecodeTime;r+=a;r=Math.max(0,r);if(t.type==="audio"){n=t.samplerate/sl;r*=n;r=Math.floor(r)}return r};var cl={clearDtsInfo:ul,calculateTrackBaseMediaDecodeTime:ll,collectDtsInfo:ol};var fl=4,hl=128;var dl=function e(t){var i=0,r={payloadType:-1,payloadSize:0},n=0,a=0;while(i<t.byteLength){if(t[i]===hl){break}while(t[i]===255){n+=255;i++}n+=t[i++];while(t[i]===255){a+=255;i++}a+=t[i++];if(!r.payload&&n===fl){r.payloadType=n;r.payloadSize=a;r.payload=t.subarray(i,i+a);break}i+=a;n=0;a=0}return r};var pl=function e(t){if(t.payload[0]!==181){return null}if((t.payload[1]<<8|t.payload[2])!==49){return null}if(String.fromCharCode(t.payload[3],t.payload[4],t.payload[5],t.payload[6])!=="GA94"){return null}if(t.payload[7]!==3){return null}return t.payload.subarray(8,t.payload.length-1)};var ml=function e(t,i){var r=[],n,a,s,o;if(!(i[0]&64)){return r}a=i[0]&31;for(n=0;n<a;n++){s=n*3;o={type:i[s+2]&3,pts:t};if(i[s+2]&4){o.ccData=i[s+3]<<8|i[s+4];r.push(o)}}return r};var vl=function e(t){var i=t.byteLength,r=[],n=1,a,s;while(n<i-2){if(t[n]===0&&t[n+1]===0&&t[n+2]===3){r.push(n+2);n+=2}else{n++}}if(r.length===0){return t}a=i-r.length;s=new Uint8Array(a);var o=0;for(n=0;n<a;o++,n++){if(o===r[0]){o++;r.shift()}s[n]=t[o]}return s};var gl={parseSei:dl,parseUserData:pl,parseCaptionPackets:ml,discardEmulationPreventionBytes:vl,USER_DATA_REGISTERED_ITU_T_T35:fl};var yl=function e(){e.prototype.init.call(this);this.captionPackets_=[];this.ccStreams_=[new wl(0,0),new wl(0,1),new wl(1,0),new wl(1,1)];this.reset();this.ccStreams_.forEach(function(e){e.on("data",this.trigger.bind(this,"data"));e.on("done",this.trigger.bind(this,"done"))},this)};yl.prototype=new Ou;yl.prototype.push=function(e){var t,i,r;if(e.nalUnitType!=="sei_rbsp"){return}t=gl.parseSei(e.escapedRBSP);if(t.payloadType!==gl.USER_DATA_REGISTERED_ITU_T_T35){return}i=gl.parseUserData(t);if(!i){return}if(e.dts<this.latestDts_){this.ignoreNextEqualDts_=true;return}else if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--;if(!this.numSameDts_){this.ignoreNextEqualDts_=false}return}r=gl.parseCaptionPackets(e.pts,i);this.captionPackets_=this.captionPackets_.concat(r);if(this.latestDts_!==e.dts){this.numSameDts_=0}this.numSameDts_++;this.latestDts_=e.dts};yl.prototype.flush=function(){if(!this.captionPackets_.length){this.ccStreams_.forEach(function(e){e.flush()},this);return}this.captionPackets_.forEach(function(e,t){e.presortIndex=t});this.captionPackets_.sort(function(e,t){if(e.pts===t.pts){return e.presortIndex-t.presortIndex}return e.pts-t.pts});this.captionPackets_.forEach(function(e){if(e.type<2){this.dispatchCea608Packet(e)}},this);this.captionPackets_.length=0;this.ccStreams_.forEach(function(e){e.flush()},this);return};yl.prototype.reset=function(){this.latestDts_=null;this.ignoreNextEqualDts_=false;this.numSameDts_=0;this.activeCea608Channel_=[null,null];this.ccStreams_.forEach(function(e){e.reset()})};yl.prototype.dispatchCea608Packet=function(e){if(this.setsChannel1Active(e)){this.activeCea608Channel_[e.type]=0}else if(this.setsChannel2Active(e)){this.activeCea608Channel_[e.type]=1}if(this.activeCea608Channel_[e.type]===null){return}this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)};yl.prototype.setsChannel1Active=function(e){return(e.ccData&30720)===4096};yl.prototype.setsChannel2Active=function(e){return(e.ccData&30720)===6144};var _l={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496};var bl=function e(t){if(t===null){return""}t=_l[t]||t;return String.fromCharCode(t)};var Tl=14;var Sl=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152];var kl=function e(){var t=[],i=Tl+1;while(i--){t.push("")}return t};var wl=function e(t,i){e.prototype.init.call(this);this.field_=t||0;this.dataChannel_=i||0;this.name_="CC"+((this.field_<<1|this.dataChannel_)+1);this.setConstants();this.reset();this.push=function(e){var t,i,r,n,a;t=e.ccData&32639;if(t===this.lastControlCode_){this.lastControlCode_=null;return}if((t&61440)===4096){this.lastControlCode_=t}else if(t!==this.PADDING_){this.lastControlCode_=null}r=t>>>8;n=t&255;if(t===this.PADDING_){return}else if(t===this.RESUME_CAPTION_LOADING_){this.mode_="popOn"}else if(t===this.END_OF_CAPTION_){this.mode_="popOn";this.clearFormatting(e.pts);this.flushDisplayed(e.pts);i=this.displayed_;this.displayed_=this.nonDisplayed_;this.nonDisplayed_=i;this.startPts_=e.pts}else if(t===this.ROLL_UP_2_ROWS_){this.rollUpRows_=2;this.setRollUp(e.pts)}else if(t===this.ROLL_UP_3_ROWS_){this.rollUpRows_=3;this.setRollUp(e.pts)}else if(t===this.ROLL_UP_4_ROWS_){this.rollUpRows_=4;this.setRollUp(e.pts)}else if(t===this.CARRIAGE_RETURN_){this.clearFormatting(e.pts);this.flushDisplayed(e.pts);this.shiftRowsUp_();this.startPts_=e.pts}else if(t===this.BACKSPACE_){if(this.mode_==="popOn"){this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1)}else{this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1)}}else if(t===this.ERASE_DISPLAYED_MEMORY_){this.flushDisplayed(e.pts);this.displayed_=kl()}else if(t===this.ERASE_NON_DISPLAYED_MEMORY_){this.nonDisplayed_=kl()}else if(t===this.RESUME_DIRECT_CAPTIONING_){if(this.mode_!=="paintOn"){this.flushDisplayed(e.pts);this.displayed_=kl()}this.mode_="paintOn";this.startPts_=e.pts}else if(this.isSpecialCharacter(r,n)){r=(r&3)<<8;a=bl(r|n);this[this.mode_](e.pts,a);this.column_++}else if(this.isExtCharacter(r,n)){if(this.mode_==="popOn"){this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1)}else{this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1)}r=(r&3)<<8;a=bl(r|n);this[this.mode_](e.pts,a);this.column_++}else if(this.isMidRowCode(r,n)){this.clearFormatting(e.pts);this[this.mode_](e.pts," ");this.column_++;if((n&14)===14){this.addFormatting(e.pts,["i"])}if((n&1)===1){this.addFormatting(e.pts,["u"])}}else if(this.isOffsetControlCode(r,n)){this.column_+=n&3}else if(this.isPAC(r,n)){var s=Sl.indexOf(t&7968);if(this.mode_==="rollUp"){if(s-this.rollUpRows_+1<0){s=this.rollUpRows_-1}this.setRollUp(e.pts,s)}if(s!==this.row_){this.clearFormatting(e.pts);this.row_=s}if(n&1&&this.formatting_.indexOf("u")===-1){this.addFormatting(e.pts,["u"])}if((t&16)===16){this.column_=((t&14)>>1)*4}if(this.isColorPAC(n)){if((n&14)===14){this.addFormatting(e.pts,["i"])}}}else if(this.isNormalChar(r)){if(n===0){n=null}a=bl(r);a+=bl(n);this[this.mode_](e.pts,a);this.column_+=a.length}}};wl.prototype=new Ou;wl.prototype.flushDisplayed=function(e){var t=this.displayed_.map(function(e){try{return e.trim()}catch(e){console.error("Skipping malformed caption.");return""}}).join("\n").replace(/^\n+|\n+$/g,"");if(t.length){this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})}};wl.prototype.reset=function(){this.mode_="popOn";this.topRow_=0;this.startPts_=0;this.displayed_=kl();this.nonDisplayed_=kl();this.lastControlCode_=null;this.column_=0;this.row_=Tl;this.rollUpRows_=2;this.formatting_=[]};wl.prototype.setConstants=function(){if(this.dataChannel_===0){this.BASE_=16;this.EXT_=17;this.CONTROL_=(20|this.field_)<<8;this.OFFSET_=23}else if(this.dataChannel_===1){this.BASE_=24;this.EXT_=25;this.CONTROL_=(28|this.field_)<<8;this.OFFSET_=31}this.PADDING_=0;this.RESUME_CAPTION_LOADING_=this.CONTROL_|32;this.END_OF_CAPTION_=this.CONTROL_|47;this.ROLL_UP_2_ROWS_=this.CONTROL_|37;this.ROLL_UP_3_ROWS_=this.CONTROL_|38;this.ROLL_UP_4_ROWS_=this.CONTROL_|39;this.CARRIAGE_RETURN_=this.CONTROL_|45;this.RESUME_DIRECT_CAPTIONING_=this.CONTROL_|41;this.BACKSPACE_=this.CONTROL_|33;this.ERASE_DISPLAYED_MEMORY_=this.CONTROL_|44;this.ERASE_NON_DISPLAYED_MEMORY_=this.CONTROL_|46};wl.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&t>=48&&t<=63};wl.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&t>=32&&t<=63};wl.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&t>=32&&t<=47};wl.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&t>=33&&t<=35};wl.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&t>=64&&t<=127};wl.prototype.isColorPAC=function(e){return e>=64&&e<=79||e>=96&&e<=127};wl.prototype.isNormalChar=function(e){return e>=32&&e<=127};wl.prototype.setRollUp=function(e,t){if(this.mode_!=="rollUp"){this.row_=Tl;this.mode_="rollUp";this.flushDisplayed(e);this.nonDisplayed_=kl();this.displayed_=kl()}if(t!==undefined&&t!==this.row_){for(var i=0;i<this.rollUpRows_;i++){this.displayed_[t-i]=this.displayed_[this.row_-i];this.displayed_[this.row_-i]=""}}if(t===undefined){t=this.row_}this.topRow_=t-this.rollUpRows_+1};wl.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var i=t.reduce(function(e,t){return e+"<"+t+">"},"");this[this.mode_](e,i)};wl.prototype.clearFormatting=function(e){if(!this.formatting_.length){return}var t=this.formatting_.reverse().reduce(function(e,t){return e+"</"+t+">"},"");this.formatting_=[];this[this.mode_](e,t)};wl.prototype.popOn=function(e,t){var i=this.nonDisplayed_[this.row_];i+=t;this.nonDisplayed_[this.row_]=i};wl.prototype.rollUp=function(e,t){var i=this.displayed_[this.row_];i+=t;this.displayed_[this.row_]=i};wl.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++){this.displayed_[e]=""}for(e=this.row_+1;e<Tl+1;e++){this.displayed_[e]=""}for(e=this.topRow_;e<this.row_;e++){this.displayed_[e]=this.displayed_[e+1]}this.displayed_[this.row_]=""};wl.prototype.paintOn=function(e,t){var i=this.displayed_[this.row_];i+=t;this.displayed_[this.row_]=i};var Cl={CaptionStream:yl,Cea608Stream:wl};var El={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21};var Al=8589934592;var Ll=4294967296;var Il=function e(t,i){var r=1;if(t>i){r=-1}while(Math.abs(i-t)>Ll){t+=r*Al}return t};var Ol=function e(t){var i,r;e.prototype.init.call(this);this.type_=t;this.push=function(e){if(e.type!==this.type_){return}if(r===undefined){r=e.dts}e.dts=Il(e.dts,r);e.pts=Il(e.pts,r);i=e.dts;this.trigger("data",e)};this.flush=function(){r=i;this.trigger("done")};this.discontinuity=function(){r=void 0;i=void 0}};Ol.prototype=new Ou;var Pl={TimestampRolloverStream:Ol,handleRollover:Il};var Ul=function e(t,i,r){var n,a="";for(n=i;n<r;n++){a+="%"+("00"+t[n].toString(16)).slice(-2)}return a},Dl=function e(t,i,r){return decodeURIComponent(Ul(t,i,r))},xl=function e(t,i,r){return unescape(Ul(t,i,r))},Rl=function e(t){return t[0]<<21|t[1]<<14|t[2]<<7|t[3]},Ml={TXXX:function e(t){var i;if(t.data[0]!==3){return}for(i=1;i<t.data.length;i++){if(t.data[i]===0){t.description=Dl(t.data,1,i);t.value=Dl(t.data,i+1,t.data.length).replace(/\0*$/,"");break}}t.data=t.value},WXXX:function e(t){var i;if(t.data[0]!==3){return}for(i=1;i<t.data.length;i++){if(t.data[i]===0){t.description=Dl(t.data,1,i);t.url=Dl(t.data,i+1,t.data.length);break}}},PRIV:function e(t){var i;for(i=0;i<t.data.length;i++){if(t.data[i]===0){t.owner=xl(t.data,0,i);break}}t.privateData=t.data.subarray(i+1);t.data=t.privateData}},Bl;Bl=function e(t){var l={debug:!!(t&&t.debug),descriptor:t&&t.descriptor},c=0,f=[],h=0,i;Bl.prototype.init.call(this);this.dispatchType=El.METADATA_STREAM_TYPE.toString(16);if(l.descriptor){for(i=0;i<l.descriptor.length;i++){this.dispatchType+=("00"+l.descriptor[i].toString(16)).slice(-2)}}this.push=function(e){var t,i,r,n,a,s;if(e.type!=="timed-metadata"){return}if(e.dataAlignmentIndicator){h=0;f.length=0}if(f.length===0&&(e.data.length<10||e.data[0]!=="I".charCodeAt(0)||e.data[1]!=="D".charCodeAt(0)||e.data[2]!=="3".charCodeAt(0))){if(l.debug){console.log("Skipping unrecognized metadata packet")}return}f.push(e);h+=e.data.byteLength;if(f.length===1){c=Rl(e.data.subarray(6,10));c+=10}if(h<c){return}t={data:new Uint8Array(c),frames:[],pts:f[0].pts,dts:f[0].dts};for(a=0;a<c;){t.data.set(f[0].data.subarray(0,c-a),a);a+=f[0].data.byteLength;h-=f[0].data.byteLength;f.shift()}i=10;if(t.data[5]&64){i+=4;i+=Rl(t.data.subarray(10,14));c-=Rl(t.data.subarray(16,20))}do{r=Rl(t.data.subarray(i+4,i+8));if(r<1){return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.")}s=String.fromCharCode(t.data[i],t.data[i+1],t.data[i+2],t.data[i+3]);n={id:s,data:t.data.subarray(i+10,i+r+10)};n.key=n.id;if(Ml[n.id]){Ml[n.id](n);if(n.owner==="com.apple.streaming.transportStreamTimestamp"){var o=n.data,u=(o[3]&1)<<30|o[4]<<22|o[5]<<14|o[6]<<6|o[7]>>>2;u*=4;u+=o[7]&3;n.timeStamp=u;if(t.pts===undefined&&t.dts===undefined){t.pts=n.timeStamp;t.dts=n.timeStamp}this.trigger("timestamp",n)}}t.frames.push(n);i+=10;i+=r}while(i<c);this.trigger("data",t)}};Bl.prototype=new Ou;var Nl=Bl;var jl=Pl.TimestampRolloverStream;var Fl,Vl,Hl;var ql=188,zl=71;Fl=function e(){var n=new Uint8Array(ql),a=0;Fl.prototype.init.call(this);this.push=function(e){var t=0,i=ql,r;if(a){r=new Uint8Array(e.byteLength+a);r.set(n.subarray(0,a));r.set(e,a);a=0}else{r=e}while(i<r.byteLength){if(r[t]===zl&&r[i]===zl){this.trigger("data",r.subarray(t,i));t+=ql;i+=ql;continue}t++;i++}if(t<r.byteLength){n.set(r.subarray(t),0);a=r.byteLength-t}};this.flush=function(){if(a===ql&&n[0]===zl){this.trigger("data",n);a=0}this.trigger("done")}};Fl.prototype=new Ou;Vl=function e(){var r,n,a,l;Vl.prototype.init.call(this);l=this;this.packetsWaitingForPmt=[];this.programMapTable=undefined;r=function e(t,i){var r=0;if(i.payloadUnitStartIndicator){r+=t[r]+1}if(i.type==="pat"){n(t.subarray(r),i)}else{a(t.subarray(r),i)}};n=function e(t,i){i.section_number=t[7];i.last_section_number=t[8];l.pmtPid=(t[10]&31)<<8|t[11];i.pmtPid=l.pmtPid};a=function e(t,i){var r,n,a,s;if(!(t[5]&1)){return}l.programMapTable={video:null,audio:null,"timed-metadata":{}};r=(t[1]&15)<<8|t[2];n=3+r-4;a=(t[10]&15)<<8|t[11];s=12+a;while(s<n){var o=t[s];var u=(t[s+1]&31)<<8|t[s+2];if(o===El.H264_STREAM_TYPE&&l.programMapTable.video===null){l.programMapTable.video=u}else if(o===El.ADTS_STREAM_TYPE&&l.programMapTable.audio===null){l.programMapTable.audio=u}else if(o===El.METADATA_STREAM_TYPE){l.programMapTable["timed-metadata"][u]=o}s+=((t[s+3]&15)<<8|t[s+4])+5}i.programMapTable=l.programMapTable};this.push=function(e){var t={},i=4;t.payloadUnitStartIndicator=!!(e[1]&64);t.pid=e[1]&31;t.pid<<=8;t.pid|=e[2];if((e[3]&48)>>>4>1){i+=e[i]+1}if(t.pid===0){t.type="pat";r(e.subarray(i),t);this.trigger("data",t)}else if(t.pid===this.pmtPid){t.type="pmt";r(e.subarray(i),t);this.trigger("data",t);while(this.packetsWaitingForPmt.length){this.processPes_.apply(this,this.packetsWaitingForPmt.shift())}}else if(this.programMapTable===undefined){this.packetsWaitingForPmt.push([e,i,t])}else{this.processPes_(e,i,t)}};this.processPes_=function(e,t,i){if(i.pid===this.programMapTable.video){i.streamType=El.H264_STREAM_TYPE}else if(i.pid===this.programMapTable.audio){i.streamType=El.ADTS_STREAM_TYPE}else{i.streamType=this.programMapTable["timed-metadata"][i.pid]}i.type="pes";i.data=e.subarray(t);this.trigger("data",i)}};Vl.prototype=new Ou;Vl.STREAM_TYPES={h264:27,adts:15};Hl=function e(){var c=this,n={data:[],size:0},a={data:[],size:0},s={data:[],size:0},f=function e(t,i){var r;i.packetLength=6+(t[4]<<8|t[5]);i.dataAlignmentIndicator=(t[6]&4)!==0;r=t[7];if(r&192){i.pts=(t[9]&14)<<27|(t[10]&255)<<20|(t[11]&254)<<12|(t[12]&255)<<5|(t[13]&254)>>>3;i.pts*=4;i.pts+=(t[13]&6)>>>1;i.dts=i.pts;if(r&64){i.dts=(t[14]&14)<<27|(t[15]&255)<<20|(t[16]&254)<<12|(t[17]&255)<<5|(t[18]&254)>>>3;i.dts*=4;i.dts+=(t[18]&6)>>>1}}i.data=t.subarray(9+t[8])},o=function e(t,i,r){var n=new Uint8Array(t.size),a={type:i},s=0,o=0,u=false,l;if(!t.data.length||t.size<9){return}a.trackId=t.data[0].pid;for(s=0;s<t.data.length;s++){l=t.data[s];n.set(l.data,o);o+=l.data.byteLength}f(n,a);u=i==="video"||a.packetLength<=t.size;if(r||u){t.size=0;t.data.length=0}if(u){c.trigger("data",a)}};Hl.prototype.init.call(this);this.push=function(r){({pat:function e(){},pes:function e(){var t,i;switch(r.streamType){case El.H264_STREAM_TYPE:case El.H264_STREAM_TYPE:t=n;i="video";break;case El.ADTS_STREAM_TYPE:t=a;i="audio";break;case El.METADATA_STREAM_TYPE:t=s;i="timed-metadata";break;default:return}if(r.payloadUnitStartIndicator){o(t,i,true)}t.data.push(r);t.size+=r.data.byteLength},pmt:function e(){var t={type:"metadata",tracks:[]},i=r.programMapTable;if(i.video!==null){t.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+i.video,codec:"avc",type:"video"})}if(i.audio!==null){t.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+i.audio,codec:"adts",type:"audio"})}c.trigger("data",t)}})[r.type]()};this.flush=function(){o(n,"video");o(a,"audio");o(s,"timed-metadata");this.trigger("done")}};Hl.prototype=new Ou;var Wl={PAT_PID:0,MP2T_PACKET_LENGTH:ql,TransportPacketStream:Fl,TransportParseStream:Vl,ElementaryStream:Hl,TimestampRolloverStream:jl,CaptionStream:Cl.CaptionStream,Cea608Stream:Cl.Cea608Stream,MetadataStream:Nl};for(var Gl in El){if(El.hasOwnProperty(Gl)){Wl[Gl]=El[Gl]}}var Xl=Wl;var Yl;var $l=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];Yl=function e(){var l;Yl.prototype.init.call(this);this.push=function(e){var t=0,i=0,r,n,a,s,o,u;if(e.type!=="audio"){return}if(l){s=l;l=new Uint8Array(s.byteLength+e.data.byteLength);l.set(s);l.set(e.data,s.byteLength)}else{l=e.data}while(t+5<l.length){if(l[t]!==255||(l[t+1]&246)!==240){t++;continue}n=(~l[t+1]&1)*2;r=(l[t+3]&3)<<11|l[t+4]<<3|(l[t+5]&224)>>5;o=((l[t+6]&3)+1)*1024;u=o*9e4/$l[(l[t+2]&60)>>>2];a=t+r;if(l.byteLength<a){return}this.trigger("data",{pts:e.pts+i*u,dts:e.dts+i*u,sampleCount:o,audioobjecttype:(l[t+2]>>>6&3)+1,channelcount:(l[t+2]&1)<<2|(l[t+3]&192)>>>6,samplerate:$l[(l[t+2]&60)>>>2],samplingfrequencyindex:(l[t+2]&60)>>>2,samplesize:16,data:l.subarray(t+7+n,a)});if(l.byteLength===a){l=undefined;return}i++;l=l.subarray(a)}};this.flush=function(){this.trigger("done")}};Yl.prototype=new Ou;var Kl=Yl;var Jl;Jl=function e(r){var n=r.byteLength,a=0,s=0;this.length=function(){return 8*n};this.bitsAvailable=function(){return 8*n+s};this.loadWord=function(){var e=r.byteLength-n,t=new Uint8Array(4),i=Math.min(4,n);if(i===0){throw new Error("no bytes available")}t.set(r.subarray(e,e+i));a=new DataView(t.buffer).getUint32(0);s=i*8;n-=i};this.skipBits=function(e){var t;if(s>e){a<<=e;s-=e}else{e-=s;t=Math.floor(e/8);e-=t*8;n-=t;this.loadWord();a<<=e;s-=e}};this.readBits=function(e){var t=Math.min(s,e),i=a>>>32-t;s-=t;if(s>0){a<<=t}else if(n>0){this.loadWord()}t=e-t;if(t>0){return i<<t|this.readBits(t)}return i};this.skipLeadingZeros=function(){var e;for(e=0;e<s;++e){if((a&2147483648>>>e)!==0){a<<=e;s-=e;return e}}this.loadWord();return e+this.skipLeadingZeros()};this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())};this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())};this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1};this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();if(1&e){return 1+e>>>1}return-1*(e>>>1)};this.readBoolean=function(){return this.readBits(1)===1};this.readUnsignedByte=function(){return this.readBits(8)};this.loadWord()};var Ql=Jl;var Zl,ec;var tc;ec=function e(){var i=0,r,n;ec.prototype.init.call(this);this.push=function(e){var t;if(!n){n=e.data}else{t=new Uint8Array(n.byteLength+e.data.byteLength);t.set(n);t.set(e.data,n.byteLength);n=t}for(;i<n.byteLength-3;i++){if(n[i+2]===1){r=i+5;break}}while(r<n.byteLength){switch(n[r]){case 0:if(n[r-1]!==0){r+=2;break}else if(n[r-2]!==0){r++;break}if(i+3!==r-2){this.trigger("data",n.subarray(i+3,r-2))}do{r++}while(n[r]!==1&&r<n.length);i=r-2;r+=3;break;case 1:if(n[r-1]!==0||n[r-2]!==0){r+=3;break}this.trigger("data",n.subarray(i+3,r-2));i=r-2;r+=3;break;default:r+=3;break}}n=n.subarray(i);r-=i;i=0};this.flush=function(){if(n&&n.byteLength>3){this.trigger("data",n.subarray(i+3))}n=null;i=0;this.trigger("done")}};ec.prototype=new Ou;tc={100:true,110:true,122:true,244:true,44:true,83:true,86:true,118:true,128:true,138:true,139:true,134:true};Zl=function e(){var t=new ec,i,r,n,a,s,o,T;Zl.prototype.init.call(this);i=this;this.push=function(e){if(e.type!=="video"){return}r=e.trackId;n=e.pts;a=e.dts;t.push(e)};t.on("data",function(e){var t={trackId:r,pts:n,dts:a,data:e};switch(e[0]&31){case 5:t.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:t.nalUnitType="sei_rbsp";t.escapedRBSP=s(e.subarray(1));break;case 7:t.nalUnitType="seq_parameter_set_rbsp";t.escapedRBSP=s(e.subarray(1));t.config=o(t.escapedRBSP);break;case 8:t.nalUnitType="pic_parameter_set_rbsp";break;case 9:t.nalUnitType="access_unit_delimiter_rbsp";break;default:break}i.trigger("data",t)});t.on("done",function(){i.trigger("done")});this.flush=function(){t.flush()};T=function e(t,i){var r=8,n=8,a,s;for(a=0;a<t;a++){if(n!==0){s=i.readExpGolomb();n=(r+s+256)%256}r=n===0?r:n}};s=function e(t){var i=t.byteLength,r=[],n=1,a,s;while(n<i-2){if(t[n]===0&&t[n+1]===0&&t[n+2]===3){r.push(n+2);n+=2}else{n++}}if(r.length===0){return t}a=i-r.length;s=new Uint8Array(a);var o=0;for(n=0;n<a;o++,n++){if(o===r[0]){o++;r.shift()}s[n]=t[o]}return s};o=function e(t){var i=0,r=0,n=0,a=0,s=1,o,u,l,c,f,h,d,p,m,v,g,y,_,b;o=new Ql(t);u=o.readUnsignedByte();c=o.readUnsignedByte();l=o.readUnsignedByte();o.skipUnsignedExpGolomb();if(tc[u]){f=o.readUnsignedExpGolomb();if(f===3){o.skipBits(1)}o.skipUnsignedExpGolomb();o.skipUnsignedExpGolomb();o.skipBits(1);if(o.readBoolean()){g=f!==3?8:12;for(b=0;b<g;b++){if(o.readBoolean()){if(b<6){T(16,o)}else{T(64,o)}}}}}o.skipUnsignedExpGolomb();h=o.readUnsignedExpGolomb();if(h===0){o.readUnsignedExpGolomb()}else if(h===1){o.skipBits(1);o.skipExpGolomb();o.skipExpGolomb();d=o.readUnsignedExpGolomb();for(b=0;b<d;b++){o.skipExpGolomb()}}o.skipUnsignedExpGolomb();o.skipBits(1);p=o.readUnsignedExpGolomb();m=o.readUnsignedExpGolomb();v=o.readBits(1);if(v===0){o.skipBits(1)}o.skipBits(1);if(o.readBoolean()){i=o.readUnsignedExpGolomb();r=o.readUnsignedExpGolomb();n=o.readUnsignedExpGolomb();a=o.readUnsignedExpGolomb()}if(o.readBoolean()){if(o.readBoolean()){_=o.readUnsignedByte();switch(_){case 1:y=[1,1];break;case 2:y=[12,11];break;case 3:y=[10,11];break;case 4:y=[16,11];break;case 5:y=[40,33];break;case 6:y=[24,11];break;case 7:y=[20,11];break;case 8:y=[32,11];break;case 9:y=[80,33];break;case 10:y=[18,11];break;case 11:y=[15,11];break;case 12:y=[64,33];break;case 13:y=[160,99];break;case 14:y=[4,3];break;case 15:y=[3,2];break;case 16:y=[2,1];break;case 255:{y=[o.readUnsignedByte()<<8|o.readUnsignedByte(),o.readUnsignedByte()<<8|o.readUnsignedByte()];break}}if(y){s=y[0]/y[1]}}}return{profileIdc:u,levelIdc:l,profileCompatibility:c,width:Math.ceil(((p+1)*16-i*2-r*2)*s),height:(2-v)*(m+1)*16-n*2-a*2}}};Zl.prototype=new Ou;var ic={H264Stream:Zl,NalByteStream:ec};var rc=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];var nc=function e(t){if(t[0]==="I".charCodeAt(0)&&t[1]==="D".charCodeAt(0)&&t[2]==="3".charCodeAt(0)){return true}return false};var ac=function e(t){return t[0]<<21|t[1]<<14|t[2]<<7|t[3]};var sc=function e(t,i,r){var n,a="";for(n=i;n<r;n++){a+="%"+("00"+t[n].toString(16)).slice(-2)}return a};var oc=function e(t,i,r){return unescape(sc(t,i,r))};var uc=function e(t,i){var r=t[i+6]<<21|t[i+7]<<14|t[i+8]<<7|t[i+9],n=t[i+5],a=(n&16)>>4;if(a){return r+20}return r+10};var lc=function e(t,i){var r=(t[i+5]&224)>>5,n=t[i+4]<<3,a=t[i+3]&3<<11;return a|n|r};var cc=function e(t,i){if(t[i]==="I".charCodeAt(0)&&t[i+1]==="D".charCodeAt(0)&&t[i+2]==="3".charCodeAt(0)){return"timed-metadata"}else if(t[i]&255===255&&(t[i+1]&240)===240){return"audio"}return null};var fc=function e(t){var i=0;while(i+5<t.length){if(t[i]!==255||(t[i+1]&246)!==240){i++;continue}return rc[(t[i+2]&60)>>>2]}return null};var hc=function e(t){var i,r,n,a;i=10;if(t[5]&64){i+=4;i+=ac(t.subarray(10,14))}do{r=ac(t.subarray(i+4,i+8));if(r<1){return null}a=String.fromCharCode(t[i],t[i+1],t[i+2],t[i+3]);if(a==="PRIV"){n=t.subarray(i+10,i+r+10);for(var s=0;s<n.byteLength;s++){if(n[s]===0){var o=oc(n,0,s);if(o==="com.apple.streaming.transportStreamTimestamp"){var u=n.subarray(s+1);var l=(u[3]&1)<<30|u[4]<<22|u[5]<<14|u[6]<<6|u[7]>>>2;l*=4;l+=u[7]&3;return l}break}}}i+=10;i+=r}while(i<t.byteLength);return null};var dc={isLikelyAacData:nc,parseId3TagSize:uc,parseAdtsSize:lc,parseType:cc,parseSampleRate:fc,parseAacTimestamp:hc};var pc;pc=function e(){var o=new Uint8Array,u=0;pc.prototype.init.call(this);this.setTimestamp=function(e){u=e};this.push=function(e){var t=0,i=0,r,n,a,s;if(o.length){s=o.length;o=new Uint8Array(e.byteLength+s);o.set(o.subarray(0,s));o.set(e,s)}else{o=e}while(o.length-i>=3){if(o[i]==="I".charCodeAt(0)&&o[i+1]==="D".charCodeAt(0)&&o[i+2]==="3".charCodeAt(0)){if(o.length-i<10){break}t=dc.parseId3TagSize(o,i);if(i+t>o.length){break}n={type:"timed-metadata",data:o.subarray(i,i+t)};this.trigger("data",n);i+=t;continue}else if((o[i]&255)===255&&(o[i+1]&240)===240){if(o.length-i<7){break}t=dc.parseAdtsSize(o,i);if(i+t>o.length){break}a={type:"audio",data:o.subarray(i,i+t),pts:u,dts:u};this.trigger("data",a);i+=t;continue}i++}r=o.length-i;if(r>0){o=o.subarray(i)}else{o=new Uint8Array}}};pc.prototype=new Ou;var mc=pc;var vc=ic.H264Stream;var gc=dc.isLikelyAacData;var yc=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"];var _c=["width","height","profileIdc","levelIdc","profileCompatibility"];var bc,Tc,Sc,kc;var wc=function e(t,i){var r;if(t.length!==i.length){return false}for(r=0;r<t.length;r++){if(t[r]!==i[r]){return false}}return true};Tc=function e(n,a){var s=[],o=0,u=0,l=0,c=Infinity;a=a||{};Tc.prototype.init.call(this);this.push=function(t){cl.collectDtsInfo(n,t);if(n){yc.forEach(function(e){n[e]=t[e]})}s.push(t)};this.setEarliestDts=function(e){u=e-n.timelineStartInfo.baseMediaDecodeTime};this.setVideoBaseMediaDecodeTime=function(e){c=e};this.setAudioAppendStart=function(e){l=e};this.flush=function(){var e,t,i,r;if(s.length===0){this.trigger("done","AudioSegmentStream");return}e=al.trimAdtsFramesByEarliestDts(s,n,u);n.baseMediaDecodeTime=cl.calculateTrackBaseMediaDecodeTime(n,a.keepOriginalTimestamps);al.prefixWithSilence(n,e,l,c);n.samples=al.generateSampleTable(e);i=Lu.mdat(al.concatenateFrameData(e));s=[];t=Lu.moof(o,[n]);r=new Uint8Array(t.byteLength+i.byteLength);o++;r.set(t);r.set(i,t.byteLength);cl.clearDtsInfo(n);this.trigger("data",{track:n,boxes:r});this.trigger("done","AudioSegmentStream")}};Tc.prototype=new Ou;bc=function e(l,o){var u=0,c=[],f=[],t,i;o=o||{};bc.prototype.init.call(this);delete l.minPTS;this.gopCache_=[];this.push=function(e){cl.collectDtsInfo(l,e);if(e.nalUnitType==="seq_parameter_set_rbsp"&&!t){t=e.config;l.sps=[e.data];_c.forEach(function(e){l[e]=t[e]},this)}if(e.nalUnitType==="pic_parameter_set_rbsp"&&!i){i=e.data;l.pps=[e.data]}c.push(e)};this.flush=function(){var e,t,i,r,n,a;while(c.length){if(c[0].nalUnitType==="access_unit_delimiter_rbsp"){break}c.shift()}if(c.length===0){this.resetStream_();this.trigger("done","VideoSegmentStream");return}e=Nu.groupNalsIntoFrames(c);i=Nu.groupFramesIntoGops(e);if(!i[0][0].keyFrame){t=this.getGopForFusion_(c[0],l);if(t){i.unshift(t);i.byteLength+=t.byteLength;i.nalCount+=t.nalCount;i.pts=t.pts;i.dts=t.dts;i.duration+=t.duration}else{i=Nu.extendFirstKeyFrame(i)}}if(f.length){var s;if(o.alignGopsAtEnd){s=this.alignGopsAtEnd_(i)}else{s=this.alignGopsAtStart_(i)}if(!s){this.gopCache_.unshift({gop:i.pop(),pps:l.pps,sps:l.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);c=[];this.resetStream_();this.trigger("done","VideoSegmentStream");return}cl.clearDtsInfo(l);i=s}cl.collectDtsInfo(l,i);l.samples=Nu.generateSampleTable(i);n=Lu.mdat(Nu.concatenateNalData(i));l.baseMediaDecodeTime=cl.calculateTrackBaseMediaDecodeTime(l,o.keepOriginalTimestamps);this.trigger("processedGopsInfo",i.map(function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}}));this.gopCache_.unshift({gop:i.pop(),pps:l.pps,sps:l.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);c=[];this.trigger("baseMediaDecodeTime",l.baseMediaDecodeTime);this.trigger("timelineStartInfo",l.timelineStartInfo);r=Lu.moof(u,[l]);a=new Uint8Array(r.byteLength+n.byteLength);u++;a.set(r);a.set(n,r.byteLength);this.trigger("data",{track:l,boxes:a});this.resetStream_();this.trigger("done","VideoSegmentStream")};this.resetStream_=function(){cl.clearDtsInfo(l);t=undefined;i=undefined};this.getGopForFusion_=function(e){var t=45e3,i=1e4,r=Infinity,n,a,s,o,u;for(u=0;u<this.gopCache_.length;u++){o=this.gopCache_[u];s=o.gop;if(!(l.pps&&wc(l.pps[0],o.pps[0]))||!(l.sps&&wc(l.sps[0],o.sps[0]))){continue}if(s.dts<l.timelineStartInfo.dts){continue}n=e.dts-s.dts-s.duration;if(n>=-i&&n<=t){if(!a||r>n){a=o;r=n}}}if(a){return a.gop}return null};this.alignGopsAtStart_=function(e){var t,i,r,n,a,s,o,u;a=e.byteLength;s=e.nalCount;o=e.duration;t=i=0;while(t<f.length&&i<e.length){r=f[t];n=e[i];if(r.pts===n.pts){break}if(n.pts>r.pts){t++;continue}i++;a-=n.byteLength;s-=n.nalCount;o-=n.duration}if(i===0){return e}if(i===e.length){return null}u=e.slice(i);u.byteLength=a;u.duration=o;u.nalCount=s;u.pts=u[0].pts;u.dts=u[0].dts;return u};this.alignGopsAtEnd_=function(e){var t,i,r,n,a,s;t=f.length-1;i=e.length-1;a=null;s=false;while(t>=0&&i>=0){r=f[t];n=e[i];if(r.pts===n.pts){s=true;break}if(r.pts>n.pts){t--;continue}if(t===f.length-1){a=i}i--}if(!s&&a===null){return null}var o;if(s){o=i}else{o=a}if(o===0){return e}var u=e.slice(o);var l=u.reduce(function(e,t){e.byteLength+=t.byteLength;e.duration+=t.duration;e.nalCount+=t.nalCount;return e},{byteLength:0,duration:0,nalCount:0});u.byteLength=l.byteLength;u.duration=l.duration;u.nalCount=l.nalCount;u.pts=u[0].pts;u.dts=u[0].dts;return u};this.alignGopsWith=function(e){f=e}};bc.prototype=new Ou;kc=function e(t,i){this.numberOfTracks=0;this.metadataStream=i;t=t||{};if(typeof t.remux!=="undefined"){this.remuxTracks=!!t.remux}else{this.remuxTracks=true}if(typeof t.keepOriginalTimestamps==="boolean"){this.keepOriginalTimestamps=t.keepOriginalTimestamps}this.pendingTracks=[];this.videoTrack=null;this.pendingBoxes=[];this.pendingCaptions=[];this.pendingMetadata=[];this.pendingBytes=0;this.emittedTracks=0;kc.prototype.init.call(this);this.push=function(e){if(e.text){return this.pendingCaptions.push(e)}if(e.frames){return this.pendingMetadata.push(e)}this.pendingTracks.push(e.track);this.pendingBoxes.push(e.boxes);this.pendingBytes+=e.boxes.byteLength;if(e.track.type==="video"){this.videoTrack=e.track}if(e.track.type==="audio"){this.audioTrack=e.track}}};kc.prototype=new Ou;kc.prototype.flush=function(e){var t=0,i={captions:[],captionStreams:{},metadata:[],info:{}},r,n,a,s=0,o;if(this.pendingTracks.length<this.numberOfTracks){if(e!=="VideoSegmentStream"&&e!=="AudioSegmentStream"){return}else if(this.remuxTracks){return}else if(this.pendingTracks.length===0){this.emittedTracks++;if(this.emittedTracks>=this.numberOfTracks){this.trigger("done");this.emittedTracks=0}return}}if(this.videoTrack){s=this.videoTrack.timelineStartInfo.pts;_c.forEach(function(e){i.info[e]=this.videoTrack[e]},this)}else if(this.audioTrack){s=this.audioTrack.timelineStartInfo.pts;yc.forEach(function(e){i.info[e]=this.audioTrack[e]},this)}if(this.pendingTracks.length===1){i.type=this.pendingTracks[0].type}else{i.type="combined"}this.emittedTracks+=this.pendingTracks.length;a=Lu.initSegment(this.pendingTracks);i.initSegment=new Uint8Array(a.byteLength);i.initSegment.set(a);i.data=new Uint8Array(this.pendingBytes);for(o=0;o<this.pendingBoxes.length;o++){i.data.set(this.pendingBoxes[o],t);t+=this.pendingBoxes[o].byteLength}for(o=0;o<this.pendingCaptions.length;o++){r=this.pendingCaptions[o];r.startTime=r.startPts;if(!this.keepOriginalTimestamps){r.startTime-=s}r.startTime/=9e4;r.endTime=r.endPts;if(!this.keepOriginalTimestamps){r.endTime-=s}r.endTime/=9e4;i.captionStreams[r.stream]=true;i.captions.push(r)}for(o=0;o<this.pendingMetadata.length;o++){n=this.pendingMetadata[o];n.cueTime=n.pts;if(!this.keepOriginalTimestamps){n.cueTime-=s}n.cueTime/=9e4;i.metadata.push(n)}i.metadata.dispatchType=this.metadataStream.dispatchType;this.pendingTracks.length=0;this.videoTrack=null;this.pendingBoxes.length=0;this.pendingCaptions.length=0;this.pendingBytes=0;this.pendingMetadata.length=0;this.trigger("data",i);if(this.emittedTracks>=this.numberOfTracks){this.trigger("done");this.emittedTracks=0}};Sc=function e(r){var n=this,i=true,a,s;Sc.prototype.init.call(this);r=r||{};this.baseMediaDecodeTime=r.baseMediaDecodeTime||0;this.transmuxPipeline_={};this.setupAacPipeline=function(){var t={};this.transmuxPipeline_=t;t.type="aac";t.metadataStream=new Xl.MetadataStream;t.aacStream=new mc;t.audioTimestampRolloverStream=new Xl.TimestampRolloverStream("audio");t.timedMetadataTimestampRolloverStream=new Xl.TimestampRolloverStream("timed-metadata");t.adtsStream=new Kl;t.coalesceStream=new kc(r,t.metadataStream);t.headOfPipeline=t.aacStream;t.aacStream.pipe(t.audioTimestampRolloverStream).pipe(t.adtsStream);t.aacStream.pipe(t.timedMetadataTimestampRolloverStream).pipe(t.metadataStream).pipe(t.coalesceStream);t.metadataStream.on("timestamp",function(e){t.aacStream.setTimestamp(e.timeStamp)});t.aacStream.on("data",function(e){if(e.type==="timed-metadata"&&!t.audioSegmentStream){s=s||{timelineStartInfo:{baseMediaDecodeTime:n.baseMediaDecodeTime},codec:"adts",type:"audio"};t.coalesceStream.numberOfTracks++;t.audioSegmentStream=new Tc(s,r);t.adtsStream.pipe(t.audioSegmentStream).pipe(t.coalesceStream)}});t.coalesceStream.on("data",this.trigger.bind(this,"data"));t.coalesceStream.on("done",this.trigger.bind(this,"done"))};this.setupTsPipeline=function(){var i={};this.transmuxPipeline_=i;i.type="ts";i.metadataStream=new Xl.MetadataStream;i.packetStream=new Xl.TransportPacketStream;i.parseStream=new Xl.TransportParseStream;i.elementaryStream=new Xl.ElementaryStream;i.videoTimestampRolloverStream=new Xl.TimestampRolloverStream("video");i.audioTimestampRolloverStream=new Xl.TimestampRolloverStream("audio");i.timedMetadataTimestampRolloverStream=new Xl.TimestampRolloverStream("timed-metadata");i.adtsStream=new Kl;i.h264Stream=new vc;i.captionStream=new Xl.CaptionStream;i.coalesceStream=new kc(r,i.metadataStream);i.headOfPipeline=i.packetStream;i.packetStream.pipe(i.parseStream).pipe(i.elementaryStream);i.elementaryStream.pipe(i.videoTimestampRolloverStream).pipe(i.h264Stream);i.elementaryStream.pipe(i.audioTimestampRolloverStream).pipe(i.adtsStream);i.elementaryStream.pipe(i.timedMetadataTimestampRolloverStream).pipe(i.metadataStream).pipe(i.coalesceStream);i.h264Stream.pipe(i.captionStream).pipe(i.coalesceStream);i.elementaryStream.on("data",function(e){var t;if(e.type==="metadata"){t=e.tracks.length;while(t--){if(!a&&e.tracks[t].type==="video"){a=e.tracks[t];a.timelineStartInfo.baseMediaDecodeTime=n.baseMediaDecodeTime}else if(!s&&e.tracks[t].type==="audio"){s=e.tracks[t];s.timelineStartInfo.baseMediaDecodeTime=n.baseMediaDecodeTime}}if(a&&!i.videoSegmentStream){i.coalesceStream.numberOfTracks++;i.videoSegmentStream=new bc(a,r);i.videoSegmentStream.on("timelineStartInfo",function(e){if(s){s.timelineStartInfo=e;i.audioSegmentStream.setEarliestDts(e.dts)}});i.videoSegmentStream.on("processedGopsInfo",n.trigger.bind(n,"gopInfo"));i.videoSegmentStream.on("baseMediaDecodeTime",function(e){if(s){i.audioSegmentStream.setVideoBaseMediaDecodeTime(e)}});i.h264Stream.pipe(i.videoSegmentStream).pipe(i.coalesceStream)}if(s&&!i.audioSegmentStream){i.coalesceStream.numberOfTracks++;i.audioSegmentStream=new Tc(s,r);i.adtsStream.pipe(i.audioSegmentStream).pipe(i.coalesceStream)}}});i.coalesceStream.on("data",this.trigger.bind(this,"data"));i.coalesceStream.on("done",this.trigger.bind(this,"done"))};this.setBaseMediaDecodeTime=function(e){var t=this.transmuxPipeline_;if(!r.keepOriginalTimestamps){this.baseMediaDecodeTime=e}if(s){s.timelineStartInfo.dts=undefined;s.timelineStartInfo.pts=undefined;cl.clearDtsInfo(s);if(!r.keepOriginalTimestamps){s.timelineStartInfo.baseMediaDecodeTime=e}if(t.audioTimestampRolloverStream){t.audioTimestampRolloverStream.discontinuity()}}if(a){if(t.videoSegmentStream){t.videoSegmentStream.gopCache_=[];t.videoTimestampRolloverStream.discontinuity()}a.timelineStartInfo.dts=undefined;a.timelineStartInfo.pts=undefined;cl.clearDtsInfo(a);t.captionStream.reset();if(!r.keepOriginalTimestamps){a.timelineStartInfo.baseMediaDecodeTime=e}}if(t.timedMetadataTimestampRolloverStream){t.timedMetadataTimestampRolloverStream.discontinuity()}};this.setAudioAppendStart=function(e){if(s){this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)}};this.alignGopsWith=function(e){if(a&&this.transmuxPipeline_.videoSegmentStream){this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)}};this.push=function(e){if(i){var t=gc(e);if(t&&this.transmuxPipeline_.type!=="aac"){this.setupAacPipeline()}else if(!t&&this.transmuxPipeline_.type!=="ts"){this.setupTsPipeline()}i=false}this.transmuxPipeline_.headOfPipeline.push(e)};this.flush=function(){i=true;this.transmuxPipeline_.headOfPipeline.flush()};this.resetCaptions=function(){if(this.transmuxPipeline_.captionStream){this.transmuxPipeline_.captionStream.reset()}}};Sc.prototype=new Ou;var Cc={Transmuxer:Sc,VideoSegmentStream:bc,AudioSegmentStream:Tc,AUDIO_PROPERTIES:yc,VIDEO_PROPERTIES:_c};var Ec,Ac,Lc=zo.parseType,Ic=function e(t){return new Date(t*1e3-20828448e5)},Oc=function e(t){return{isLeading:(t[0]&12)>>>2,dependsOn:t[0]&3,isDependedOn:(t[1]&192)>>>6,hasRedundancy:(t[1]&48)>>>4,paddingValue:(t[1]&14)>>>1,isNonSyncSample:t[1]&1,degradationPriority:t[2]<<8|t[3]}},Pc=function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r=[],n,a;for(n=0;n+4<t.length;n+=a){a=i.getUint32(n);n+=4;if(a<=0){r.push("<span style='color:red;'>MALFORMED DATA</span>");continue}switch(t[n]&31){case 1:r.push("slice_layer_without_partitioning_rbsp");break;case 5:r.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:r.push("sei_rbsp");break;case 7:r.push("seq_parameter_set_rbsp");break;case 8:r.push("pic_parameter_set_rbsp");break;case 9:r.push("access_unit_delimiter_rbsp");break;default:r.push("UNKNOWN NAL - "+t[n]&31);break}}return r},Uc={avc1:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength);return{dataReferenceIndex:i.getUint16(6),width:i.getUint16(24),height:i.getUint16(26),horizresolution:i.getUint16(28)+i.getUint16(30)/16,vertresolution:i.getUint16(32)+i.getUint16(34)/16,frameCount:i.getUint16(40),depth:i.getUint16(74),config:Ec(t.subarray(78,t.byteLength))}},avcC:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r={configurationVersion:t[0],avcProfileIndication:t[1],profileCompatibility:t[2],avcLevelIndication:t[3],lengthSizeMinusOne:t[4]&3,sps:[],pps:[]},n=t[5]&31,a,s,o,u;o=6;for(u=0;u<n;u++){s=i.getUint16(o);o+=2;r.sps.push(new Uint8Array(t.subarray(o,o+s)));o+=s}a=t[o];o++;for(u=0;u<a;u++){s=i.getUint16(o);o+=2;r.pps.push(new Uint8Array(t.subarray(o,o+s)));o+=s}return r},btrt:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength);return{bufferSizeDB:i.getUint32(0),maxBitrate:i.getUint32(4),avgBitrate:i.getUint32(8)}},esds:function e(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),esId:t[6]<<8|t[7],streamPriority:t[8]&31,decoderConfig:{objectProfileIndication:t[11],streamType:t[12]>>>2&63,bufferSize:t[13]<<16|t[14]<<8|t[15],maxBitrate:t[16]<<24|t[17]<<16|t[18]<<8|t[19],avgBitrate:t[20]<<24|t[21]<<16|t[22]<<8|t[23],decoderConfigDescriptor:{tag:t[24],length:t[25],audioObjectType:t[26]>>>3&31,samplingFrequencyIndex:(t[26]&7)<<1|t[27]>>>7&1,channelConfiguration:t[27]>>>3&15}}}},ftyp:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r={majorBrand:Lc(t.subarray(0,4)),minorVersion:i.getUint32(4),compatibleBrands:[]},n=8;while(n<t.byteLength){r.compatibleBrands.push(Lc(t.subarray(n,n+4)));n+=4}return r},dinf:function e(t){return{boxes:Ec(t)}},dref:function e(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),dataReferences:Ec(t.subarray(8))}},hdlr:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r={version:i.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),handlerType:Lc(t.subarray(8,12)),name:""},n=8;for(n=24;n<t.byteLength;n++){if(t[n]===0){n++;break}r.name+=String.fromCharCode(t[n])}r.name=decodeURIComponent(escape(r.name));return r},mdat:function e(t){return{byteLength:t.byteLength,nals:Pc(t)}},mdhd:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r=4,n,a={version:i.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),language:""};if(a.version===1){r+=4;a.creationTime=Ic(i.getUint32(r));r+=8;a.modificationTime=Ic(i.getUint32(r));r+=4;a.timescale=i.getUint32(r);r+=8;a.duration=i.getUint32(r)}else{a.creationTime=Ic(i.getUint32(r));r+=4;a.modificationTime=Ic(i.getUint32(r));r+=4;a.timescale=i.getUint32(r);r+=4;a.duration=i.getUint32(r)}r+=4;n=i.getUint16(r);a.language+=String.fromCharCode((n>>10)+96);a.language+=String.fromCharCode(((n&992)>>5)+96);a.language+=String.fromCharCode((n&31)+96);return a},mdia:function e(t){return{boxes:Ec(t)}},mfhd:function e(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),sequenceNumber:t[4]<<24|t[5]<<16|t[6]<<8|t[7]}},minf:function e(t){return{boxes:Ec(t)}},mp4a:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r={dataReferenceIndex:i.getUint16(6),channelcount:i.getUint16(16),samplesize:i.getUint16(18),samplerate:i.getUint16(24)+i.getUint16(26)/65536};if(t.byteLength>28){r.streamDescriptor=Ec(t.subarray(28))[0]}return r},moof:function e(t){return{boxes:Ec(t)}},moov:function e(t){return{boxes:Ec(t)}},mvex:function e(t){return{boxes:Ec(t)}},mvhd:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r=4,n={version:i.getUint8(0),flags:new Uint8Array(t.subarray(1,4))};if(n.version===1){r+=4;n.creationTime=Ic(i.getUint32(r));r+=8;n.modificationTime=Ic(i.getUint32(r));r+=4;n.timescale=i.getUint32(r);r+=8;n.duration=i.getUint32(r)}else{n.creationTime=Ic(i.getUint32(r));r+=4;n.modificationTime=Ic(i.getUint32(r));r+=4;n.timescale=i.getUint32(r);r+=4;n.duration=i.getUint32(r)}r+=4;n.rate=i.getUint16(r)+i.getUint16(r+2)/16;r+=4;n.volume=i.getUint8(r)+i.getUint8(r+1)/8;r+=2;r+=2;r+=2*4;n.matrix=new Uint32Array(t.subarray(r,r+9*4));r+=9*4;r+=6*4;n.nextTrackId=i.getUint32(r);return n},pdin:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:i.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),rate:i.getUint32(4),initialDelay:i.getUint32(8)}},sdtp:function e(t){var i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),samples:[]},r;for(r=4;r<t.byteLength;r++){i.samples.push({dependsOn:(t[r]&48)>>4,isDependedOn:(t[r]&12)>>2,hasRedundancy:t[r]&3})}return i},sidx:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r={version:t[0],flags:new Uint8Array(t.subarray(1,4)),references:[],referenceId:i.getUint32(4),timescale:i.getUint32(8),earliestPresentationTime:i.getUint32(12),firstOffset:i.getUint32(16)},n=i.getUint16(22),a;for(a=24;n;a+=12,n--){r.references.push({referenceType:(t[a]&128)>>>7,referencedSize:i.getUint32(a)&2147483647,subsegmentDuration:i.getUint32(a+4),startsWithSap:!!(t[a+8]&128),sapType:(t[a+8]&112)>>>4,sapDeltaTime:i.getUint32(a+8)&268435455})}return r},smhd:function e(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),balance:t[4]+t[5]/256}},stbl:function e(t){return{boxes:Ec(t)}},stco:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r={version:t[0],flags:new Uint8Array(t.subarray(1,4)),chunkOffsets:[]},n=i.getUint32(4),a;for(a=8;n;a+=4,n--){r.chunkOffsets.push(i.getUint32(a))}return r},stsc:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r=i.getUint32(4),n={version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleToChunks:[]},a;for(a=8;r;a+=12,r--){n.sampleToChunks.push({firstChunk:i.getUint32(a),samplesPerChunk:i.getUint32(a+4),sampleDescriptionIndex:i.getUint32(a+8)})}return n},stsd:function e(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleDescriptions:Ec(t.subarray(8))}},stsz:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r={version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleSize:i.getUint32(4),entries:[]},n;for(n=12;n<t.byteLength;n+=4){r.entries.push(i.getUint32(n))}return r},stts:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r={version:t[0],flags:new Uint8Array(t.subarray(1,4)),timeToSamples:[]},n=i.getUint32(4),a;for(a=8;n;a+=8,n--){r.timeToSamples.push({sampleCount:i.getUint32(a),sampleDelta:i.getUint32(a+4)})}return r},styp:function e(t){return Uc.ftyp(t)},tfdt:function e(t){var i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),baseMediaDecodeTime:t[4]<<24|t[5]<<16|t[6]<<8|t[7]};if(i.version===1){i.baseMediaDecodeTime*=Math.pow(2,32);i.baseMediaDecodeTime+=t[8]<<24|t[9]<<16|t[10]<<8|t[11]}return i},tfhd:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r={version:t[0],flags:new Uint8Array(t.subarray(1,4)),trackId:i.getUint32(4)},n=r.flags[2]&1,a=r.flags[2]&2,s=r.flags[2]&8,o=r.flags[2]&16,u=r.flags[2]&32,l=r.flags[0]&65536,c=r.flags[0]&131072,f;f=8;if(n){f+=4;r.baseDataOffset=i.getUint32(12);f+=4}if(a){r.sampleDescriptionIndex=i.getUint32(f);f+=4}if(s){r.defaultSampleDuration=i.getUint32(f);f+=4}if(o){r.defaultSampleSize=i.getUint32(f);f+=4}if(u){r.defaultSampleFlags=i.getUint32(f)}if(l){r.durationIsEmpty=true}if(!n&&c){r.baseDataOffsetIsMoof=true}return r},tkhd:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r=4,n={version:i.getUint8(0),flags:new Uint8Array(t.subarray(1,4))};if(n.version===1){r+=4;n.creationTime=Ic(i.getUint32(r));r+=8;n.modificationTime=Ic(i.getUint32(r));r+=4;n.trackId=i.getUint32(r);r+=4;r+=8;n.duration=i.getUint32(r)}else{n.creationTime=Ic(i.getUint32(r));r+=4;n.modificationTime=Ic(i.getUint32(r));r+=4;n.trackId=i.getUint32(r);r+=4;r+=4;n.duration=i.getUint32(r)}r+=4;r+=2*4;n.layer=i.getUint16(r);r+=2;n.alternateGroup=i.getUint16(r);r+=2;n.volume=i.getUint8(r)+i.getUint8(r+1)/8;r+=2;r+=2;n.matrix=new Uint32Array(t.subarray(r,r+9*4));r+=9*4;n.width=i.getUint16(r)+i.getUint16(r+2)/16;r+=4;n.height=i.getUint16(r)+i.getUint16(r+2)/16;return n},traf:function e(t){return{boxes:Ec(t)}},trak:function e(t){return{boxes:Ec(t)}},trex:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),trackId:i.getUint32(4),defaultSampleDescriptionIndex:i.getUint32(8),defaultSampleDuration:i.getUint32(12),defaultSampleSize:i.getUint32(16),sampleDependsOn:t[20]&3,sampleIsDependedOn:(t[21]&192)>>6,sampleHasRedundancy:(t[21]&48)>>4,samplePaddingValue:(t[21]&14)>>1,sampleIsDifferenceSample:!!(t[21]&1),sampleDegradationPriority:i.getUint16(22)}},trun:function e(t){var i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),samples:[]},r=new DataView(t.buffer,t.byteOffset,t.byteLength),n=i.flags[2]&1,a=i.flags[2]&4,s=i.flags[1]&1,o=i.flags[1]&2,u=i.flags[1]&4,l=i.flags[1]&8,c=r.getUint32(4),f=8,h;if(n){i.dataOffset=r.getInt32(f);f+=4}if(a&&c){h={flags:Oc(t.subarray(f,f+4))};f+=4;if(s){h.duration=r.getUint32(f);f+=4}if(o){h.size=r.getUint32(f);f+=4}if(l){h.compositionTimeOffset=r.getUint32(f);f+=4}i.samples.push(h);c--}while(c--){h={};if(s){h.duration=r.getUint32(f);f+=4}if(o){h.size=r.getUint32(f);f+=4}if(u){h.flags=Oc(t.subarray(f,f+4));f+=4}if(l){h.compositionTimeOffset=r.getUint32(f);f+=4}i.samples.push(h)}return i},"url ":function e(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4))}},vmhd:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),graphicsmode:i.getUint16(4),opcolor:new Uint16Array([i.getUint16(6),i.getUint16(8),i.getUint16(10)])}}};Ec=function e(t){var i=0,r=[],n,a,s,o,u;var l=new ArrayBuffer(t.length);var c=new Uint8Array(l);for(var f=0;f<t.length;++f){c[f]=t[f]}n=new DataView(l);while(i<t.byteLength){a=n.getUint32(i);s=Lc(t.subarray(i+4,i+8));o=a>1?i+a:t.byteLength;u=(Uc[s]||function(e){return{data:e}})(t.subarray(i+8,o));u.size=a;u.type=s;r.push(u);i=o}return r};Ac=function e(t,i){var a;i=i||0;a=new Array(i*2+1).join(" ");return t.map(function(n,e){return a+n.type+"\n"+Object.keys(n).filter(function(e){return e!=="type"&&e!=="boxes"}).map(function(e){var t=a+"  "+e+": ",i=n[e];if(i instanceof Uint8Array||i instanceof Uint32Array){var r=Array.prototype.slice.call(new Uint8Array(i.buffer,i.byteOffset,i.byteLength)).map(function(e){return" "+("00"+e.toString(16)).slice(-2)}).join("").match(/.{1,24}/g);if(!r){return t+"<>"}if(r.length===1){return t+"<"+r.join("").slice(1)+">"}return t+"<\n"+r.map(function(e){return a+"  "+e}).join("\n")+"\n"+a+"  >"}return t+JSON.stringify(i,null,2).split("\n").map(function(e,t){if(t===0){return e}return a+"  "+e}).join("\n")}).join("\n")+(n.boxes?"\n"+Ac(n.boxes,i+1):"")}).join("\n")};var Dc={inspect:Ec,textify:Ac,parseTfdt:Uc.tfdt,parseHdlr:Uc.hdlr,parseTfhd:Uc.tfhd,parseTrun:Uc.trun};var xc=gl.discardEmulationPreventionBytes;var Rc=Cl.CaptionStream;var Mc=function e(t,i){var r=t;for(var n=0;n<i.length;n++){var a=i[n];if(r<a.size){return a}r-=a.size}return null};var Bc=function e(t,i,r){var n=new DataView(t.buffer,t.byteOffset,t.byteLength),a=[],s,o,u,l;for(o=0;o+4<t.length;o+=u){u=n.getUint32(o);o+=4;if(u<=0){continue}switch(t[o]&31){case 6:var c=t.subarray(o+1,o+1+u);var f=Mc(o,i);s={nalUnitType:"sei_rbsp",size:u,data:c,escapedRBSP:xc(c),trackId:r};if(f){s.pts=f.pts;s.dts=f.dts;l=f}else{s.pts=l.pts;s.dts=l.dts}a.push(s);break;default:break}}return a};var Nc=function e(t,i,r){var n=i;var a=r.defaultSampleDuration||0;var s=r.defaultSampleSize||0;var o=r.trackId;var u=[];t.forEach(function(e){var t=Dc.parseTrun(e);var i=t.samples;i.forEach(function(e){if(e.duration===undefined){e.duration=a}if(e.size===undefined){e.size=s}e.trackId=o;e.dts=n;if(e.compositionTimeOffset===undefined){e.compositionTimeOffset=0}e.pts=n+e.compositionTimeOffset;n+=e.duration});u=u.concat(i)});return u};var jc=function e(t,f){var r=zo.findBox(t,["moof","traf"]);var i=zo.findBox(t,["mdat"]);var h={};var n=[];i.forEach(function(e,t){var i=r[t];n.push({mdat:e,traf:i})});n.forEach(function(e){var t=e.mdat;var i=e.traf;var r=zo.findBox(i,["tfhd"]);var n=Dc.parseTfhd(r[0]);var a=n.trackId;var s=zo.findBox(i,["tfdt"]);var o=s.length>0?Dc.parseTfdt(s[0]).baseMediaDecodeTime:0;var u=zo.findBox(i,["trun"]);var l;var c;if(f===a&&u.length>0){l=Nc(u,o,n);c=Bc(t,l,a);if(!h[a]){h[a]=[]}h[a]=h[a].concat(c)}});return h};var Fc=function e(t,i,r){var n;if(!i){return null}n=jc(t,i);return{seiNals:n[i],timescale:r}};var Vc=function e(){var t=false;var i;var a;var s;var o;var u;this.isInitialized=function(){return t};this.init=function(){i=new Rc;t=true;i.on("data",function(e){e.startTime=e.startPts/o;e.endTime=e.endPts/o;u.captions.push(e);u.captionStreams[e.stream]=true})};this.isNewInit=function(e,t){if(e&&e.length===0||t&&typeof t==="object"&&Object.keys(t).length===0){return false}return s!==e[0]||o!==t[s]};this.parse=function(e,t,i){var r;if(!this.isInitialized()){return null}else if(!t||!i){return null}else if(this.isNewInit(t,i)){s=t[0];o=i[s]}else if(!s||!o){a.push(e);return null}while(a.length>0){var n=a.shift();this.parse(n,t,i)}r=Fc(e,s,o);if(r===null||!r.seiNals){return null}this.pushNals(r.seiNals);this.flushStream();return u};this.pushNals=function(e){if(!this.isInitialized()||!e||e.length===0){return null}e.forEach(function(e){i.push(e)})};this.flushStream=function(){if(!this.isInitialized()){return null}i.flush()};this.clearParsedCaptions=function(){u.captions=[];u.captionStreams={}};this.resetCaptionStream=function(){if(!this.isInitialized()){return null}i.reset()};this.clearAllCaptions=function(){this.clearParsedCaptions();this.resetCaptionStream()};this.reset=function(){a=[];s=null;o=null;if(!u){u={captions:[],captionStreams:{}}}else{this.clearParsedCaptions()}this.resetCaptionStream()};this.reset()};var Hc=Vc;var qc={generator:Lu,probe:zo,Transmuxer:Cc.Transmuxer,AudioSegmentStream:Cc.AudioSegmentStream,VideoSegmentStream:Cc.VideoSegmentStream,CaptionParser:Hc};var zc=qc.CaptionParser;var Wc=function e(t){var i=t[1]&31;i<<=8;i|=t[2];return i};var Gc=function e(t){return!!(t[1]&64)};var Xc=function e(t){var i=0;if((t[3]&48)>>>4>1){i+=t[4]+1}return i};var Yc=function e(t,i){var r=Wc(t);if(r===0){return"pat"}else if(r===i){return"pmt"}else if(i){return"pes"}return null};var $c=function e(t){var i=Gc(t);var r=4+Xc(t);if(i){r+=t[r]+1}return(t[r+10]&31)<<8|t[r+11]};var Kc=function e(t){var i={};var r=Gc(t);var n=4+Xc(t);if(r){n+=t[n]+1}if(!(t[n+5]&1)){return}var a,s,o;a=(t[n+1]&15)<<8|t[n+2];s=3+a-4;o=(t[n+10]&15)<<8|t[n+11];var u=12+o;while(u<s){var l=n+u;i[(t[l+1]&31)<<8|t[l+2]]=t[l];u+=((t[l+3]&15)<<8|t[l+4])+5}return i};var Jc=function e(t,i){var r=Wc(t);var n=i[r];switch(n){case El.H264_STREAM_TYPE:return"video";case El.ADTS_STREAM_TYPE:return"audio";case El.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}};var Qc=function e(t){var i=Gc(t);if(!i){return null}var r=4+Xc(t);if(r>=t.byteLength){return null}var n=null;var a;a=t[r+7];if(a&192){n={};n.pts=(t[r+9]&14)<<27|(t[r+10]&255)<<20|(t[r+11]&254)<<12|(t[r+12]&255)<<5|(t[r+13]&254)>>>3;n.pts*=4;n.pts+=(t[r+13]&6)>>>1;n.dts=n.pts;if(a&64){n.dts=(t[r+14]&14)<<27|(t[r+15]&255)<<20|(t[r+16]&254)<<12|(t[r+17]&255)<<5|(t[r+18]&254)>>>3;n.dts*=4;n.dts+=(t[r+18]&6)>>>1}}return n};var Zc=function e(t){switch(t){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}};var ef=function e(t){var i=4+Xc(t);var r=t.subarray(i);var n=0;var a=0;var s=false;var o;for(;a<r.byteLength-3;a++){if(r[a+2]===1){n=a+5;break}}while(n<r.byteLength){switch(r[n]){case 0:if(r[n-1]!==0){n+=2;break}else if(r[n-2]!==0){n++;break}if(a+3!==n-2){o=Zc(r[a+3]&31);if(o==="slice_layer_without_partitioning_rbsp_idr"){s=true}}do{n++}while(r[n]!==1&&n<r.length);a=n-2;n+=3;break;case 1:if(r[n-1]!==0||r[n-2]!==0){n+=3;break}o=Zc(r[a+3]&31);if(o==="slice_layer_without_partitioning_rbsp_idr"){s=true}a=n-2;n+=3;break;default:n+=3;break}}r=r.subarray(a);n-=a;a=0;if(r&&r.byteLength>3){o=Zc(r[a+3]&31);if(o==="slice_layer_without_partitioning_rbsp_idr"){s=true}}return s};var tf={parseType:Yc,parsePat:$c,parsePmt:Kc,parsePayloadUnitStartIndicator:Gc,parsePesType:Jc,parsePesTime:Qc,videoPacketContainsKeyFrame:ef};var rf=Pl.handleRollover;var nf={};nf.ts=tf;nf.aac=dc;var af=9e4,sf=188,of=71;var uf=function e(t,i){var r=0,n=sf,a,s;while(n<t.byteLength){if(t[r]===of&&t[n]===of){a=t.subarray(r,n);s=nf.ts.parseType(a,i.pid);switch(s){case"pat":if(!i.pid){i.pid=nf.ts.parsePat(a)}break;case"pmt":if(!i.table){i.table=nf.ts.parsePmt(a)}break;default:break}if(i.pid&&i.table){return}r+=sf;n+=sf;continue}r++;n++}};var lf=function e(t,i,r){var n=0,a=sf,s,o,u,l,c;var f=false;while(a<=t.byteLength){if(t[n]===of&&(t[a]===of||a===t.byteLength)){s=t.subarray(n,a);o=nf.ts.parseType(s,i.pid);switch(o){case"pes":u=nf.ts.parsePesType(s,i.table);l=nf.ts.parsePayloadUnitStartIndicator(s);if(u==="audio"&&l){c=nf.ts.parsePesTime(s);if(c){c.type="audio";r.audio.push(c);f=true}}break;default:break}if(f){break}n+=sf;a+=sf;continue}n++;a++}a=t.byteLength;n=a-sf;f=false;while(n>=0){if(t[n]===of&&(t[a]===of||a===t.byteLength)){s=t.subarray(n,a);o=nf.ts.parseType(s,i.pid);switch(o){case"pes":u=nf.ts.parsePesType(s,i.table);l=nf.ts.parsePayloadUnitStartIndicator(s);if(u==="audio"&&l){c=nf.ts.parsePesTime(s);if(c){c.type="audio";r.audio.push(c);f=true}}break;default:break}if(f){break}n-=sf;a-=sf;continue}n--;a--}};var cf=function e(t,i,r){var n=0,a=sf,s,o,u,l,c,f,h,d;var p=false;var m={data:[],size:0};while(a<t.byteLength){if(t[n]===of&&t[a]===of){s=t.subarray(n,a);o=nf.ts.parseType(s,i.pid);switch(o){case"pes":u=nf.ts.parsePesType(s,i.table);l=nf.ts.parsePayloadUnitStartIndicator(s);if(u==="video"){if(l&&!p){c=nf.ts.parsePesTime(s);if(c){c.type="video";r.video.push(c);p=true}}if(!r.firstKeyFrame){if(l){if(m.size!==0){f=new Uint8Array(m.size);h=0;while(m.data.length){d=m.data.shift();f.set(d,h);h+=d.byteLength}if(nf.ts.videoPacketContainsKeyFrame(f)){r.firstKeyFrame=nf.ts.parsePesTime(f);r.firstKeyFrame.type="video"}m.size=0}}m.data.push(s);m.size+=s.byteLength}}break;default:break}if(p&&r.firstKeyFrame){break}n+=sf;a+=sf;continue}n++;a++}a=t.byteLength;n=a-sf;p=false;while(n>=0){if(t[n]===of&&t[a]===of){s=t.subarray(n,a);o=nf.ts.parseType(s,i.pid);switch(o){case"pes":u=nf.ts.parsePesType(s,i.table);l=nf.ts.parsePayloadUnitStartIndicator(s);if(u==="video"&&l){c=nf.ts.parsePesTime(s);if(c){c.type="video";r.video.push(c);p=true}}break;default:break}if(p){break}n-=sf;a-=sf;continue}n--;a--}};var ff=function e(t,i){if(t.audio&&t.audio.length){var r=i;if(typeof r==="undefined"){r=t.audio[0].dts}t.audio.forEach(function(e){e.dts=rf(e.dts,r);e.pts=rf(e.pts,r);e.dtsTime=e.dts/af;e.ptsTime=e.pts/af})}if(t.video&&t.video.length){var n=i;if(typeof n==="undefined"){n=t.video[0].dts}t.video.forEach(function(e){e.dts=rf(e.dts,n);e.pts=rf(e.pts,n);e.dtsTime=e.dts/af;e.ptsTime=e.pts/af});if(t.firstKeyFrame){var a=t.firstKeyFrame;a.dts=rf(a.dts,n);a.pts=rf(a.pts,n);a.dtsTime=a.dts/af;a.ptsTime=a.dts/af}}};var hf=function e(t){var i=false,r=0,n=null,a=null,s=0,o=0,u;while(t.length-o>=3){var l=nf.aac.parseType(t,o);switch(l){case"timed-metadata":if(t.length-o<10){i=true;break}s=nf.aac.parseId3TagSize(t,o);if(s>t.length){i=true;break}if(a===null){u=t.subarray(o,o+s);a=nf.aac.parseAacTimestamp(u)}o+=s;break;case"audio":if(t.length-o<7){i=true;break}s=nf.aac.parseAdtsSize(t,o);if(s>t.length){i=true;break}if(n===null){u=t.subarray(o,o+s);n=nf.aac.parseSampleRate(u)}r++;o+=s;break;default:o++;break}if(i){return null}}if(n===null||a===null){return null}var c=af/n;var f={audio:[{type:"audio",dts:a,pts:a},{type:"audio",dts:a+r*1024*c,pts:a+r*1024*c}]};return f};var df=function e(t){var i={pid:null,table:null};var r={};uf(t,i);for(var n in i.table){if(i.table.hasOwnProperty(n)){var a=i.table[n];switch(a){case El.H264_STREAM_TYPE:r.video=[];cf(t,i,r);if(r.video.length===0){delete r.video}break;case El.ADTS_STREAM_TYPE:r.audio=[];lf(t,i,r);if(r.audio.length===0){delete r.audio}break;default:break}}}return r};var pf=function e(t,i){var r=nf.aac.isLikelyAacData(t);var n;if(r){n=hf(t)}else{n=df(t)}if(!n||!n.audio&&!n.video){return null}ff(n,i);return n};var mf={inspect:pf,parseAudioPes_:lf};function vf(e){return e.subarray(0,e.byteLength-e[e.byteLength-1])}var gf=function e(t,i){if(!(t instanceof i)){throw new TypeError("Cannot call a class as a function")}};var yf=function(){function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(e,t,i){if(t)r(e.prototype,t);if(i)r(e,i);return e}}();var _f=function e(t,i){if(typeof i!=="function"&&i!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof i)}t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:false,writable:true,configurable:true}});if(i)Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i};var bf=function e(t,i){if(!t){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return i&&(typeof i==="object"||typeof i==="function")?i:t};var Tf=function e(){var t=[[[],[],[],[],[]],[[],[],[],[],[]]];var i=t[0];var r=t[1];var n=i[4];var a=r[4];var s=void 0;var o=void 0;var u=void 0;var l=[];var c=[];var f=void 0;var h=void 0;var d=void 0;var p=void 0;var m=void 0;var v=void 0;for(s=0;s<256;s++){c[(l[s]=s<<1^(s>>7)*283)^s]=s}for(o=u=0;!n[o];o^=f||1,u=c[u]||1){p=u^u<<1^u<<2^u<<3^u<<4;p=p>>8^p&255^99;n[o]=p;a[p]=o;d=l[h=l[f=l[o]]];v=d*16843009^h*65537^f*257^o*16843008;m=l[p]*257^p*16843008;for(s=0;s<4;s++){i[s][o]=m=m<<24^m>>>8;r[s][p]=v=v<<24^v>>>8}}for(s=0;s<5;s++){i[s]=i[s].slice(0);r[s]=r[s].slice(0)}return t};var Sf=null;var kf=function(){function c(e){gf(this,c);if(!Sf){Sf=Tf()}this._tables=[[Sf[0][0].slice(),Sf[0][1].slice(),Sf[0][2].slice(),Sf[0][3].slice(),Sf[0][4].slice()],[Sf[1][0].slice(),Sf[1][1].slice(),Sf[1][2].slice(),Sf[1][3].slice(),Sf[1][4].slice()]];var t=void 0;var i=void 0;var r=void 0;var n=void 0;var a=void 0;var s=this._tables[0][4];var o=this._tables[1];var u=e.length;var l=1;if(u!==4&&u!==6&&u!==8){throw new Error("Invalid aes key size")}n=e.slice(0);a=[];this._key=[n,a];for(t=u;t<4*u+28;t++){r=n[t-1];if(t%u===0||u===8&&t%u===4){r=s[r>>>24]<<24^s[r>>16&255]<<16^s[r>>8&255]<<8^s[r&255];if(t%u===0){r=r<<8^r>>>24^l<<24;l=l<<1^(l>>7)*283}}n[t]=n[t-u]^r}for(i=0;t;i++,t--){r=n[i&3?t:t-4];if(t<=4||i<4){a[i]=r}else{a[i]=o[0][s[r>>>24]]^o[1][s[r>>16&255]]^o[2][s[r>>8&255]]^o[3][s[r&255]]}}}c.prototype.decrypt=function e(t,i,r,n,a,s){var o=this._key[1];var u=t^o[0];var l=n^o[1];var c=r^o[2];var f=i^o[3];var h=void 0;var d=void 0;var p=void 0;var m=o.length/4-2;var v=void 0;var g=4;var y=this._tables[1];var _=y[0];var b=y[1];var T=y[2];var S=y[3];var k=y[4];for(v=0;v<m;v++){h=_[u>>>24]^b[l>>16&255]^T[c>>8&255]^S[f&255]^o[g];d=_[l>>>24]^b[c>>16&255]^T[f>>8&255]^S[u&255]^o[g+1];p=_[c>>>24]^b[f>>16&255]^T[u>>8&255]^S[l&255]^o[g+2];f=_[f>>>24]^b[u>>16&255]^T[l>>8&255]^S[c&255]^o[g+3];g+=4;u=h;l=d;c=p}for(v=0;v<4;v++){a[(3&-v)+s]=k[u>>>24]<<24^k[l>>16&255]<<16^k[c>>8&255]<<8^k[f&255]^o[g++];h=u;u=l;l=c;c=f;f=h}};return c}();var wf=function(){function e(){gf(this,e);this.listeners={}}e.prototype.on=function e(t,i){if(!this.listeners[t]){this.listeners[t]=[]}this.listeners[t].push(i)};e.prototype.off=function e(t,i){if(!this.listeners[t]){return false}var r=this.listeners[t].indexOf(i);this.listeners[t].splice(r,1);return r>-1};e.prototype.trigger=function e(t){var i=this.listeners[t];if(!i){return}if(arguments.length===2){var r=i.length;for(var n=0;n<r;++n){i[n].call(this,arguments[1])}}else{var a=Array.prototype.slice.call(arguments,1);var s=i.length;for(var o=0;o<s;++o){i[o].apply(this,a)}}};e.prototype.dispose=function e(){this.listeners={}};e.prototype.pipe=function e(t){this.on("data",function(e){t.push(e)})};return e}();var Cf=function(t){_f(i,t);function i(){gf(this,i);var e=bf(this,t.call(this,wf));e.jobs=[];e.delay=1;e.timeout_=null;return e}i.prototype.processJob_=function e(){this.jobs.shift()();if(this.jobs.length){this.timeout_=setTimeout(this.processJob_.bind(this),this.delay)}else{this.timeout_=null}};i.prototype.push=function e(t){this.jobs.push(t);if(!this.timeout_){this.timeout_=setTimeout(this.processJob_.bind(this),this.delay)}};return i}(wf);var Ef=function e(t){return t<<24|(t&65280)<<8|(t&16711680)>>8|t>>>24};var Af=function e(t,i,r){var n=new Int32Array(t.buffer,t.byteOffset,t.byteLength>>2);var a=new kf(Array.prototype.slice.call(i));var s=new Uint8Array(t.byteLength);var o=new Int32Array(s.buffer);var u=void 0;var l=void 0;var c=void 0;var f=void 0;var h=void 0;var d=void 0;var p=void 0;var m=void 0;var v=void 0;u=r[0];l=r[1];c=r[2];f=r[3];for(v=0;v<n.length;v+=4){h=Ef(n[v]);d=Ef(n[v+1]);p=Ef(n[v+2]);m=Ef(n[v+3]);a.decrypt(h,d,p,m,o,v);o[v]=Ef(o[v]^u);o[v+1]=Ef(o[v+1]^l);o[v+2]=Ef(o[v+2]^c);o[v+3]=Ef(o[v+3]^f);u=h;l=d;c=p;f=m}return s};var Lf=function(){function u(e,t,i,r){gf(this,u);var n=u.STEP;var a=new Int32Array(e.buffer);var s=new Uint8Array(e.byteLength);var o=0;this.asyncStream_=new Cf;this.asyncStream_.push(this.decryptChunk_(a.subarray(o,o+n),t,i,s));for(o=n;o<a.length;o+=n){i=new Uint32Array([Ef(a[o-4]),Ef(a[o-3]),Ef(a[o-2]),Ef(a[o-1])]);this.asyncStream_.push(this.decryptChunk_(a.subarray(o,o+n),t,i,s))}this.asyncStream_.push(function(){r(null,vf(s))})}u.prototype.decryptChunk_=function e(t,i,r,n){return function(){var e=Af(t,i,r);n.set(e,t.byteOffset)}};yf(u,null,[{key:"STEP",get:function e(){return 32e3}}]);return u}();var If=function e(t,i){if(/^[a-z]+:/i.test(i)){return i}if(!/\/\//i.test(t)){t=ws.buildAbsoluteURL(_.location.href,t)}return ws.buildAbsoluteURL(t,i)};var Of=function e(t,i){if(!(t instanceof i)){throw new TypeError("Cannot call a class as a function")}};var Pf=function(){function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(e,t,i){if(t)r(e.prototype,t);if(i)r(e,i);return e}}();var Uf=function e(t,i,r){if(t===null)t=Function.prototype;var n=Object.getOwnPropertyDescriptor(t,i);if(n===undefined){var a=Object.getPrototypeOf(t);if(a===null){return undefined}else{return e(a,i,r)}}else if("value"in n){return n.value}else{var s=n.get;if(s===undefined){return undefined}return s.call(r)}};var Df=function e(t,i){if(typeof i!=="function"&&i!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof i)}t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:false,writable:true,configurable:true}});if(i)Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i};var xf=function e(t,i){if(!t){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return i&&(typeof i==="object"||typeof i==="function")?i:t};var Rf=function(){function i(e,t){var i=[];var r=true;var n=false;var a=undefined;try{for(var s=e[Symbol.iterator](),o;!(r=(o=s.next()).done);r=true){i.push(o.value);if(t&&i.length===t)break}}catch(e){n=true;a=e}finally{try{if(!r&&s["return"])s["return"]()}finally{if(n)throw a}}return i}return function(e,t){if(Array.isArray(e)){return e}else if(Symbol.iterator in Object(e)){return i(e,t)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var Mf=Ts.mergeOptions,Bf=Ts.EventTarget,Nf=Ts.log;var jf=function e(n,a){["AUDIO","SUBTITLES"].forEach(function(e){for(var t in n.mediaGroups[e]){for(var i in n.mediaGroups[e][t]){var r=n.mediaGroups[e][t][i];a(r,e,t,i)}}})};var Ff=function e(t,i,r){var n=i.slice();r=r||0;var a=Math.min(t.length,i.length+r);for(var s=r;s<a;s++){n[s-r]=Mf(t[s],n[s-r])}return n};var Vf=function e(t,i){if(!t.resolvedUri){t.resolvedUri=If(i,t.uri)}if(t.key&&!t.key.resolvedUri){t.key.resolvedUri=If(i,t.key.uri)}if(t.map&&!t.map.resolvedUri){t.map.resolvedUri=If(i,t.map.uri)}};var Hf=function e(t,i){var r=Mf(t,{});var n=r.playlists[i.uri];if(!n){return null}if(n.segments&&i.segments&&n.segments.length===i.segments.length&&n.mediaSequence===i.mediaSequence){return null}var a=Mf(n,i);if(n.segments){a.segments=Ff(n.segments,i.segments,i.mediaSequence-n.mediaSequence)}a.segments.forEach(function(e){Vf(e,a.resolvedUri)});for(var s=0;s<r.playlists.length;s++){if(r.playlists[s].uri===i.uri){r.playlists[s]=a}}r.playlists[i.uri]=a;return r};var qf=function e(t){var i=t.playlists.length;while(i--){var r=t.playlists[i];t.playlists[r.uri]=r;r.resolvedUri=If(t.uri,r.uri);r.id=i;if(!r.attributes){r.attributes={};Nf.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}}};var zf=function e(t){jf(t,function(e){if(e.uri){e.resolvedUri=If(t.uri,e.uri)}})};var Wf=function e(t,i){var r=t.segments[t.segments.length-1];var n=void 0;if(i&&r&&r.duration){n=r.duration*1e3}else{n=(t.targetDuration||10)*500}return n};var Gf=function(e){Df(n,e);function n(e,t,i){Of(this,n);var r=xf(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));r.srcUrl=e;r.hls_=t;r.withCredentials=i;if(!r.srcUrl){throw new Error("A non-empty playlist URL is required")}r.state="HAVE_NOTHING";r.on("mediaupdatetimeout",function(){if(r.state!=="HAVE_METADATA"){return}r.state="HAVE_CURRENT_METADATA";r.request=r.hls_.xhr({uri:If(r.master.uri,r.media().uri),withCredentials:r.withCredentials},function(e,t){if(!r.request){return}if(e){return r.playlistRequestError(r.request,r.media().uri,"HAVE_METADATA")}r.haveMetadata(r.request,r.media().uri)})});return r}Pf(n,[{key:"playlistRequestError",value:function e(t,i,r){this.request=null;if(r){this.state=r}this.error={playlist:this.master.playlists[i],status:t.status,message:"HLS playlist request error at URL: "+i,responseText:t.responseText,code:t.status>=500?4:2};this.trigger("error")}},{key:"haveMetadata",value:function e(t,i){var r=this;this.request=null;this.state="HAVE_METADATA";var n=new xs;n.push(t.responseText);n.end();n.manifest.uri=i;n.manifest.attributes=n.manifest.attributes||{};var a=Hf(this.master,n.manifest);this.targetDuration=n.manifest.targetDuration;if(a){this.master=a;this.media_=this.master.playlists[n.manifest.uri]}else{this.trigger("playlistunchanged")}if(!this.media().endList){_.clearTimeout(this.mediaUpdateTimeout);this.mediaUpdateTimeout=_.setTimeout(function(){r.trigger("mediaupdatetimeout")},Wf(this.media(),!!a))}this.trigger("loadedplaylist")}},{key:"dispose",value:function e(){this.stopRequest();_.clearTimeout(this.mediaUpdateTimeout)}},{key:"stopRequest",value:function e(){if(this.request){var t=this.request;this.request=null;t.onreadystatechange=null;t.abort()}}},{key:"media",value:function e(i){var r=this;if(!i){return this.media_}if(this.state==="HAVE_NOTHING"){throw new Error("Cannot switch media playlist from "+this.state)}var n=this.state;if(typeof i==="string"){if(!this.master.playlists[i]){throw new Error("Unknown playlist URI: "+i)}i=this.master.playlists[i]}var t=!this.media_||i.uri!==this.media_.uri;if(this.master.playlists[i.uri].endList){if(this.request){this.request.onreadystatechange=null;this.request.abort();this.request=null}this.state="HAVE_METADATA";this.media_=i;if(t){this.trigger("mediachanging");this.trigger("mediachange")}return}if(!t){return}this.state="SWITCHING_MEDIA";if(this.request){if(If(this.master.uri,i.uri)===this.request.url){return}this.request.onreadystatechange=null;this.request.abort();this.request=null}if(this.media_){this.trigger("mediachanging")}this.request=this.hls_.xhr({uri:If(this.master.uri,i.uri),withCredentials:this.withCredentials},function(e,t){if(!r.request){return}if(e){return r.playlistRequestError(r.request,i.uri,n)}r.haveMetadata(t,i.uri);if(n==="HAVE_MASTER"){r.trigger("loadedmetadata")}else{r.trigger("mediachange")}})}},{key:"pause",value:function e(){this.stopRequest();_.clearTimeout(this.mediaUpdateTimeout);if(this.state==="HAVE_NOTHING"){this.started=false}if(this.state==="SWITCHING_MEDIA"){if(this.media_){this.state="HAVE_METADATA"}else{this.state="HAVE_MASTER"}}else if(this.state==="HAVE_CURRENT_METADATA"){this.state="HAVE_METADATA"}}},{key:"load",value:function e(t){var i=this;_.clearTimeout(this.mediaUpdateTimeout);var r=this.media();if(t){var n=r?r.targetDuration/2*1e3:5*1e3;this.mediaUpdateTimeout=_.setTimeout(function(){return i.load()},n);return}if(!this.started){this.start();return}if(r&&!r.endList){this.trigger("mediaupdatetimeout")}else{this.trigger("loadedplaylist")}}},{key:"start",value:function e(){var r=this;this.started=true;this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(e,t){if(!r.request){return}r.request=null;if(e){r.error={status:t.status,message:"HLS playlist request error at URL: "+r.srcUrl,responseText:t.responseText,code:2};if(r.state==="HAVE_NOTHING"){r.started=false}return r.trigger("error")}var i=new xs;i.push(t.responseText);i.end();r.state="HAVE_MASTER";i.manifest.uri=r.srcUrl;if(i.manifest.playlists){r.master=i.manifest;qf(r.master);zf(r.master);r.trigger("loadedplaylist");if(!r.request){r.media(i.manifest.playlists[0])}return}r.master={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:_.location.href,playlists:[{uri:r.srcUrl,id:0}]};r.master.playlists[r.srcUrl]=r.master.playlists[0];r.master.playlists[0].resolvedUri=r.srcUrl;r.master.playlists[0].attributes=r.master.playlists[0].attributes||{};r.haveMetadata(t,r.srcUrl);return r.trigger("loadedmetadata")})}}]);return n}(Bf);var Xf=Ts.createTimeRange;var Yf=function e(t,i){var r=0;var n=i-t.mediaSequence;var a=t.segments[n];if(a){if(typeof a.start!=="undefined"){return{result:a.start,precise:true}}if(typeof a.end!=="undefined"){return{result:a.end-a.duration,precise:true}}}while(n--){a=t.segments[n];if(typeof a.end!=="undefined"){return{result:r+a.end,precise:true}}r+=a.duration;if(typeof a.start!=="undefined"){return{result:r+a.start,precise:true}}}return{result:r,precise:false}};var $f=function e(t,i){var r=0;var n=void 0;var a=i-t.mediaSequence;for(;a<t.segments.length;a++){n=t.segments[a];if(typeof n.start!=="undefined"){return{result:n.start-r,precise:true}}r+=n.duration;if(typeof n.end!=="undefined"){return{result:n.end-r,precise:true}}}return{result:-1,precise:false}};var Kf=function e(t,i,r){var n=void 0;var a=void 0;if(typeof i==="undefined"){i=t.mediaSequence+t.segments.length}if(i<t.mediaSequence){return 0}n=Yf(t,i);if(n.precise){return n.result}a=$f(t,i);if(a.precise){return a.result}return n.result+r};var Jf=function e(t,i,r){if(!t){return 0}if(typeof r!=="number"){r=0}if(typeof i==="undefined"){if(t.totalDuration){return t.totalDuration}if(!t.endList){return _.Infinity}}return Kf(t,i,r)};var Qf=function e(t,i,r){var n=0;if(i>r){var a=[r,i];i=a[0];r=a[1]}if(i<0){for(var s=i;s<Math.min(0,r);s++){n+=t.targetDuration}i=0}for(var o=i;o<r;o++){n+=t.segments[o].duration}return n};var Zf=function e(t){if(!t.segments.length){return 0}var i=t.segments.length-1;var r=t.segments[i].duration||t.targetDuration;var n=r+t.targetDuration*2;while(i--){r+=t.segments[i].duration;if(r>=n){break}}return Math.max(0,i)};var eh=function e(t,i,r){if(!t||!t.segments){return null}if(t.endList){return Jf(t)}if(i===null){return null}i=i||0;var n=r?Zf(t):t.segments.length;return Kf(t,t.mediaSequence+n,i)};var th=function e(t,i){var r=true;var n=i||0;var a=eh(t,i,r);if(a===null){return Xf()}return Xf(n,a)};var ih=function e(t){return t-Math.floor(t)===0};var rh=function e(t,i){if(ih(i)){return i+t*.1}var r=i.toString().split(".")[1].length;for(var n=1;n<=r;n++){var a=Math.pow(10,n);var s=i*a;if(ih(s)||n===r){return(s+t)/a}}};var nh=rh.bind(null,1);var ah=rh.bind(null,-1);var sh=function e(t,i,r,n){var a=void 0;var s=void 0;var o=t.segments.length;var u=i-n;if(u<0){if(r>0){for(a=r-1;a>=0;a--){s=t.segments[a];u+=ah(s.duration);if(u>0){return{mediaIndex:a,startTime:n-Qf(t,r,a)}}}}return{mediaIndex:0,startTime:i}}if(r<0){for(a=r;a<0;a++){u-=t.targetDuration;if(u<0){return{mediaIndex:0,startTime:i}}}r=0}for(a=r;a<o;a++){s=t.segments[a];u-=nh(s.duration);if(u<0){return{mediaIndex:a,startTime:n+Qf(t,r,a)}}}return{mediaIndex:o-1,startTime:i}};var oh=function e(t){return t.excludeUntil&&t.excludeUntil>Date.now()};var uh=function e(t){return t.excludeUntil&&t.excludeUntil===Infinity};var lh=function e(t){var i=oh(t);return!t.disabled&&!i};var ch=function e(t){return t.disabled};var fh=function e(t){for(var i=0;i<t.segments.length;i++){if(t.segments[i].key){return true}}return false};var hh=function e(t){for(var i=0;i<t.segments.length;i++){if(t.segments[i].map){return true}}return false};var dh=function e(t,i){return i.attributes&&i.attributes[t]};var ph=function e(t,i,r){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;if(!dh("BANDWIDTH",r)){return NaN}var a=t*r.attributes.BANDWIDTH;return(a-n*8)/i};var mh=function e(t,i){if(t.playlists.length===1){return true}var r=i.attributes.BANDWIDTH||Number.MAX_VALUE;return t.playlists.filter(function(e){if(!lh(e)){return false}return(e.attributes.BANDWIDTH||0)<r}).length===0};var vh={duration:Jf,seekable:th,safeLiveIndex:Zf,getMediaInfoForTime:sh,isEnabled:lh,isDisabled:ch,isBlacklisted:oh,isIncompatible:uh,playlistEnd:eh,isAes:fh,isFmp4:hh,hasAttribute:dh,estimateSegmentRequestTime:ph,isLowestEnabledRendition:mh};var gh=Ts.xhr,yh=Ts.mergeOptions;var _h=function e(){var t=function e(t,r){t=yh({timeout:45e3},t);var i=e.beforeRequest||Ts.Hls.xhr.beforeRequest;if(i&&typeof i==="function"){var n=i(t);if(n){t=n}}var a=gh(t,function(e,t){var i=a.response;if(!e&&i){a.responseTime=Date.now();a.roundTripTime=a.responseTime-a.requestTime;a.bytesReceived=i.byteLength||i.length;if(!a.bandwidth){a.bandwidth=Math.floor(a.bytesReceived/a.roundTripTime*8*1e3)}}if(t.headers){a.responseHeaders=t.headers}if(e&&e.code==="ETIMEDOUT"){a.timedout=true}if(!e&&!a.aborted&&t.statusCode!==200&&t.statusCode!==206&&t.statusCode!==0){e=new Error("XHR Failed with a response of: "+(a&&(i||a.responseText)))}r(e,a)});var s=a.abort;a.abort=function(){a.aborted=true;return s.apply(a,arguments)};a.uri=t.uri;a.requestTime=Date.now();return a};return t};var bh=function e(t,i){return t.start(i)+"-"+t.end(i)};var Th=function e(t,i){var r=t.toString(16);return"00".substring(0,2-r.length)+r+(i%2?" ":"")};var Sh=function e(t){if(t>=32&&t<126){return String.fromCharCode(t)}return"."};var kh=function e(i){var r={};Object.keys(i).forEach(function(e){var t=i[e];if(ArrayBuffer.isView(t)){r[e]={bytes:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength}}else{r[e]=t}});return r};var wh=function e(t){var i=t.byterange||{length:Infinity,offset:0};return[i.length,i.offset,t.resolvedUri].join(",")};var Ch=function e(t){var i=Array.prototype.slice.call(t);var r=16;var n="";var a=void 0;var s=void 0;for(var o=0;o<i.length/r;o++){a=i.slice(o*r,o*r+r).map(Th).join("");s=i.slice(o*r,o*r+r).map(Sh).join("");n+=a+" "+s+"\n"}return n};var Eh=function e(t){var i=t.bytes;return Ch(i)};var Ah=function e(t){var i="";var r=void 0;for(r=0;r<t.length;r++){i+=bh(t,r)+" "}return i};var Lh=Object.freeze({createTransferableMessage:kh,initSegmentId:wh,hexDump:Ch,tagDump:Eh,textRanges:Ah});var Ih=function e(t,i,r,n){var a=void 0;if(i==="stream"){a=new Date(n*1e3+r.getTime());var s=t.toISOString();var o=r.toISOString();var u=a.toISOString();return o<=s&&s<=u}else if(i==="player"){a=n+r;return r<=t&&t<=a}};var Oh=function e(t,i,r){if(!r.segments||r.segments.length===0){return null}if(i!=="player"&&i!=="stream"){return null}var n=0;for(var a=0;a<r.segments.length;a++){var s=r.segments[a];var o=n+s.duration;var u=void 0;var l=void 0;if(i==="player"){u=s.start;l=n}else{u=s.dateTimeObject;l=s.dateTimeObject}var c=typeof s.start!=="undefined"&&typeof s.end!=="undefined"&&Ih(t,i,u,s.end-s.start);var f=Ih(t,i,l,s.duration);if(c){return{segment:s,estimatedStart:l,type:"accurate"}}else if(f){return{segment:s,estimatedStart:l,type:"estimate"}}n=o}return null};var Ph=function e(t,i){return Oh(t,"player",i)};var Uh=function e(t,i){var r=void 0;try{r=new Date(t)}catch(e){return null}return Oh(r,"stream",i)};var Dh=function e(t,i){var r=void 0;var n=void 0;try{r=new Date(t);n=new Date(i)}catch(e){}var a=r.getTime();var s=n.getTime();return(s-a)/1e3};var xh=function e(t){if(!t.segments||t.segments.length===0){return false}for(var i=0;i<t.segments.length;i++){var r=t.segments[i];if(!r.dateTimeObject){return false}}return true};var Rh=function e(t){var i=t.playlist,r=t.time,n=r===undefined?undefined:r,a=t.callback;if(!a){throw new Error("getStreamTime: callback must be provided")}if(!i||n===undefined){return a({message:"getStreamTime: playlist and time must be provided"})}var s=Ph(n,i);if(!s){return a({message:"valid streamTime was not found"})}if(s.type==="estimate"){return a({message:"Accurate streamTime could not be determined. Please seek to e.seekTime and try again",seekTime:s.estimatedStart})}var o={mediaSeconds:n};if(s.segment.dateTimeObject){o.programDateTime=s.segment.dateTimeObject.toISOString()}return a(null,o)};var Mh=function e(t){var i=t.streamTime,r=t.playlist,n=t.retryCount,a=n===undefined?2:n,s=t.seekTo,o=t.pauseAfterSeek,u=o===undefined?true:o,l=t.tech,c=t.callback;if(!c){throw new Error("seekToStreamTime: callback must be provided")}if(typeof i==="undefined"||!r||!s){return c({message:"seekToStreamTime: streamTime, seekTo and playlist must be provided"})}if(!r.endList&&!l.hasStarted_){return c({message:"player must be playing a live stream to start buffering"})}if(!xh(r)){return c({message:"programDateTime tags must be provided in the manifest "+r.resolvedUri})}var f=Uh(i,r);if(!f){return c({message:i+" was not found in the stream"})}if(f.type==="estimate"){if(a===0){return c({message:i+" is not buffered yet. Try again"})}return e({streamTime:i,playlist:r,retryCount:a-1,seekTo:s,pauseAfterSeek:u,tech:l,callback:c})}var h=f.segment;var d=Dh(h.dateTimeObject,i);var p=h.start+d;var m=function e(){return c(null,l.currentTime())};l.one("seeked",m);if(u){l.pause()}s(p)};var Bh=1/30;var Nh=Bh*3;var jh=function e(t,i){var r=[];var n=void 0;if(t&&t.length){for(n=0;n<t.length;n++){if(i(t.start(n),t.end(n))){r.push([t.start(n),t.end(n)])}}}return Ts.createTimeRanges(r)};var Fh=function e(t,i){return jh(t,function(e,t){return e-Bh<=i&&t+Bh>=i})};var Vh=function e(t,i){return jh(t,function(e){return e-Bh>=i})};var Hh=function e(t){if(t.length<2){return Ts.createTimeRanges()}var i=[];for(var r=1;r<t.length;r++){var n=t.end(r-1);var a=t.start(r);i.push([n,a])}return Ts.createTimeRanges(i)};var qh=function e(t){var i=[];if(!t||!t.length){return""}for(var r=0;r<t.length;r++){i.push(t.start(r)+" => "+t.end(r))}return i.join(", ")};var zh=function e(t,i){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var n=t.length?t.end(t.length-1):0;return(n-i)/r};var Wh=function e(t){var i=[];for(var r=0;r<t.length;r++){i.push({start:t.start(r),end:t.end(r)})}return i};var Gh=function e(t,i,r){var n=i.player_;if(r.captions&&r.captions.length){if(!t.inbandTextTracks_){t.inbandTextTracks_={}}for(var a in r.captionStreams){if(!t.inbandTextTracks_[a]){n.tech_.trigger({type:"usage",name:"hls-608"});var s=n.textTracks().getTrackById(a);if(s){t.inbandTextTracks_[a]=s}else{t.inbandTextTracks_[a]=n.addRemoteTextTrack({kind:"captions",id:a,label:a},false).track}}}}if(r.metadata&&r.metadata.length&&!t.metadataTrack_){t.metadataTrack_=n.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},false).track;t.metadataTrack_.inBandMetadataTrackDispatchType=r.metadata.dispatchType}};var Xh=function e(t,i,r){var n=void 0;var a=void 0;if(!r){return}if(!r.cues){return}n=r.cues.length;while(n--){a=r.cues[n];if(a.startTime<=i&&a.endTime>=t){r.removeCue(a)}}};var Yh=function e(t){Object.defineProperties(t.frame,{id:{get:function e(){Ts.log.warn("cue.frame.id is deprecated. Use cue.value.key instead.");return t.value.key}},value:{get:function e(){Ts.log.warn("cue.frame.value is deprecated. Use cue.value.data instead.");return t.value.data}},privateData:{get:function e(){Ts.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead.");return t.value.data}}})};var $h=function e(t){var i=void 0;if(isNaN(t)||Math.abs(t)===Infinity){i=Number.MAX_VALUE}else{i=t}return i};var Kh=function e(t,i,r){var n=_.WebKitDataCue||_.VTTCue;if(i){i.forEach(function(e){var t=e.stream;this.inbandTextTracks_[t].addCue(new n(e.startTime+this.timestampOffset,e.endTime+this.timestampOffset,e.text))},t)}if(r){var a=$h(t.mediaSource_.duration);r.forEach(function(e){var i=e.cueTime+this.timestampOffset;e.frames.forEach(function(e){var t=new n(i,i,e.value||e.url||e.data||"");t.frame=e;t.value=e;Yh(t);this.metadataTrack_.addCue(t)},this)},t);if(t.metadataTrack_&&t.metadataTrack_.cues&&t.metadataTrack_.cues.length){var s=t.metadataTrack_.cues;var o=[];for(var u=0;u<s.length;u++){if(s[u]){o.push(s[u])}}var l=o.reduce(function(e,t){var i=e[t.startTime]||[];i.push(t);e[t.startTime]=i;return e},{});var c=Object.keys(l).sort(function(e,t){return Number(e)-Number(t)});c.forEach(function(e,t){var i=l[e];var r=Number(c[t+1])||a;i.forEach(function(e){e.endTime=r})})}}};var Jh=typeof window!=="undefined"?window:{},Qh=typeof Symbol==="undefined"?"__target":Symbol(),Zh="application/javascript",ed=Jh.BlobBuilder||Jh.WebKitBlobBuilder||Jh.MozBlobBuilder||Jh.MSBlobBuilder,td=Jh.URL||Jh.webkitURL||td&&td.msURL,id=Jh.Worker;function rd(s,o){return function e(t){var i=this;if(!o){return new id(s)}else if(id&&!t){var r=o.toString().replace(/^function.+?{/,"").slice(0,-1),n=od(r);this[Qh]=new id(n);ud(this[Qh],n);return this[Qh]}else{var a={postMessage:function e(t){if(i.onmessage){setTimeout(function(){i.onmessage({data:t,target:a})})}}};o.call(a);this.postMessage=function(e){setTimeout(function(){a.onmessage({data:e,target:i})})};this.isThisThread=true}}}if(id){var nd,ad=od("self.onmessage = function () {}"),sd=new Uint8Array(1);try{nd=new id(ad);nd.postMessage(sd,[sd.buffer])}catch(e){id=null}finally{td.revokeObjectURL(ad);if(nd){nd.terminate()}}}function od(t){try{return td.createObjectURL(new Blob([t],{type:Zh}))}catch(e){var i=new ed;i.append(t);return td.createObjectURL(i.getBlob(type))}}function ud(e,t){if(!e||!t)return;var i=e.terminate;e.objURL=t;e.terminate=function(){if(e.objURL)td.revokeObjectURL(e.objURL);i.call(e)}}var ld=new rd("./transmuxer-worker.worker.js",function(e,t){var pi=this;var i=function(){var l=Math.pow(2,32)-1;var c,i,n,a,e,s,r,t,o,u,f,h,d,p,m,v,g,y,_,b,T,S,k,w,C,E,A,L,I,O,P,U,D,x,R,M;(function(){var e;k={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]};if(typeof Uint8Array==="undefined"){return}for(e in k){if(k.hasOwnProperty(e)){k[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]}}w=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]);E=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]);C=new Uint8Array([0,0,0,1]);A=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);L=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);I={video:A,audio:L};U=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);P=new Uint8Array([0,0,0,0,0,0,0,0]);D=new Uint8Array([0,0,0,0,0,0,0,0]);x=D;R=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);M=D;O=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])})();c=function e(t){var i=[],r=0,n,a,s;for(n=1;n<arguments.length;n++){i.push(arguments[n])}n=i.length;while(n--){r+=i[n].byteLength}a=new Uint8Array(r+8);s=new DataView(a.buffer,a.byteOffset,a.byteLength);s.setUint32(0,a.byteLength);a.set(t,4);for(n=0,r=8;n<i.length;n++){a.set(i[n],r);r+=i[n].byteLength}return a};i=function e(){return c(k.dinf,c(k.dref,U))};n=function e(t){return c(k.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,t.audioobjecttype<<3|t.samplingfrequencyindex>>>1,t.samplingfrequencyindex<<7|t.channelcount<<3,6,1,2]))};a=function e(){return c(k.ftyp,w,C,w,E)};v=function e(t){return c(k.hdlr,I[t])};e=function e(t){return c(k.mdat,t)};m=function e(t){var i=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,t.duration>>>24&255,t.duration>>>16&255,t.duration>>>8&255,t.duration&255,85,196,0,0]);if(t.samplerate){i[12]=t.samplerate>>>24&255;i[13]=t.samplerate>>>16&255;i[14]=t.samplerate>>>8&255;i[15]=t.samplerate&255}return c(k.mdhd,i)};p=function e(t){return c(k.mdia,m(t),v(t.type),r(t))};s=function e(t){return c(k.mfhd,new Uint8Array([0,0,0,0,(t&4278190080)>>24,(t&16711680)>>16,(t&65280)>>8,t&255]))};r=function e(t){return c(k.minf,t.type==="video"?c(k.vmhd,O):c(k.smhd,P),i(),y(t))};t=function e(t,i){var r=[],n=i.length;while(n--){r[n]=b(i[n])}return c.apply(null,[k.moof,s(t)].concat(r))};o=function e(t){var i=t.length,r=[];while(i--){r[i]=h(t[i])}return c.apply(null,[k.moov,f(4294967295)].concat(r).concat(u(t)))};u=function e(t){var i=t.length,r=[];while(i--){r[i]=T(t[i])}return c.apply(null,[k.mvex].concat(r))};f=function e(t){var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(t&4278190080)>>24,(t&16711680)>>16,(t&65280)>>8,t&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return c(k.mvhd,i)};g=function e(t){var i=t.samples||[],r=new Uint8Array(4+i.length),n,a;for(a=0;a<i.length;a++){n=i[a].flags;r[a+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy}return c(k.sdtp,r)};y=function e(t){return c(k.stbl,_(t),c(k.stts,M),c(k.stsc,x),c(k.stsz,R),c(k.stco,D))};(function(){var i,r;_=function e(t){return c(k.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),t.type==="video"?i(t):r(t))};i=function e(t){var i=t.sps||[],r=t.pps||[],n=[],a=[],s;for(s=0;s<i.length;s++){n.push((i[s].byteLength&65280)>>>8);n.push(i[s].byteLength&255);n=n.concat(Array.prototype.slice.call(i[s]))}for(s=0;s<r.length;s++){a.push((r[s].byteLength&65280)>>>8);a.push(r[s].byteLength&255);a=a.concat(Array.prototype.slice.call(r[s]))}return c(k.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(t.width&65280)>>8,t.width&255,(t.height&65280)>>8,t.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),c(k.avcC,new Uint8Array([1,t.profileIdc,t.profileCompatibility,t.levelIdc,255].concat([i.length]).concat(n).concat([r.length]).concat(a))),c(k.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))};r=function e(t){return c(k.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(t.channelcount&65280)>>8,t.channelcount&255,(t.samplesize&65280)>>8,t.samplesize&255,0,0,0,0,(t.samplerate&65280)>>8,t.samplerate&255,0,0]),n(t))}})();d=function e(t){var i=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(t.id&4278190080)>>24,(t.id&16711680)>>16,(t.id&65280)>>8,t.id&255,0,0,0,0,(t.duration&4278190080)>>24,(t.duration&16711680)>>16,(t.duration&65280)>>8,t.duration&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(t.width&65280)>>8,t.width&255,0,0,(t.height&65280)>>8,t.height&255,0,0]);return c(k.tkhd,i)};b=function e(t){var i,r,n,a,s,o,u;i=c(k.tfhd,new Uint8Array([0,0,0,58,(t.id&4278190080)>>24,(t.id&16711680)>>16,(t.id&65280)>>8,t.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0]));o=Math.floor(t.baseMediaDecodeTime/(l+1));u=Math.floor(t.baseMediaDecodeTime%(l+1));r=c(k.tfdt,new Uint8Array([1,0,0,0,o>>>24&255,o>>>16&255,o>>>8&255,o&255,u>>>24&255,u>>>16&255,u>>>8&255,u&255]));s=32+20+8+16+8+8;if(t.type==="audio"){n=S(t,s);return c(k.traf,i,r,n)}a=g(t);n=S(t,a.length+s);return c(k.traf,i,r,n,a)};h=function e(t){t.duration=t.duration||4294967295;return c(k.trak,d(t),p(t))};T=function e(t){var i=new Uint8Array([0,0,0,0,(t.id&4278190080)>>24,(t.id&16711680)>>16,(t.id&65280)>>8,t.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);if(t.type!=="video"){i[i.length-1]=0}return c(k.trex,i)};(function(){var r,n,o;o=function e(t,i){var r=0,n=0,a=0,s=0;if(t.length){if(t[0].duration!==undefined){r=1}if(t[0].size!==undefined){n=2}if(t[0].flags!==undefined){a=4}if(t[0].compositionTimeOffset!==undefined){s=8}}return[0,0,r|n|a|s,1,(t.length&4278190080)>>>24,(t.length&16711680)>>>16,(t.length&65280)>>>8,t.length&255,(i&4278190080)>>>24,(i&16711680)>>>16,(i&65280)>>>8,i&255]};n=function e(t,i){var r,n,a,s;n=t.samples||[];i+=8+12+16*n.length;r=o(n,i);for(s=0;s<n.length;s++){a=n[s];r=r.concat([(a.duration&4278190080)>>>24,(a.duration&16711680)>>>16,(a.duration&65280)>>>8,a.duration&255,(a.size&4278190080)>>>24,(a.size&16711680)>>>16,(a.size&65280)>>>8,a.size&255,a.flags.isLeading<<2|a.flags.dependsOn,a.flags.isDependedOn<<6|a.flags.hasRedundancy<<4|a.flags.paddingValue<<1|a.flags.isNonSyncSample,a.flags.degradationPriority&240<<8,a.flags.degradationPriority&15,(a.compositionTimeOffset&4278190080)>>>24,(a.compositionTimeOffset&16711680)>>>16,(a.compositionTimeOffset&65280)>>>8,a.compositionTimeOffset&255])}return c(k.trun,new Uint8Array(r))};r=function e(t,i){var r,n,a,s;n=t.samples||[];i+=8+12+8*n.length;r=o(n,i);for(s=0;s<n.length;s++){a=n[s];r=r.concat([(a.duration&4278190080)>>>24,(a.duration&16711680)>>>16,(a.duration&65280)>>>8,a.duration&255,(a.size&4278190080)>>>24,(a.size&16711680)>>>16,(a.size&65280)>>>8,a.size&255])}return c(k.trun,new Uint8Array(r))};S=function e(t,i){if(t.type==="audio"){return r(t,i)}return n(t,i)}})();var B={ftyp:a,mdat:e,moof:t,moov:o,initSegment:function e(t){var i=a(),r=o(t),n;n=new Uint8Array(i.byteLength+r.byteLength);n.set(i);n.set(r,i.byteLength);return n}};var N=function e(t){return t>>>0};var j={toUnsigned:N};var F=j.toUnsigned;var V,H,q,z,W;V=function e(t,i){var r=[],n,a,s,o,u;if(!i.length){return null}for(n=0;n<t.byteLength;){a=F(t[n]<<24|t[n+1]<<16|t[n+2]<<8|t[n+3]);s=H(t.subarray(n+4,n+8));o=a>1?n+a:t.byteLength;if(s===i[0]){if(i.length===1){r.push(t.subarray(n+8,o))}else{u=V(t.subarray(n+8,o),i.slice(1));if(u.length){r=r.concat(u)}}}n=o}return r};H=function e(t){var i="";i+=String.fromCharCode(t[0]);i+=String.fromCharCode(t[1]);i+=String.fromCharCode(t[2]);i+=String.fromCharCode(t[3]);return i};q=function e(t){var i={},r=V(t,["moov","trak"]);return r.reduce(function(e,t){var i,r,n,a,s;i=V(t,["tkhd"])[0];if(!i){return null}r=i[0];n=r===0?12:20;a=F(i[n]<<24|i[n+1]<<16|i[n+2]<<8|i[n+3]);s=V(t,["mdia","mdhd"])[0];if(!s){return null}r=s[0];n=r===0?12:20;e[a]=F(s[n]<<24|s[n+1]<<16|s[n+2]<<8|s[n+3]);return e},i)};z=function e(a,t){var i,r,n;i=V(t,["moof","traf"]);r=[].concat.apply([],i.map(function(n){return V(n,["tfhd"]).map(function(e){var t,i,r;t=F(e[4]<<24|e[5]<<16|e[6]<<8|e[7]);i=a[t]||9e4;r=V(n,["tfdt"]).map(function(e){var t,i;t=e[0];i=F(e[4]<<24|e[5]<<16|e[6]<<8|e[7]);if(t===1){i*=Math.pow(2,32);i+=F(e[8]<<24|e[9]<<16|e[10]<<8|e[11])}return i})[0];r=r||Infinity;return r/i})}));n=Math.min.apply(null,r);return isFinite(n)?n:0};W=function e(t){var i=V(t,["moov","trak"]);var u=[];i.forEach(function(e){var t=V(e,["mdia","hdlr"]);var o=V(e,["tkhd"]);t.forEach(function(e,t){var i=H(e.subarray(8,12));var r=o[t];var n;var a;var s;if(i==="vide"){n=new DataView(r.buffer,r.byteOffset,r.byteLength);a=n.getUint8(0);s=a===0?n.getUint32(12):n.getUint32(20);u.push(s)}})});return u};var G={findBox:V,parseType:H,timescale:q,startTime:z,videoTrackIds:W};var X=function e(){this.init=function(){var a={};this.on=function(e,t){if(!a[e]){a[e]=[]}a[e]=a[e].concat(t)};this.off=function(e,t){var i;if(!a[e]){return false}i=a[e].indexOf(t);a[e]=a[e].slice();a[e].splice(i,1);return i>-1};this.trigger=function(e){var t,i,r,n;t=a[e];if(!t){return}if(arguments.length===2){r=t.length;for(i=0;i<r;++i){t[i].call(this,arguments[1])}}else{n=[];i=arguments.length;for(i=1;i<arguments.length;++i){n.push(arguments[i])}r=t.length;for(i=0;i<r;++i){t[i].apply(this,n)}}};this.dispose=function(){a={}}}};X.prototype.pipe=function(t){this.on("data",function(e){t.push(e)});this.on("done",function(e){t.flush(e)});return t};X.prototype.push=function(e){this.trigger("data",e)};X.prototype.flush=function(e){this.trigger("done",e)};var Y=X;var $=function e(t){var i,r,n=[],a=[];n.byteLength=0;for(i=0;i<t.length;i++){r=t[i];if(r.nalUnitType==="access_unit_delimiter_rbsp"){if(n.length){n.duration=r.dts-n.dts;a.push(n)}n=[r];n.byteLength=r.data.byteLength;n.pts=r.pts;n.dts=r.dts}else{if(r.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"){n.keyFrame=true}n.duration=r.dts-n.dts;n.byteLength+=r.data.byteLength;n.push(r)}}if(a.length&&(!n.duration||n.duration<=0)){n.duration=a[a.length-1].duration}a.push(n);return a};var K=function e(t){var i,r,n=[],a=[];n.byteLength=0;n.nalCount=0;n.duration=0;n.pts=t[0].pts;n.dts=t[0].dts;a.byteLength=0;a.nalCount=0;a.duration=0;a.pts=t[0].pts;a.dts=t[0].dts;for(i=0;i<t.length;i++){r=t[i];if(r.keyFrame){if(n.length){a.push(n);a.byteLength+=n.byteLength;a.nalCount+=n.nalCount;a.duration+=n.duration}n=[r];n.nalCount=r.length;n.byteLength=r.byteLength;n.pts=r.pts;n.dts=r.dts;n.duration=r.duration}else{n.duration+=r.duration;n.nalCount+=r.length;n.byteLength+=r.byteLength;n.push(r)}}if(a.length&&n.duration<=0){n.duration=a[a.length-1].duration}a.byteLength+=n.byteLength;a.nalCount+=n.nalCount;a.duration+=n.duration;a.push(n);return a};var J=function e(t){var i;if(!t[0][0].keyFrame&&t.length>1){i=t.shift();t.byteLength-=i.byteLength;t.nalCount-=i.nalCount;t[0][0].dts=i.dts;t[0][0].pts=i.pts;t[0][0].duration+=i.duration}return t};var Q=function e(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}};var Z=function e(t,i){var r=Q();r.dataOffset=i;r.compositionTimeOffset=t.pts-t.dts;r.duration=t.duration;r.size=4*t.length;r.size+=t.byteLength;if(t.keyFrame){r.flags.dependsOn=2;r.flags.isNonSyncSample=0}return r};var ee=function e(t,i){var r,n,a,s,o,u=i||0,l=[];for(r=0;r<t.length;r++){s=t[r];for(n=0;n<s.length;n++){o=s[n];a=Z(o,u);u+=a.size;l.push(a)}}return l};var te=function e(t){var i,r,n,a,s,o,u=0,l=t.byteLength,c=t.nalCount,f=l+4*c,h=new Uint8Array(f),d=new DataView(h.buffer);for(i=0;i<t.length;i++){a=t[i];for(r=0;r<a.length;r++){s=a[r];for(n=0;n<s.length;n++){o=s[n];d.setUint32(u,o.data.byteLength);u+=4;h.set(o.data,u);u+=o.data.byteLength}}}return h};var ie={groupNalsIntoFrames:$,groupFramesIntoGops:K,extendFirstKeyFrame:J,generateSampleTable:ee,concatenateNalData:te};var re=[33,16,5,32,164,27];var ne=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252];var ae=function e(t){var i=[];while(t--){i.push(0)}return i};var se=function e(i){return Object.keys(i).reduce(function(e,t){e[t]=new Uint8Array(i[t].reduce(function(e,t){return e.concat(t)},[]));return e},{})};var oe={96e3:[re,[227,64],ae(154),[56]],88200:[re,[231],ae(170),[56]],64e3:[re,[248,192],ae(240),[56]],48e3:[re,[255,192],ae(268),[55,148,128],ae(54),[112]],44100:[re,[255,192],ae(268),[55,163,128],ae(84),[112]],32e3:[re,[255,192],ae(268),[55,234],ae(226),[112]],24e3:[re,[255,192],ae(268),[55,255,128],ae(268),[111,112],ae(126),[224]],16e3:[re,[255,192],ae(268),[55,255,128],ae(268),[111,255],ae(269),[223,108],ae(195),[1,192]],12e3:[ne,ae(268),[3,127,248],ae(268),[6,255,240],ae(268),[13,255,224],ae(268),[27,253,128],ae(259),[56]],11025:[ne,ae(268),[3,127,248],ae(268),[6,255,240],ae(268),[13,255,224],ae(268),[27,255,192],ae(268),[55,175,128],ae(108),[112]],8e3:[ne,ae(268),[3,121,16],ae(47),[7]]};var ue=se(oe);var le=9e4,ce,fe,he,de,pe,me;ce=function e(t){return t*le};fe=function e(t,i){return t*i};he=function e(t){return t/le};de=function e(t,i){return t/i};pe=function e(t,i){return ce(de(t,i))};me=function e(t,i){return fe(he(t),i)};var ve={secondsToVideoTs:ce,secondsToAudioTs:fe,videoTsToSeconds:he,audioTsToSeconds:de,audioTsToVideoTs:pe,videoTsToAudioTs:me};var ge=9e4;var ye=function e(t){var i,r,n=0;for(i=0;i<t.length;i++){r=t[i];n+=r.data.byteLength}return n};var _e=function e(t,i,r,n){var a,s=0,o=0,u=0,l=0,c,f;if(!i.length){return}a=ve.audioTsToVideoTs(t.baseMediaDecodeTime,t.samplerate);s=Math.ceil(ge/(t.samplerate/1024));if(r&&n){o=a-Math.max(r,n);u=Math.floor(o/s);l=u*s}if(u<1||l>ge/2){return}c=ue[t.samplerate];if(!c){c=i[0].data}for(f=0;f<u;f++){i.splice(f,0,{data:c})}t.baseMediaDecodeTime-=Math.floor(ve.videoTsToAudioTs(l,t.samplerate))};var be=function e(t,i,r){if(i.minSegmentDts>=r){return t}i.minSegmentDts=Infinity;return t.filter(function(e){if(e.dts>=r){i.minSegmentDts=Math.min(i.minSegmentDts,e.dts);i.minSegmentPts=i.minSegmentDts;return true}return false})};var Te=function e(t){var i,r,n=[];for(i=0;i<t.length;i++){r=t[i];n.push({size:r.data.byteLength,duration:1024})}return n};var Se=function e(t){var i,r,n=0,a=new Uint8Array(ye(t));for(i=0;i<t.length;i++){r=t[i];a.set(r.data,n);n+=r.data.byteLength}return a};var ke={prefixWithSilence:_e,trimAdtsFramesByEarliestDts:be,generateSampleTable:Te,concatenateFrameData:Se};var we=9e4;var Ce=function e(t,i){if(typeof i.pts==="number"){if(t.timelineStartInfo.pts===undefined){t.timelineStartInfo.pts=i.pts}if(t.minSegmentPts===undefined){t.minSegmentPts=i.pts}else{t.minSegmentPts=Math.min(t.minSegmentPts,i.pts)}if(t.maxSegmentPts===undefined){t.maxSegmentPts=i.pts}else{t.maxSegmentPts=Math.max(t.maxSegmentPts,i.pts)}}if(typeof i.dts==="number"){if(t.timelineStartInfo.dts===undefined){t.timelineStartInfo.dts=i.dts}if(t.minSegmentDts===undefined){t.minSegmentDts=i.dts}else{t.minSegmentDts=Math.min(t.minSegmentDts,i.dts)}if(t.maxSegmentDts===undefined){t.maxSegmentDts=i.dts}else{t.maxSegmentDts=Math.max(t.maxSegmentDts,i.dts)}}};var Ee=function e(t){delete t.minSegmentDts;delete t.maxSegmentDts;delete t.minSegmentPts;delete t.maxSegmentPts};var Ae=function e(t,i){var r,n,a=t.minSegmentDts;if(!i){a-=t.timelineStartInfo.dts}r=t.timelineStartInfo.baseMediaDecodeTime;r+=a;r=Math.max(0,r);if(t.type==="audio"){n=t.samplerate/we;r*=n;r=Math.floor(r)}return r};var Le={clearDtsInfo:Ee,calculateTrackBaseMediaDecodeTime:Ae,collectDtsInfo:Ce};var Ie=4,Oe=128;var Pe=function e(t){var i=0,r={payloadType:-1,payloadSize:0},n=0,a=0;while(i<t.byteLength){if(t[i]===Oe){break}while(t[i]===255){n+=255;i++}n+=t[i++];while(t[i]===255){a+=255;i++}a+=t[i++];if(!r.payload&&n===Ie){r.payloadType=n;r.payloadSize=a;r.payload=t.subarray(i,i+a);break}i+=a;n=0;a=0}return r};var Ue=function e(t){if(t.payload[0]!==181){return null}if((t.payload[1]<<8|t.payload[2])!==49){return null}if(String.fromCharCode(t.payload[3],t.payload[4],t.payload[5],t.payload[6])!=="GA94"){return null}if(t.payload[7]!==3){return null}return t.payload.subarray(8,t.payload.length-1)};var De=function e(t,i){var r=[],n,a,s,o;if(!(i[0]&64)){return r}a=i[0]&31;for(n=0;n<a;n++){s=n*3;o={type:i[s+2]&3,pts:t};if(i[s+2]&4){o.ccData=i[s+3]<<8|i[s+4];r.push(o)}}return r};var xe=function e(t){var i=t.byteLength,r=[],n=1,a,s;while(n<i-2){if(t[n]===0&&t[n+1]===0&&t[n+2]===3){r.push(n+2);n+=2}else{n++}}if(r.length===0){return t}a=i-r.length;s=new Uint8Array(a);var o=0;for(n=0;n<a;o++,n++){if(o===r[0]){o++;r.shift()}s[n]=t[o]}return s};var Re={parseSei:Pe,parseUserData:Ue,parseCaptionPackets:De,discardEmulationPreventionBytes:xe,USER_DATA_REGISTERED_ITU_T_T35:Ie};var Me=function e(){e.prototype.init.call(this);this.captionPackets_=[];this.ccStreams_=[new He(0,0),new He(0,1),new He(1,0),new He(1,1)];this.reset();this.ccStreams_.forEach(function(e){e.on("data",this.trigger.bind(this,"data"));e.on("done",this.trigger.bind(this,"done"))},this)};Me.prototype=new Y;Me.prototype.push=function(e){var t,i,r;if(e.nalUnitType!=="sei_rbsp"){return}t=Re.parseSei(e.escapedRBSP);if(t.payloadType!==Re.USER_DATA_REGISTERED_ITU_T_T35){return}i=Re.parseUserData(t);if(!i){return}if(e.dts<this.latestDts_){this.ignoreNextEqualDts_=true;return}else if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--;if(!this.numSameDts_){this.ignoreNextEqualDts_=false}return}r=Re.parseCaptionPackets(e.pts,i);this.captionPackets_=this.captionPackets_.concat(r);if(this.latestDts_!==e.dts){this.numSameDts_=0}this.numSameDts_++;this.latestDts_=e.dts};Me.prototype.flush=function(){if(!this.captionPackets_.length){this.ccStreams_.forEach(function(e){e.flush()},this);return}this.captionPackets_.forEach(function(e,t){e.presortIndex=t});this.captionPackets_.sort(function(e,t){if(e.pts===t.pts){return e.presortIndex-t.presortIndex}return e.pts-t.pts});this.captionPackets_.forEach(function(e){if(e.type<2){this.dispatchCea608Packet(e)}},this);this.captionPackets_.length=0;this.ccStreams_.forEach(function(e){e.flush()},this);return};Me.prototype.reset=function(){this.latestDts_=null;this.ignoreNextEqualDts_=false;this.numSameDts_=0;this.activeCea608Channel_=[null,null];this.ccStreams_.forEach(function(e){e.reset()})};Me.prototype.dispatchCea608Packet=function(e){if(this.setsChannel1Active(e)){this.activeCea608Channel_[e.type]=0}else if(this.setsChannel2Active(e)){this.activeCea608Channel_[e.type]=1}if(this.activeCea608Channel_[e.type]===null){return}this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)};Me.prototype.setsChannel1Active=function(e){return(e.ccData&30720)===4096};Me.prototype.setsChannel2Active=function(e){return(e.ccData&30720)===6144};var Be={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496};var Ne=function e(t){if(t===null){return""}t=Be[t]||t;return String.fromCharCode(t)};var je=14;var Fe=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152];var Ve=function e(){var t=[],i=je+1;while(i--){t.push("")}return t};var He=function e(t,i){e.prototype.init.call(this);this.field_=t||0;this.dataChannel_=i||0;this.name_="CC"+((this.field_<<1|this.dataChannel_)+1);this.setConstants();this.reset();this.push=function(e){var t,i,r,n,a;t=e.ccData&32639;if(t===this.lastControlCode_){this.lastControlCode_=null;return}if((t&61440)===4096){this.lastControlCode_=t}else if(t!==this.PADDING_){this.lastControlCode_=null}r=t>>>8;n=t&255;if(t===this.PADDING_){return}else if(t===this.RESUME_CAPTION_LOADING_){this.mode_="popOn"}else if(t===this.END_OF_CAPTION_){this.mode_="popOn";this.clearFormatting(e.pts);this.flushDisplayed(e.pts);i=this.displayed_;this.displayed_=this.nonDisplayed_;this.nonDisplayed_=i;this.startPts_=e.pts}else if(t===this.ROLL_UP_2_ROWS_){this.rollUpRows_=2;this.setRollUp(e.pts)}else if(t===this.ROLL_UP_3_ROWS_){this.rollUpRows_=3;this.setRollUp(e.pts)}else if(t===this.ROLL_UP_4_ROWS_){this.rollUpRows_=4;this.setRollUp(e.pts)}else if(t===this.CARRIAGE_RETURN_){this.clearFormatting(e.pts);this.flushDisplayed(e.pts);this.shiftRowsUp_();this.startPts_=e.pts}else if(t===this.BACKSPACE_){if(this.mode_==="popOn"){this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1)}else{this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1)}}else if(t===this.ERASE_DISPLAYED_MEMORY_){this.flushDisplayed(e.pts);this.displayed_=Ve()}else if(t===this.ERASE_NON_DISPLAYED_MEMORY_){this.nonDisplayed_=Ve()}else if(t===this.RESUME_DIRECT_CAPTIONING_){if(this.mode_!=="paintOn"){this.flushDisplayed(e.pts);this.displayed_=Ve()}this.mode_="paintOn";this.startPts_=e.pts}else if(this.isSpecialCharacter(r,n)){r=(r&3)<<8;a=Ne(r|n);this[this.mode_](e.pts,a);this.column_++}else if(this.isExtCharacter(r,n)){if(this.mode_==="popOn"){this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1)}else{this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1)}r=(r&3)<<8;a=Ne(r|n);this[this.mode_](e.pts,a);this.column_++}else if(this.isMidRowCode(r,n)){this.clearFormatting(e.pts);this[this.mode_](e.pts," ");this.column_++;if((n&14)===14){this.addFormatting(e.pts,["i"])}if((n&1)===1){this.addFormatting(e.pts,["u"])}}else if(this.isOffsetControlCode(r,n)){this.column_+=n&3}else if(this.isPAC(r,n)){var s=Fe.indexOf(t&7968);if(this.mode_==="rollUp"){if(s-this.rollUpRows_+1<0){s=this.rollUpRows_-1}this.setRollUp(e.pts,s)}if(s!==this.row_){this.clearFormatting(e.pts);this.row_=s}if(n&1&&this.formatting_.indexOf("u")===-1){this.addFormatting(e.pts,["u"])}if((t&16)===16){this.column_=((t&14)>>1)*4}if(this.isColorPAC(n)){if((n&14)===14){this.addFormatting(e.pts,["i"])}}}else if(this.isNormalChar(r)){if(n===0){n=null}a=Ne(r);a+=Ne(n);this[this.mode_](e.pts,a);this.column_+=a.length}}};He.prototype=new Y;He.prototype.flushDisplayed=function(e){var t=this.displayed_.map(function(e){try{return e.trim()}catch(e){console.error("Skipping malformed caption.");return""}}).join("\n").replace(/^\n+|\n+$/g,"");if(t.length){this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})}};He.prototype.reset=function(){this.mode_="popOn";this.topRow_=0;this.startPts_=0;this.displayed_=Ve();this.nonDisplayed_=Ve();this.lastControlCode_=null;this.column_=0;this.row_=je;this.rollUpRows_=2;this.formatting_=[]};He.prototype.setConstants=function(){if(this.dataChannel_===0){this.BASE_=16;this.EXT_=17;this.CONTROL_=(20|this.field_)<<8;this.OFFSET_=23}else if(this.dataChannel_===1){this.BASE_=24;this.EXT_=25;this.CONTROL_=(28|this.field_)<<8;this.OFFSET_=31}this.PADDING_=0;this.RESUME_CAPTION_LOADING_=this.CONTROL_|32;this.END_OF_CAPTION_=this.CONTROL_|47;this.ROLL_UP_2_ROWS_=this.CONTROL_|37;this.ROLL_UP_3_ROWS_=this.CONTROL_|38;this.ROLL_UP_4_ROWS_=this.CONTROL_|39;this.CARRIAGE_RETURN_=this.CONTROL_|45;this.RESUME_DIRECT_CAPTIONING_=this.CONTROL_|41;this.BACKSPACE_=this.CONTROL_|33;this.ERASE_DISPLAYED_MEMORY_=this.CONTROL_|44;this.ERASE_NON_DISPLAYED_MEMORY_=this.CONTROL_|46};He.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&t>=48&&t<=63};He.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&t>=32&&t<=63};He.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&t>=32&&t<=47};He.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&t>=33&&t<=35};He.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&t>=64&&t<=127};He.prototype.isColorPAC=function(e){return e>=64&&e<=79||e>=96&&e<=127};He.prototype.isNormalChar=function(e){return e>=32&&e<=127};He.prototype.setRollUp=function(e,t){if(this.mode_!=="rollUp"){this.row_=je;this.mode_="rollUp";this.flushDisplayed(e);this.nonDisplayed_=Ve();this.displayed_=Ve()}if(t!==undefined&&t!==this.row_){for(var i=0;i<this.rollUpRows_;i++){this.displayed_[t-i]=this.displayed_[this.row_-i];this.displayed_[this.row_-i]=""}}if(t===undefined){t=this.row_}this.topRow_=t-this.rollUpRows_+1};He.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var i=t.reduce(function(e,t){return e+"<"+t+">"},"");this[this.mode_](e,i)};He.prototype.clearFormatting=function(e){if(!this.formatting_.length){return}var t=this.formatting_.reverse().reduce(function(e,t){return e+"</"+t+">"},"");this.formatting_=[];this[this.mode_](e,t)};He.prototype.popOn=function(e,t){var i=this.nonDisplayed_[this.row_];i+=t;this.nonDisplayed_[this.row_]=i};He.prototype.rollUp=function(e,t){var i=this.displayed_[this.row_];i+=t;this.displayed_[this.row_]=i};He.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++){this.displayed_[e]=""}for(e=this.row_+1;e<je+1;e++){this.displayed_[e]=""}for(e=this.topRow_;e<this.row_;e++){this.displayed_[e]=this.displayed_[e+1]}this.displayed_[this.row_]=""};He.prototype.paintOn=function(e,t){var i=this.displayed_[this.row_];i+=t;this.displayed_[this.row_]=i};var qe={CaptionStream:Me,Cea608Stream:He};var ze={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21};var We=8589934592;var Ge=4294967296;var Xe=function e(t,i){var r=1;if(t>i){r=-1}while(Math.abs(i-t)>Ge){t+=r*We}return t};var Ye=function e(t){var i,r;e.prototype.init.call(this);this.type_=t;this.push=function(e){if(e.type!==this.type_){return}if(r===undefined){r=e.dts}e.dts=Xe(e.dts,r);e.pts=Xe(e.pts,r);i=e.dts;this.trigger("data",e)};this.flush=function(){r=i;this.trigger("done")};this.discontinuity=function(){r=void 0;i=void 0}};Ye.prototype=new Y;var $e={TimestampRolloverStream:Ye,handleRollover:Xe};var Ke=function e(t,i,r){var n,a="";for(n=i;n<r;n++){a+="%"+("00"+t[n].toString(16)).slice(-2)}return a},Je=function e(t,i,r){return decodeURIComponent(Ke(t,i,r))},Qe=function e(t,i,r){return unescape(Ke(t,i,r))},Ze=function e(t){return t[0]<<21|t[1]<<14|t[2]<<7|t[3]},et={TXXX:function e(t){var i;if(t.data[0]!==3){return}for(i=1;i<t.data.length;i++){if(t.data[i]===0){t.description=Je(t.data,1,i);t.value=Je(t.data,i+1,t.data.length).replace(/\0*$/,"");break}}t.data=t.value},WXXX:function e(t){var i;if(t.data[0]!==3){return}for(i=1;i<t.data.length;i++){if(t.data[i]===0){t.description=Je(t.data,1,i);t.url=Je(t.data,i+1,t.data.length);break}}},PRIV:function e(t){var i;for(i=0;i<t.data.length;i++){if(t.data[i]===0){t.owner=Qe(t.data,0,i);break}}t.privateData=t.data.subarray(i+1);t.data=t.privateData}},tt;tt=function e(t){var l={debug:!!(t&&t.debug),descriptor:t&&t.descriptor},c=0,f=[],h=0,i;tt.prototype.init.call(this);this.dispatchType=ze.METADATA_STREAM_TYPE.toString(16);if(l.descriptor){for(i=0;i<l.descriptor.length;i++){this.dispatchType+=("00"+l.descriptor[i].toString(16)).slice(-2)}}this.push=function(e){var t,i,r,n,a,s;if(e.type!=="timed-metadata"){return}if(e.dataAlignmentIndicator){h=0;f.length=0}if(f.length===0&&(e.data.length<10||e.data[0]!=="I".charCodeAt(0)||e.data[1]!=="D".charCodeAt(0)||e.data[2]!=="3".charCodeAt(0))){if(l.debug){console.log("Skipping unrecognized metadata packet")}return}f.push(e);h+=e.data.byteLength;if(f.length===1){c=Ze(e.data.subarray(6,10));c+=10}if(h<c){return}t={data:new Uint8Array(c),frames:[],pts:f[0].pts,dts:f[0].dts};for(a=0;a<c;){t.data.set(f[0].data.subarray(0,c-a),a);a+=f[0].data.byteLength;h-=f[0].data.byteLength;f.shift()}i=10;if(t.data[5]&64){i+=4;i+=Ze(t.data.subarray(10,14));c-=Ze(t.data.subarray(16,20))}do{r=Ze(t.data.subarray(i+4,i+8));if(r<1){return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.")}s=String.fromCharCode(t.data[i],t.data[i+1],t.data[i+2],t.data[i+3]);n={id:s,data:t.data.subarray(i+10,i+r+10)};n.key=n.id;if(et[n.id]){et[n.id](n);if(n.owner==="com.apple.streaming.transportStreamTimestamp"){var o=n.data,u=(o[3]&1)<<30|o[4]<<22|o[5]<<14|o[6]<<6|o[7]>>>2;u*=4;u+=o[7]&3;n.timeStamp=u;if(t.pts===undefined&&t.dts===undefined){t.pts=n.timeStamp;t.dts=n.timeStamp}this.trigger("timestamp",n)}}t.frames.push(n);i+=10;i+=r}while(i<c);this.trigger("data",t)}};tt.prototype=new Y;var it=tt;var rt=$e.TimestampRolloverStream;var nt,at,st;var ot=188,ut=71;nt=function e(){var n=new Uint8Array(ot),a=0;nt.prototype.init.call(this);this.push=function(e){var t=0,i=ot,r;if(a){r=new Uint8Array(e.byteLength+a);r.set(n.subarray(0,a));r.set(e,a);a=0}else{r=e}while(i<r.byteLength){if(r[t]===ut&&r[i]===ut){this.trigger("data",r.subarray(t,i));t+=ot;i+=ot;continue}t++;i++}if(t<r.byteLength){n.set(r.subarray(t),0);a=r.byteLength-t}};this.flush=function(){if(a===ot&&n[0]===ut){this.trigger("data",n);a=0}this.trigger("done")}};nt.prototype=new Y;at=function e(){var r,n,a,l;at.prototype.init.call(this);l=this;this.packetsWaitingForPmt=[];this.programMapTable=undefined;r=function e(t,i){var r=0;if(i.payloadUnitStartIndicator){r+=t[r]+1}if(i.type==="pat"){n(t.subarray(r),i)}else{a(t.subarray(r),i)}};n=function e(t,i){i.section_number=t[7];i.last_section_number=t[8];l.pmtPid=(t[10]&31)<<8|t[11];i.pmtPid=l.pmtPid};a=function e(t,i){var r,n,a,s;if(!(t[5]&1)){return}l.programMapTable={video:null,audio:null,"timed-metadata":{}};r=(t[1]&15)<<8|t[2];n=3+r-4;a=(t[10]&15)<<8|t[11];s=12+a;while(s<n){var o=t[s];var u=(t[s+1]&31)<<8|t[s+2];if(o===ze.H264_STREAM_TYPE&&l.programMapTable.video===null){l.programMapTable.video=u}else if(o===ze.ADTS_STREAM_TYPE&&l.programMapTable.audio===null){l.programMapTable.audio=u}else if(o===ze.METADATA_STREAM_TYPE){l.programMapTable["timed-metadata"][u]=o}s+=((t[s+3]&15)<<8|t[s+4])+5}i.programMapTable=l.programMapTable};this.push=function(e){var t={},i=4;t.payloadUnitStartIndicator=!!(e[1]&64);t.pid=e[1]&31;t.pid<<=8;t.pid|=e[2];if((e[3]&48)>>>4>1){i+=e[i]+1}if(t.pid===0){t.type="pat";r(e.subarray(i),t);this.trigger("data",t)}else if(t.pid===this.pmtPid){t.type="pmt";r(e.subarray(i),t);this.trigger("data",t);while(this.packetsWaitingForPmt.length){this.processPes_.apply(this,this.packetsWaitingForPmt.shift())}}else if(this.programMapTable===undefined){this.packetsWaitingForPmt.push([e,i,t])}else{this.processPes_(e,i,t)}};this.processPes_=function(e,t,i){if(i.pid===this.programMapTable.video){i.streamType=ze.H264_STREAM_TYPE}else if(i.pid===this.programMapTable.audio){i.streamType=ze.ADTS_STREAM_TYPE}else{i.streamType=this.programMapTable["timed-metadata"][i.pid]}i.type="pes";i.data=e.subarray(t);this.trigger("data",i)}};at.prototype=new Y;at.STREAM_TYPES={h264:27,adts:15};st=function e(){var c=this,n={data:[],size:0},a={data:[],size:0},s={data:[],size:0},f=function e(t,i){var r;i.packetLength=6+(t[4]<<8|t[5]);i.dataAlignmentIndicator=(t[6]&4)!==0;r=t[7];if(r&192){i.pts=(t[9]&14)<<27|(t[10]&255)<<20|(t[11]&254)<<12|(t[12]&255)<<5|(t[13]&254)>>>3;i.pts*=4;i.pts+=(t[13]&6)>>>1;i.dts=i.pts;if(r&64){i.dts=(t[14]&14)<<27|(t[15]&255)<<20|(t[16]&254)<<12|(t[17]&255)<<5|(t[18]&254)>>>3;i.dts*=4;i.dts+=(t[18]&6)>>>1}}i.data=t.subarray(9+t[8])},o=function e(t,i,r){var n=new Uint8Array(t.size),a={type:i},s=0,o=0,u=false,l;if(!t.data.length||t.size<9){return}a.trackId=t.data[0].pid;for(s=0;s<t.data.length;s++){l=t.data[s];n.set(l.data,o);o+=l.data.byteLength}f(n,a);u=i==="video"||a.packetLength<=t.size;if(r||u){t.size=0;t.data.length=0}if(u){c.trigger("data",a)}};st.prototype.init.call(this);this.push=function(r){({pat:function e(){},pes:function e(){var t,i;switch(r.streamType){case ze.H264_STREAM_TYPE:case ze.H264_STREAM_TYPE:t=n;i="video";break;case ze.ADTS_STREAM_TYPE:t=a;i="audio";break;case ze.METADATA_STREAM_TYPE:t=s;i="timed-metadata";break;default:return}if(r.payloadUnitStartIndicator){o(t,i,true)}t.data.push(r);t.size+=r.data.byteLength},pmt:function e(){var t={type:"metadata",tracks:[]},i=r.programMapTable;if(i.video!==null){t.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+i.video,codec:"avc",type:"video"})}if(i.audio!==null){t.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+i.audio,codec:"adts",type:"audio"})}c.trigger("data",t)}})[r.type]()};this.flush=function(){o(n,"video");o(a,"audio");o(s,"timed-metadata");this.trigger("done")}};st.prototype=new Y;var lt={PAT_PID:0,MP2T_PACKET_LENGTH:ot,TransportPacketStream:nt,TransportParseStream:at,ElementaryStream:st,TimestampRolloverStream:rt,CaptionStream:qe.CaptionStream,Cea608Stream:qe.Cea608Stream,MetadataStream:it};for(var ct in ze){if(ze.hasOwnProperty(ct)){lt[ct]=ze[ct]}}var ft=lt;var ht;var dt=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];ht=function e(){var l;ht.prototype.init.call(this);this.push=function(e){var t=0,i=0,r,n,a,s,o,u;if(e.type!=="audio"){return}if(l){s=l;l=new Uint8Array(s.byteLength+e.data.byteLength);l.set(s);l.set(e.data,s.byteLength)}else{l=e.data}while(t+5<l.length){if(l[t]!==255||(l[t+1]&246)!==240){t++;continue}n=(~l[t+1]&1)*2;r=(l[t+3]&3)<<11|l[t+4]<<3|(l[t+5]&224)>>5;o=((l[t+6]&3)+1)*1024;u=o*9e4/dt[(l[t+2]&60)>>>2];a=t+r;if(l.byteLength<a){return}this.trigger("data",{pts:e.pts+i*u,dts:e.dts+i*u,sampleCount:o,audioobjecttype:(l[t+2]>>>6&3)+1,channelcount:(l[t+2]&1)<<2|(l[t+3]&192)>>>6,samplerate:dt[(l[t+2]&60)>>>2],samplingfrequencyindex:(l[t+2]&60)>>>2,samplesize:16,data:l.subarray(t+7+n,a)});if(l.byteLength===a){l=undefined;return}i++;l=l.subarray(a)}};this.flush=function(){this.trigger("done")}};ht.prototype=new Y;var pt=ht;var mt;mt=function e(r){var n=r.byteLength,a=0,s=0;this.length=function(){return 8*n};this.bitsAvailable=function(){return 8*n+s};this.loadWord=function(){var e=r.byteLength-n,t=new Uint8Array(4),i=Math.min(4,n);if(i===0){throw new Error("no bytes available")}t.set(r.subarray(e,e+i));a=new DataView(t.buffer).getUint32(0);s=i*8;n-=i};this.skipBits=function(e){var t;if(s>e){a<<=e;s-=e}else{e-=s;t=Math.floor(e/8);e-=t*8;n-=t;this.loadWord();a<<=e;s-=e}};this.readBits=function(e){var t=Math.min(s,e),i=a>>>32-t;s-=t;if(s>0){a<<=t}else if(n>0){this.loadWord()}t=e-t;if(t>0){return i<<t|this.readBits(t)}return i};this.skipLeadingZeros=function(){var e;for(e=0;e<s;++e){if((a&2147483648>>>e)!==0){a<<=e;s-=e;return e}}this.loadWord();return e+this.skipLeadingZeros()};this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())};this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())};this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1};this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();if(1&e){return 1+e>>>1}return-1*(e>>>1)};this.readBoolean=function(){return this.readBits(1)===1};this.readUnsignedByte=function(){return this.readBits(8)};this.loadWord()};var vt=mt;var gt,yt;var _t;yt=function e(){var i=0,r,n;yt.prototype.init.call(this);this.push=function(e){var t;if(!n){n=e.data}else{t=new Uint8Array(n.byteLength+e.data.byteLength);t.set(n);t.set(e.data,n.byteLength);n=t}for(;i<n.byteLength-3;i++){if(n[i+2]===1){r=i+5;break}}while(r<n.byteLength){switch(n[r]){case 0:if(n[r-1]!==0){r+=2;break}else if(n[r-2]!==0){r++;break}if(i+3!==r-2){this.trigger("data",n.subarray(i+3,r-2))}do{r++}while(n[r]!==1&&r<n.length);i=r-2;r+=3;break;case 1:if(n[r-1]!==0||n[r-2]!==0){r+=3;break}this.trigger("data",n.subarray(i+3,r-2));i=r-2;r+=3;break;default:r+=3;break}}n=n.subarray(i);r-=i;i=0};this.flush=function(){if(n&&n.byteLength>3){this.trigger("data",n.subarray(i+3))}n=null;i=0;this.trigger("done")}};yt.prototype=new Y;_t={100:true,110:true,122:true,244:true,44:true,83:true,86:true,118:true,128:true,138:true,139:true,134:true};gt=function e(){var t=new yt,i,r,n,a,s,o,T;gt.prototype.init.call(this);i=this;this.push=function(e){if(e.type!=="video"){return}r=e.trackId;n=e.pts;a=e.dts;t.push(e)};t.on("data",function(e){var t={trackId:r,pts:n,dts:a,data:e};switch(e[0]&31){case 5:t.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:t.nalUnitType="sei_rbsp";t.escapedRBSP=s(e.subarray(1));break;case 7:t.nalUnitType="seq_parameter_set_rbsp";t.escapedRBSP=s(e.subarray(1));t.config=o(t.escapedRBSP);break;case 8:t.nalUnitType="pic_parameter_set_rbsp";break;case 9:t.nalUnitType="access_unit_delimiter_rbsp";break;default:break}i.trigger("data",t)});t.on("done",function(){i.trigger("done")});this.flush=function(){t.flush()};T=function e(t,i){var r=8,n=8,a,s;for(a=0;a<t;a++){if(n!==0){s=i.readExpGolomb();n=(r+s+256)%256}r=n===0?r:n}};s=function e(t){var i=t.byteLength,r=[],n=1,a,s;while(n<i-2){if(t[n]===0&&t[n+1]===0&&t[n+2]===3){r.push(n+2);n+=2}else{n++}}if(r.length===0){return t}a=i-r.length;s=new Uint8Array(a);var o=0;for(n=0;n<a;o++,n++){if(o===r[0]){o++;r.shift()}s[n]=t[o]}return s};o=function e(t){var i=0,r=0,n=0,a=0,s=1,o,u,l,c,f,h,d,p,m,v,g,y,_,b;o=new vt(t);u=o.readUnsignedByte();c=o.readUnsignedByte();l=o.readUnsignedByte();o.skipUnsignedExpGolomb();if(_t[u]){f=o.readUnsignedExpGolomb();if(f===3){o.skipBits(1)}o.skipUnsignedExpGolomb();o.skipUnsignedExpGolomb();o.skipBits(1);if(o.readBoolean()){g=f!==3?8:12;for(b=0;b<g;b++){if(o.readBoolean()){if(b<6){T(16,o)}else{T(64,o)}}}}}o.skipUnsignedExpGolomb();h=o.readUnsignedExpGolomb();if(h===0){o.readUnsignedExpGolomb()}else if(h===1){o.skipBits(1);o.skipExpGolomb();o.skipExpGolomb();d=o.readUnsignedExpGolomb();for(b=0;b<d;b++){o.skipExpGolomb()}}o.skipUnsignedExpGolomb();o.skipBits(1);p=o.readUnsignedExpGolomb();m=o.readUnsignedExpGolomb();v=o.readBits(1);if(v===0){o.skipBits(1)}o.skipBits(1);if(o.readBoolean()){i=o.readUnsignedExpGolomb();r=o.readUnsignedExpGolomb();n=o.readUnsignedExpGolomb();a=o.readUnsignedExpGolomb()}if(o.readBoolean()){if(o.readBoolean()){_=o.readUnsignedByte();switch(_){case 1:y=[1,1];break;case 2:y=[12,11];break;case 3:y=[10,11];break;case 4:y=[16,11];break;case 5:y=[40,33];break;case 6:y=[24,11];break;case 7:y=[20,11];break;case 8:y=[32,11];break;case 9:y=[80,33];break;case 10:y=[18,11];break;case 11:y=[15,11];break;case 12:y=[64,33];break;case 13:y=[160,99];break;case 14:y=[4,3];break;case 15:y=[3,2];break;case 16:y=[2,1];break;case 255:{y=[o.readUnsignedByte()<<8|o.readUnsignedByte(),o.readUnsignedByte()<<8|o.readUnsignedByte()];break}}if(y){s=y[0]/y[1]}}}return{profileIdc:u,levelIdc:l,profileCompatibility:c,width:Math.ceil(((p+1)*16-i*2-r*2)*s),height:(2-v)*(m+1)*16-n*2-a*2}}};gt.prototype=new Y;var bt={H264Stream:gt,NalByteStream:yt};var Tt=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];var St=function e(t){if(t[0]==="I".charCodeAt(0)&&t[1]==="D".charCodeAt(0)&&t[2]==="3".charCodeAt(0)){return true}return false};var kt=function e(t){return t[0]<<21|t[1]<<14|t[2]<<7|t[3]};var wt=function e(t,i,r){var n,a="";for(n=i;n<r;n++){a+="%"+("00"+t[n].toString(16)).slice(-2)}return a};var Ct=function e(t,i,r){return unescape(wt(t,i,r))};var Et=function e(t,i){var r=t[i+6]<<21|t[i+7]<<14|t[i+8]<<7|t[i+9],n=t[i+5],a=(n&16)>>4;if(a){return r+20}return r+10};var At=function e(t,i){var r=(t[i+5]&224)>>5,n=t[i+4]<<3,a=t[i+3]&3<<11;return a|n|r};var Lt=function e(t,i){if(t[i]==="I".charCodeAt(0)&&t[i+1]==="D".charCodeAt(0)&&t[i+2]==="3".charCodeAt(0)){return"timed-metadata"}else if(t[i]&255===255&&(t[i+1]&240)===240){return"audio"}return null};var It=function e(t){var i=0;while(i+5<t.length){if(t[i]!==255||(t[i+1]&246)!==240){i++;continue}return Tt[(t[i+2]&60)>>>2]}return null};var Ot=function e(t){var i,r,n,a;i=10;if(t[5]&64){i+=4;i+=kt(t.subarray(10,14))}do{r=kt(t.subarray(i+4,i+8));if(r<1){return null}a=String.fromCharCode(t[i],t[i+1],t[i+2],t[i+3]);if(a==="PRIV"){n=t.subarray(i+10,i+r+10);for(var s=0;s<n.byteLength;s++){if(n[s]===0){var o=Ct(n,0,s);if(o==="com.apple.streaming.transportStreamTimestamp"){var u=n.subarray(s+1);var l=(u[3]&1)<<30|u[4]<<22|u[5]<<14|u[6]<<6|u[7]>>>2;l*=4;l+=u[7]&3;return l}break}}}i+=10;i+=r}while(i<t.byteLength);return null};var Pt={isLikelyAacData:St,parseId3TagSize:Et,parseAdtsSize:At,parseType:Lt,parseSampleRate:It,parseAacTimestamp:Ot};var Ut;Ut=function e(){var o=new Uint8Array,u=0;Ut.prototype.init.call(this);this.setTimestamp=function(e){u=e};this.push=function(e){var t=0,i=0,r,n,a,s;if(o.length){s=o.length;o=new Uint8Array(e.byteLength+s);o.set(o.subarray(0,s));o.set(e,s)}else{o=e}while(o.length-i>=3){if(o[i]==="I".charCodeAt(0)&&o[i+1]==="D".charCodeAt(0)&&o[i+2]==="3".charCodeAt(0)){if(o.length-i<10){break}t=Pt.parseId3TagSize(o,i);if(i+t>o.length){break}n={type:"timed-metadata",data:o.subarray(i,i+t)};this.trigger("data",n);i+=t;continue}else if((o[i]&255)===255&&(o[i+1]&240)===240){if(o.length-i<7){break}t=Pt.parseAdtsSize(o,i);if(i+t>o.length){break}a={type:"audio",data:o.subarray(i,i+t),pts:u,dts:u};this.trigger("data",a);i+=t;continue}i++}r=o.length-i;if(r>0){o=o.subarray(i)}else{o=new Uint8Array}}};Ut.prototype=new Y;var Dt=Ut;var xt=bt.H264Stream;var Rt=Pt.isLikelyAacData;var Mt=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"];var Bt=["width","height","profileIdc","levelIdc","profileCompatibility"];var Nt,jt,Ft,Vt;var Ht=function e(t,i){var r;if(t.length!==i.length){return false}for(r=0;r<t.length;r++){if(t[r]!==i[r]){return false}}return true};jt=function e(n,a){var s=[],o=0,u=0,l=0,c=Infinity;a=a||{};jt.prototype.init.call(this);this.push=function(t){Le.collectDtsInfo(n,t);if(n){Mt.forEach(function(e){n[e]=t[e]})}s.push(t)};this.setEarliestDts=function(e){u=e-n.timelineStartInfo.baseMediaDecodeTime};this.setVideoBaseMediaDecodeTime=function(e){c=e};this.setAudioAppendStart=function(e){l=e};this.flush=function(){var e,t,i,r;if(s.length===0){this.trigger("done","AudioSegmentStream");return}e=ke.trimAdtsFramesByEarliestDts(s,n,u);n.baseMediaDecodeTime=Le.calculateTrackBaseMediaDecodeTime(n,a.keepOriginalTimestamps);ke.prefixWithSilence(n,e,l,c);n.samples=ke.generateSampleTable(e);i=B.mdat(ke.concatenateFrameData(e));s=[];t=B.moof(o,[n]);r=new Uint8Array(t.byteLength+i.byteLength);o++;r.set(t);r.set(i,t.byteLength);Le.clearDtsInfo(n);this.trigger("data",{track:n,boxes:r});this.trigger("done","AudioSegmentStream")}};jt.prototype=new Y;Nt=function e(l,o){var u=0,c=[],f=[],t,i;o=o||{};Nt.prototype.init.call(this);delete l.minPTS;this.gopCache_=[];this.push=function(e){Le.collectDtsInfo(l,e);if(e.nalUnitType==="seq_parameter_set_rbsp"&&!t){t=e.config;l.sps=[e.data];Bt.forEach(function(e){l[e]=t[e]},this)}if(e.nalUnitType==="pic_parameter_set_rbsp"&&!i){i=e.data;l.pps=[e.data]}c.push(e)};this.flush=function(){var e,t,i,r,n,a;while(c.length){if(c[0].nalUnitType==="access_unit_delimiter_rbsp"){break}c.shift()}if(c.length===0){this.resetStream_();this.trigger("done","VideoSegmentStream");return}e=ie.groupNalsIntoFrames(c);i=ie.groupFramesIntoGops(e);if(!i[0][0].keyFrame){t=this.getGopForFusion_(c[0],l);if(t){i.unshift(t);i.byteLength+=t.byteLength;i.nalCount+=t.nalCount;i.pts=t.pts;i.dts=t.dts;i.duration+=t.duration}else{i=ie.extendFirstKeyFrame(i)}}if(f.length){var s;if(o.alignGopsAtEnd){s=this.alignGopsAtEnd_(i)}else{s=this.alignGopsAtStart_(i)}if(!s){this.gopCache_.unshift({gop:i.pop(),pps:l.pps,sps:l.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);c=[];this.resetStream_();this.trigger("done","VideoSegmentStream");return}Le.clearDtsInfo(l);i=s}Le.collectDtsInfo(l,i);l.samples=ie.generateSampleTable(i);n=B.mdat(ie.concatenateNalData(i));l.baseMediaDecodeTime=Le.calculateTrackBaseMediaDecodeTime(l,o.keepOriginalTimestamps);this.trigger("processedGopsInfo",i.map(function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}}));this.gopCache_.unshift({gop:i.pop(),pps:l.pps,sps:l.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);c=[];this.trigger("baseMediaDecodeTime",l.baseMediaDecodeTime);this.trigger("timelineStartInfo",l.timelineStartInfo);r=B.moof(u,[l]);a=new Uint8Array(r.byteLength+n.byteLength);u++;a.set(r);a.set(n,r.byteLength);this.trigger("data",{track:l,boxes:a});this.resetStream_();this.trigger("done","VideoSegmentStream")};this.resetStream_=function(){Le.clearDtsInfo(l);t=undefined;i=undefined};this.getGopForFusion_=function(e){var t=45e3,i=1e4,r=Infinity,n,a,s,o,u;for(u=0;u<this.gopCache_.length;u++){o=this.gopCache_[u];s=o.gop;if(!(l.pps&&Ht(l.pps[0],o.pps[0]))||!(l.sps&&Ht(l.sps[0],o.sps[0]))){continue}if(s.dts<l.timelineStartInfo.dts){continue}n=e.dts-s.dts-s.duration;if(n>=-i&&n<=t){if(!a||r>n){a=o;r=n}}}if(a){return a.gop}return null};this.alignGopsAtStart_=function(e){var t,i,r,n,a,s,o,u;a=e.byteLength;s=e.nalCount;o=e.duration;t=i=0;while(t<f.length&&i<e.length){r=f[t];n=e[i];if(r.pts===n.pts){break}if(n.pts>r.pts){t++;continue}i++;a-=n.byteLength;s-=n.nalCount;o-=n.duration}if(i===0){return e}if(i===e.length){return null}u=e.slice(i);u.byteLength=a;u.duration=o;u.nalCount=s;u.pts=u[0].pts;u.dts=u[0].dts;return u};this.alignGopsAtEnd_=function(e){var t,i,r,n,a,s;t=f.length-1;i=e.length-1;a=null;s=false;while(t>=0&&i>=0){r=f[t];n=e[i];if(r.pts===n.pts){s=true;break}if(r.pts>n.pts){t--;continue}if(t===f.length-1){a=i}i--}if(!s&&a===null){return null}var o;if(s){o=i}else{o=a}if(o===0){return e}var u=e.slice(o);var l=u.reduce(function(e,t){e.byteLength+=t.byteLength;e.duration+=t.duration;e.nalCount+=t.nalCount;return e},{byteLength:0,duration:0,nalCount:0});u.byteLength=l.byteLength;u.duration=l.duration;u.nalCount=l.nalCount;u.pts=u[0].pts;u.dts=u[0].dts;return u};this.alignGopsWith=function(e){f=e}};Nt.prototype=new Y;Vt=function e(t,i){this.numberOfTracks=0;this.metadataStream=i;t=t||{};if(typeof t.remux!=="undefined"){this.remuxTracks=!!t.remux}else{this.remuxTracks=true}if(typeof t.keepOriginalTimestamps==="boolean"){this.keepOriginalTimestamps=t.keepOriginalTimestamps}this.pendingTracks=[];this.videoTrack=null;this.pendingBoxes=[];this.pendingCaptions=[];this.pendingMetadata=[];this.pendingBytes=0;this.emittedTracks=0;Vt.prototype.init.call(this);this.push=function(e){if(e.text){return this.pendingCaptions.push(e)}if(e.frames){return this.pendingMetadata.push(e)}this.pendingTracks.push(e.track);this.pendingBoxes.push(e.boxes);this.pendingBytes+=e.boxes.byteLength;if(e.track.type==="video"){this.videoTrack=e.track}if(e.track.type==="audio"){this.audioTrack=e.track}}};Vt.prototype=new Y;Vt.prototype.flush=function(e){var t=0,i={captions:[],captionStreams:{},metadata:[],info:{}},r,n,a,s=0,o;if(this.pendingTracks.length<this.numberOfTracks){if(e!=="VideoSegmentStream"&&e!=="AudioSegmentStream"){return}else if(this.remuxTracks){return}else if(this.pendingTracks.length===0){this.emittedTracks++;if(this.emittedTracks>=this.numberOfTracks){this.trigger("done");this.emittedTracks=0}return}}if(this.videoTrack){s=this.videoTrack.timelineStartInfo.pts;Bt.forEach(function(e){i.info[e]=this.videoTrack[e]},this)}else if(this.audioTrack){s=this.audioTrack.timelineStartInfo.pts;Mt.forEach(function(e){i.info[e]=this.audioTrack[e]},this)}if(this.pendingTracks.length===1){i.type=this.pendingTracks[0].type}else{i.type="combined"}this.emittedTracks+=this.pendingTracks.length;a=B.initSegment(this.pendingTracks);i.initSegment=new Uint8Array(a.byteLength);i.initSegment.set(a);i.data=new Uint8Array(this.pendingBytes);for(o=0;o<this.pendingBoxes.length;o++){i.data.set(this.pendingBoxes[o],t);t+=this.pendingBoxes[o].byteLength}for(o=0;o<this.pendingCaptions.length;o++){r=this.pendingCaptions[o];r.startTime=r.startPts;if(!this.keepOriginalTimestamps){r.startTime-=s}r.startTime/=9e4;r.endTime=r.endPts;if(!this.keepOriginalTimestamps){r.endTime-=s}r.endTime/=9e4;i.captionStreams[r.stream]=true;i.captions.push(r)}for(o=0;o<this.pendingMetadata.length;o++){n=this.pendingMetadata[o];n.cueTime=n.pts;if(!this.keepOriginalTimestamps){n.cueTime-=s}n.cueTime/=9e4;i.metadata.push(n)}i.metadata.dispatchType=this.metadataStream.dispatchType;this.pendingTracks.length=0;this.videoTrack=null;this.pendingBoxes.length=0;this.pendingCaptions.length=0;this.pendingBytes=0;this.pendingMetadata.length=0;this.trigger("data",i);if(this.emittedTracks>=this.numberOfTracks){this.trigger("done");this.emittedTracks=0}};Ft=function e(r){var n=this,i=true,a,s;Ft.prototype.init.call(this);r=r||{};this.baseMediaDecodeTime=r.baseMediaDecodeTime||0;this.transmuxPipeline_={};this.setupAacPipeline=function(){var t={};this.transmuxPipeline_=t;t.type="aac";t.metadataStream=new ft.MetadataStream;t.aacStream=new Dt;t.audioTimestampRolloverStream=new ft.TimestampRolloverStream("audio");t.timedMetadataTimestampRolloverStream=new ft.TimestampRolloverStream("timed-metadata");t.adtsStream=new pt;t.coalesceStream=new Vt(r,t.metadataStream);t.headOfPipeline=t.aacStream;t.aacStream.pipe(t.audioTimestampRolloverStream).pipe(t.adtsStream);t.aacStream.pipe(t.timedMetadataTimestampRolloverStream).pipe(t.metadataStream).pipe(t.coalesceStream);t.metadataStream.on("timestamp",function(e){t.aacStream.setTimestamp(e.timeStamp)});t.aacStream.on("data",function(e){if(e.type==="timed-metadata"&&!t.audioSegmentStream){s=s||{timelineStartInfo:{baseMediaDecodeTime:n.baseMediaDecodeTime},codec:"adts",type:"audio"};t.coalesceStream.numberOfTracks++;t.audioSegmentStream=new jt(s,r);t.adtsStream.pipe(t.audioSegmentStream).pipe(t.coalesceStream)}});t.coalesceStream.on("data",this.trigger.bind(this,"data"));t.coalesceStream.on("done",this.trigger.bind(this,"done"))};this.setupTsPipeline=function(){var i={};this.transmuxPipeline_=i;i.type="ts";i.metadataStream=new ft.MetadataStream;i.packetStream=new ft.TransportPacketStream;i.parseStream=new ft.TransportParseStream;i.elementaryStream=new ft.ElementaryStream;i.videoTimestampRolloverStream=new ft.TimestampRolloverStream("video");i.audioTimestampRolloverStream=new ft.TimestampRolloverStream("audio");i.timedMetadataTimestampRolloverStream=new ft.TimestampRolloverStream("timed-metadata");i.adtsStream=new pt;i.h264Stream=new xt;i.captionStream=new ft.CaptionStream;i.coalesceStream=new Vt(r,i.metadataStream);i.headOfPipeline=i.packetStream;i.packetStream.pipe(i.parseStream).pipe(i.elementaryStream);i.elementaryStream.pipe(i.videoTimestampRolloverStream).pipe(i.h264Stream);i.elementaryStream.pipe(i.audioTimestampRolloverStream).pipe(i.adtsStream);i.elementaryStream.pipe(i.timedMetadataTimestampRolloverStream).pipe(i.metadataStream).pipe(i.coalesceStream);i.h264Stream.pipe(i.captionStream).pipe(i.coalesceStream);i.elementaryStream.on("data",function(e){var t;if(e.type==="metadata"){t=e.tracks.length;while(t--){if(!a&&e.tracks[t].type==="video"){a=e.tracks[t];a.timelineStartInfo.baseMediaDecodeTime=n.baseMediaDecodeTime}else if(!s&&e.tracks[t].type==="audio"){s=e.tracks[t];s.timelineStartInfo.baseMediaDecodeTime=n.baseMediaDecodeTime}}if(a&&!i.videoSegmentStream){i.coalesceStream.numberOfTracks++;i.videoSegmentStream=new Nt(a,r);i.videoSegmentStream.on("timelineStartInfo",function(e){if(s){s.timelineStartInfo=e;i.audioSegmentStream.setEarliestDts(e.dts)}});i.videoSegmentStream.on("processedGopsInfo",n.trigger.bind(n,"gopInfo"));i.videoSegmentStream.on("baseMediaDecodeTime",function(e){if(s){i.audioSegmentStream.setVideoBaseMediaDecodeTime(e)}});i.h264Stream.pipe(i.videoSegmentStream).pipe(i.coalesceStream)}if(s&&!i.audioSegmentStream){i.coalesceStream.numberOfTracks++;i.audioSegmentStream=new jt(s,r);i.adtsStream.pipe(i.audioSegmentStream).pipe(i.coalesceStream)}}});i.coalesceStream.on("data",this.trigger.bind(this,"data"));i.coalesceStream.on("done",this.trigger.bind(this,"done"))};this.setBaseMediaDecodeTime=function(e){var t=this.transmuxPipeline_;if(!r.keepOriginalTimestamps){this.baseMediaDecodeTime=e}if(s){s.timelineStartInfo.dts=undefined;s.timelineStartInfo.pts=undefined;Le.clearDtsInfo(s);if(!r.keepOriginalTimestamps){s.timelineStartInfo.baseMediaDecodeTime=e}if(t.audioTimestampRolloverStream){t.audioTimestampRolloverStream.discontinuity()}}if(a){if(t.videoSegmentStream){t.videoSegmentStream.gopCache_=[];t.videoTimestampRolloverStream.discontinuity()}a.timelineStartInfo.dts=undefined;a.timelineStartInfo.pts=undefined;Le.clearDtsInfo(a);t.captionStream.reset();if(!r.keepOriginalTimestamps){a.timelineStartInfo.baseMediaDecodeTime=e}}if(t.timedMetadataTimestampRolloverStream){t.timedMetadataTimestampRolloverStream.discontinuity()}};this.setAudioAppendStart=function(e){if(s){this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)}};this.alignGopsWith=function(e){if(a&&this.transmuxPipeline_.videoSegmentStream){this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)}};this.push=function(e){if(i){var t=Rt(e);if(t&&this.transmuxPipeline_.type!=="aac"){this.setupAacPipeline()}else if(!t&&this.transmuxPipeline_.type!=="ts"){this.setupTsPipeline()}i=false}this.transmuxPipeline_.headOfPipeline.push(e)};this.flush=function(){i=true;this.transmuxPipeline_.headOfPipeline.flush()};this.resetCaptions=function(){if(this.transmuxPipeline_.captionStream){this.transmuxPipeline_.captionStream.reset()}}};Ft.prototype=new Y;var qt={Transmuxer:Ft,VideoSegmentStream:Nt,AudioSegmentStream:jt,AUDIO_PROPERTIES:Mt,VIDEO_PROPERTIES:Bt};var zt,Wt,Gt=G.parseType,Xt=function e(t){return new Date(t*1e3-20828448e5)},Yt=function e(t){return{isLeading:(t[0]&12)>>>2,dependsOn:t[0]&3,isDependedOn:(t[1]&192)>>>6,hasRedundancy:(t[1]&48)>>>4,paddingValue:(t[1]&14)>>>1,isNonSyncSample:t[1]&1,degradationPriority:t[2]<<8|t[3]}},$t=function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r=[],n,a;for(n=0;n+4<t.length;n+=a){a=i.getUint32(n);n+=4;if(a<=0){r.push("<span style='color:red;'>MALFORMED DATA</span>");continue}switch(t[n]&31){case 1:r.push("slice_layer_without_partitioning_rbsp");break;case 5:r.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:r.push("sei_rbsp");break;case 7:r.push("seq_parameter_set_rbsp");break;case 8:r.push("pic_parameter_set_rbsp");break;case 9:r.push("access_unit_delimiter_rbsp");break;default:r.push("UNKNOWN NAL - "+t[n]&31);break}}return r},Kt={avc1:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength);return{dataReferenceIndex:i.getUint16(6),width:i.getUint16(24),height:i.getUint16(26),horizresolution:i.getUint16(28)+i.getUint16(30)/16,vertresolution:i.getUint16(32)+i.getUint16(34)/16,frameCount:i.getUint16(40),depth:i.getUint16(74),config:zt(t.subarray(78,t.byteLength))}},avcC:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r={configurationVersion:t[0],avcProfileIndication:t[1],profileCompatibility:t[2],avcLevelIndication:t[3],lengthSizeMinusOne:t[4]&3,sps:[],pps:[]},n=t[5]&31,a,s,o,u;o=6;for(u=0;u<n;u++){s=i.getUint16(o);o+=2;r.sps.push(new Uint8Array(t.subarray(o,o+s)));o+=s}a=t[o];o++;for(u=0;u<a;u++){s=i.getUint16(o);o+=2;r.pps.push(new Uint8Array(t.subarray(o,o+s)));o+=s}return r},btrt:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength);return{bufferSizeDB:i.getUint32(0),maxBitrate:i.getUint32(4),avgBitrate:i.getUint32(8)}},esds:function e(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),esId:t[6]<<8|t[7],streamPriority:t[8]&31,decoderConfig:{objectProfileIndication:t[11],streamType:t[12]>>>2&63,bufferSize:t[13]<<16|t[14]<<8|t[15],maxBitrate:t[16]<<24|t[17]<<16|t[18]<<8|t[19],avgBitrate:t[20]<<24|t[21]<<16|t[22]<<8|t[23],decoderConfigDescriptor:{tag:t[24],length:t[25],audioObjectType:t[26]>>>3&31,samplingFrequencyIndex:(t[26]&7)<<1|t[27]>>>7&1,channelConfiguration:t[27]>>>3&15}}}},ftyp:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r={majorBrand:Gt(t.subarray(0,4)),minorVersion:i.getUint32(4),compatibleBrands:[]},n=8;while(n<t.byteLength){r.compatibleBrands.push(Gt(t.subarray(n,n+4)));n+=4}return r},dinf:function e(t){return{boxes:zt(t)}},dref:function e(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),dataReferences:zt(t.subarray(8))}},hdlr:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r={version:i.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),handlerType:Gt(t.subarray(8,12)),name:""},n=8;for(n=24;n<t.byteLength;n++){if(t[n]===0){n++;break}r.name+=String.fromCharCode(t[n])}r.name=decodeURIComponent(escape(r.name));return r},mdat:function e(t){return{byteLength:t.byteLength,nals:$t(t)}},mdhd:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r=4,n,a={version:i.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),language:""};if(a.version===1){r+=4;a.creationTime=Xt(i.getUint32(r));r+=8;a.modificationTime=Xt(i.getUint32(r));r+=4;a.timescale=i.getUint32(r);r+=8;a.duration=i.getUint32(r)}else{a.creationTime=Xt(i.getUint32(r));r+=4;a.modificationTime=Xt(i.getUint32(r));r+=4;a.timescale=i.getUint32(r);r+=4;a.duration=i.getUint32(r)}r+=4;n=i.getUint16(r);a.language+=String.fromCharCode((n>>10)+96);a.language+=String.fromCharCode(((n&992)>>5)+96);a.language+=String.fromCharCode((n&31)+96);return a},mdia:function e(t){return{boxes:zt(t)}},mfhd:function e(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),sequenceNumber:t[4]<<24|t[5]<<16|t[6]<<8|t[7]}},minf:function e(t){return{boxes:zt(t)}},mp4a:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r={dataReferenceIndex:i.getUint16(6),channelcount:i.getUint16(16),samplesize:i.getUint16(18),samplerate:i.getUint16(24)+i.getUint16(26)/65536};if(t.byteLength>28){r.streamDescriptor=zt(t.subarray(28))[0]}return r},moof:function e(t){return{boxes:zt(t)}},moov:function e(t){return{boxes:zt(t)}},mvex:function e(t){return{boxes:zt(t)}},mvhd:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r=4,n={version:i.getUint8(0),flags:new Uint8Array(t.subarray(1,4))};if(n.version===1){r+=4;n.creationTime=Xt(i.getUint32(r));r+=8;n.modificationTime=Xt(i.getUint32(r));r+=4;n.timescale=i.getUint32(r);r+=8;n.duration=i.getUint32(r)}else{n.creationTime=Xt(i.getUint32(r));r+=4;n.modificationTime=Xt(i.getUint32(r));r+=4;n.timescale=i.getUint32(r);r+=4;n.duration=i.getUint32(r)}r+=4;n.rate=i.getUint16(r)+i.getUint16(r+2)/16;r+=4;n.volume=i.getUint8(r)+i.getUint8(r+1)/8;r+=2;r+=2;r+=2*4;n.matrix=new Uint32Array(t.subarray(r,r+9*4));r+=9*4;r+=6*4;n.nextTrackId=i.getUint32(r);return n},pdin:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:i.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),rate:i.getUint32(4),initialDelay:i.getUint32(8)}},sdtp:function e(t){var i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),samples:[]},r;for(r=4;r<t.byteLength;r++){i.samples.push({dependsOn:(t[r]&48)>>4,isDependedOn:(t[r]&12)>>2,hasRedundancy:t[r]&3})}return i},sidx:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r={version:t[0],flags:new Uint8Array(t.subarray(1,4)),references:[],referenceId:i.getUint32(4),timescale:i.getUint32(8),earliestPresentationTime:i.getUint32(12),firstOffset:i.getUint32(16)},n=i.getUint16(22),a;for(a=24;n;a+=12,n--){r.references.push({referenceType:(t[a]&128)>>>7,referencedSize:i.getUint32(a)&2147483647,subsegmentDuration:i.getUint32(a+4),startsWithSap:!!(t[a+8]&128),sapType:(t[a+8]&112)>>>4,sapDeltaTime:i.getUint32(a+8)&268435455})}return r},smhd:function e(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),balance:t[4]+t[5]/256}},stbl:function e(t){return{boxes:zt(t)}},stco:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r={version:t[0],flags:new Uint8Array(t.subarray(1,4)),chunkOffsets:[]},n=i.getUint32(4),a;for(a=8;n;a+=4,n--){r.chunkOffsets.push(i.getUint32(a))}return r},stsc:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r=i.getUint32(4),n={version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleToChunks:[]},a;for(a=8;r;a+=12,r--){n.sampleToChunks.push({firstChunk:i.getUint32(a),samplesPerChunk:i.getUint32(a+4),sampleDescriptionIndex:i.getUint32(a+8)})}return n},stsd:function e(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleDescriptions:zt(t.subarray(8))}},stsz:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r={version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleSize:i.getUint32(4),entries:[]},n;for(n=12;n<t.byteLength;n+=4){r.entries.push(i.getUint32(n))}return r},stts:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r={version:t[0],flags:new Uint8Array(t.subarray(1,4)),timeToSamples:[]},n=i.getUint32(4),a;for(a=8;n;a+=8,n--){r.timeToSamples.push({sampleCount:i.getUint32(a),sampleDelta:i.getUint32(a+4)})}return r},styp:function e(t){return Kt.ftyp(t)},tfdt:function e(t){var i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),baseMediaDecodeTime:t[4]<<24|t[5]<<16|t[6]<<8|t[7]};if(i.version===1){i.baseMediaDecodeTime*=Math.pow(2,32);i.baseMediaDecodeTime+=t[8]<<24|t[9]<<16|t[10]<<8|t[11]}return i},tfhd:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r={version:t[0],flags:new Uint8Array(t.subarray(1,4)),trackId:i.getUint32(4)},n=r.flags[2]&1,a=r.flags[2]&2,s=r.flags[2]&8,o=r.flags[2]&16,u=r.flags[2]&32,l=r.flags[0]&65536,c=r.flags[0]&131072,f;f=8;if(n){f+=4;r.baseDataOffset=i.getUint32(12);f+=4}if(a){r.sampleDescriptionIndex=i.getUint32(f);f+=4}if(s){r.defaultSampleDuration=i.getUint32(f);f+=4}if(o){r.defaultSampleSize=i.getUint32(f);f+=4}if(u){r.defaultSampleFlags=i.getUint32(f)}if(l){r.durationIsEmpty=true}if(!n&&c){r.baseDataOffsetIsMoof=true}return r},tkhd:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r=4,n={version:i.getUint8(0),flags:new Uint8Array(t.subarray(1,4))};if(n.version===1){r+=4;n.creationTime=Xt(i.getUint32(r));r+=8;n.modificationTime=Xt(i.getUint32(r));r+=4;n.trackId=i.getUint32(r);r+=4;r+=8;n.duration=i.getUint32(r)}else{n.creationTime=Xt(i.getUint32(r));r+=4;n.modificationTime=Xt(i.getUint32(r));r+=4;n.trackId=i.getUint32(r);r+=4;r+=4;n.duration=i.getUint32(r)}r+=4;r+=2*4;n.layer=i.getUint16(r);r+=2;n.alternateGroup=i.getUint16(r);r+=2;n.volume=i.getUint8(r)+i.getUint8(r+1)/8;r+=2;r+=2;n.matrix=new Uint32Array(t.subarray(r,r+9*4));r+=9*4;n.width=i.getUint16(r)+i.getUint16(r+2)/16;r+=4;n.height=i.getUint16(r)+i.getUint16(r+2)/16;return n},traf:function e(t){return{boxes:zt(t)}},trak:function e(t){return{boxes:zt(t)}},trex:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),trackId:i.getUint32(4),defaultSampleDescriptionIndex:i.getUint32(8),defaultSampleDuration:i.getUint32(12),defaultSampleSize:i.getUint32(16),sampleDependsOn:t[20]&3,sampleIsDependedOn:(t[21]&192)>>6,sampleHasRedundancy:(t[21]&48)>>4,samplePaddingValue:(t[21]&14)>>1,sampleIsDifferenceSample:!!(t[21]&1),sampleDegradationPriority:i.getUint16(22)}},trun:function e(t){var i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),samples:[]},r=new DataView(t.buffer,t.byteOffset,t.byteLength),n=i.flags[2]&1,a=i.flags[2]&4,s=i.flags[1]&1,o=i.flags[1]&2,u=i.flags[1]&4,l=i.flags[1]&8,c=r.getUint32(4),f=8,h;if(n){i.dataOffset=r.getInt32(f);f+=4}if(a&&c){h={flags:Yt(t.subarray(f,f+4))};f+=4;if(s){h.duration=r.getUint32(f);f+=4}if(o){h.size=r.getUint32(f);f+=4}if(l){h.compositionTimeOffset=r.getUint32(f);f+=4}i.samples.push(h);c--}while(c--){h={};if(s){h.duration=r.getUint32(f);f+=4}if(o){h.size=r.getUint32(f);f+=4}if(u){h.flags=Yt(t.subarray(f,f+4));f+=4}if(l){h.compositionTimeOffset=r.getUint32(f);f+=4}i.samples.push(h)}return i},"url ":function e(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4))}},vmhd:function e(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),graphicsmode:i.getUint16(4),opcolor:new Uint16Array([i.getUint16(6),i.getUint16(8),i.getUint16(10)])}}};zt=function e(t){var i=0,r=[],n,a,s,o,u;var l=new ArrayBuffer(t.length);var c=new Uint8Array(l);for(var f=0;f<t.length;++f){c[f]=t[f]}n=new DataView(l);while(i<t.byteLength){a=n.getUint32(i);s=Gt(t.subarray(i+4,i+8));o=a>1?i+a:t.byteLength;u=(Kt[s]||function(e){return{data:e}})(t.subarray(i+8,o));u.size=a;u.type=s;r.push(u);i=o}return r};Wt=function e(t,i){var a;i=i||0;a=new Array(i*2+1).join(" ");return t.map(function(n,e){return a+n.type+"\n"+Object.keys(n).filter(function(e){return e!=="type"&&e!=="boxes"}).map(function(e){var t=a+"  "+e+": ",i=n[e];if(i instanceof Uint8Array||i instanceof Uint32Array){var r=Array.prototype.slice.call(new Uint8Array(i.buffer,i.byteOffset,i.byteLength)).map(function(e){return" "+("00"+e.toString(16)).slice(-2)}).join("").match(/.{1,24}/g);if(!r){return t+"<>"}if(r.length===1){return t+"<"+r.join("").slice(1)+">"}return t+"<\n"+r.map(function(e){return a+"  "+e}).join("\n")+"\n"+a+"  >"}return t+JSON.stringify(i,null,2).split("\n").map(function(e,t){if(t===0){return e}return a+"  "+e}).join("\n")}).join("\n")+(n.boxes?"\n"+Wt(n.boxes,i+1):"")}).join("\n")};var Jt={inspect:zt,textify:Wt,parseTfdt:Kt.tfdt,parseHdlr:Kt.hdlr,parseTfhd:Kt.tfhd,parseTrun:Kt.trun};var Qt=Re.discardEmulationPreventionBytes;var Zt=qe.CaptionStream;var ei=function e(t,i){var r=t;for(var n=0;n<i.length;n++){var a=i[n];if(r<a.size){return a}r-=a.size}return null};var ti=function e(t,i,r){var n=new DataView(t.buffer,t.byteOffset,t.byteLength),a=[],s,o,u,l;for(o=0;o+4<t.length;o+=u){u=n.getUint32(o);o+=4;if(u<=0){continue}switch(t[o]&31){case 6:var c=t.subarray(o+1,o+1+u);var f=ei(o,i);s={nalUnitType:"sei_rbsp",size:u,data:c,escapedRBSP:Qt(c),trackId:r};if(f){s.pts=f.pts;s.dts=f.dts;l=f}else{s.pts=l.pts;s.dts=l.dts}a.push(s);break;default:break}}return a};var ii=function e(t,i,r){var n=i;var a=r.defaultSampleDuration||0;var s=r.defaultSampleSize||0;var o=r.trackId;var u=[];t.forEach(function(e){var t=Jt.parseTrun(e);var i=t.samples;i.forEach(function(e){if(e.duration===undefined){e.duration=a}if(e.size===undefined){e.size=s}e.trackId=o;e.dts=n;if(e.compositionTimeOffset===undefined){e.compositionTimeOffset=0}e.pts=n+e.compositionTimeOffset;n+=e.duration});u=u.concat(i)});return u};var ri=function e(t,f){var r=G.findBox(t,["moof","traf"]);var i=G.findBox(t,["mdat"]);var h={};var n=[];i.forEach(function(e,t){var i=r[t];n.push({mdat:e,traf:i})});n.forEach(function(e){var t=e.mdat;var i=e.traf;var r=G.findBox(i,["tfhd"]);var n=Jt.parseTfhd(r[0]);var a=n.trackId;var s=G.findBox(i,["tfdt"]);var o=s.length>0?Jt.parseTfdt(s[0]).baseMediaDecodeTime:0;var u=G.findBox(i,["trun"]);var l;var c;if(f===a&&u.length>0){l=ii(u,o,n);c=ti(t,l,a);if(!h[a]){h[a]=[]}h[a]=h[a].concat(c)}});return h};var ni=function e(t,i,r){var n;if(!i){return null}n=ri(t,i);return{seiNals:n[i],timescale:r}};var ai=function e(){var t=false;var i;var a;var s;var o;var u;this.isInitialized=function(){return t};this.init=function(){i=new Zt;t=true;i.on("data",function(e){e.startTime=e.startPts/o;e.endTime=e.endPts/o;u.captions.push(e);u.captionStreams[e.stream]=true})};this.isNewInit=function(e,t){if(e&&e.length===0||t&&typeof t==="object"&&Object.keys(t).length===0){return false}return s!==e[0]||o!==t[s]};this.parse=function(e,t,i){var r;if(!this.isInitialized()){return null}else if(!t||!i){return null}else if(this.isNewInit(t,i)){s=t[0];o=i[s]}else if(!s||!o){a.push(e);return null}while(a.length>0){var n=a.shift();this.parse(n,t,i)}r=ni(e,s,o);if(r===null||!r.seiNals){return null}this.pushNals(r.seiNals);this.flushStream();return u};this.pushNals=function(e){if(!this.isInitialized()||!e||e.length===0){return null}e.forEach(function(e){i.push(e)})};this.flushStream=function(){if(!this.isInitialized()){return null}i.flush()};this.clearParsedCaptions=function(){u.captions=[];u.captionStreams={}};this.resetCaptionStream=function(){if(!this.isInitialized()){return null}i.reset()};this.clearAllCaptions=function(){this.clearParsedCaptions();this.resetCaptionStream()};this.reset=function(){a=[];s=null;o=null;if(!u){u={captions:[],captionStreams:{}}}else{this.clearParsedCaptions()}this.resetCaptionStream()};this.reset()};var si=ai;var oi={generator:B,probe:G,Transmuxer:qt.Transmuxer,AudioSegmentStream:qt.AudioSegmentStream,VideoSegmentStream:qt.VideoSegmentStream,CaptionParser:si};var ui=function e(t,i){if(!(t instanceof i)){throw new TypeError("Cannot call a class as a function")}};var li=function(){function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(e,t,i){if(t)r(e.prototype,t);if(i)r(e,i);return e}}();var ci=function e(r,t){t.on("data",function(e){var t=e.initSegment;e.initSegment={data:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength};var i=e.data;e.data=i.buffer;r.postMessage({action:"data",segment:e,byteOffset:i.byteOffset,byteLength:i.byteLength},[e.data])});if(t.captionStream){t.captionStream.on("data",function(e){r.postMessage({action:"caption",data:e})})}t.on("done",function(e){r.postMessage({action:"done"})});t.on("gopInfo",function(e){r.postMessage({action:"gopInfo",gopInfo:e})})};var fi=function(){function i(e,t){ui(this,i);this.options=t||{};this.self=e;this.init()}li(i,[{key:"init",value:function e(){if(this.transmuxer){this.transmuxer.dispose()}this.transmuxer=new oi.Transmuxer(this.options);ci(this.self,this.transmuxer)}},{key:"push",value:function e(t){var i=new Uint8Array(t.data,t.byteOffset,t.byteLength);this.transmuxer.push(i)}},{key:"reset",value:function e(){this.init()}},{key:"setTimestampOffset",value:function e(t){var i=t.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(i*9e4))}},{key:"setAudioAppendStart",value:function e(t){this.transmuxer.setAudioAppendStart(Math.ceil(t.appendStart*9e4))}},{key:"flush",value:function e(t){this.transmuxer.flush()}},{key:"resetCaptions",value:function e(){this.transmuxer.resetCaptions()}},{key:"alignGopsWith",value:function e(t){this.transmuxer.alignGopsWith(t.gopsToAlignWith.slice())}}]);return i}();var hi=function e(t){t.onmessage=function(e){if(e.data.action==="init"&&e.data.options){this.messageHandlers=new fi(t,e.data.options);return}if(!this.messageHandlers){this.messageHandlers=new fi(t)}if(e.data&&e.data.action&&e.data.action!=="init"){if(this.messageHandlers[e.data.action]){this.messageHandlers[e.data.action](e.data)}}}};var di=new hi(pi);return di}()});var cd={videoCodec:"avc1",videoObjectTypeIndicator:".4d400d",audioProfile:"2"};var fd=function e(t){return t.map(function(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,function(e,t,i){var r=("00"+Number(t).toString(16)).slice(-2);var n=("00"+Number(i).toString(16)).slice(-2);return"avc1."+r+"00"+n})})};var hd=function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var i={codecCount:0};var r=void 0;i.codecCount=t.split(",").length;i.codecCount=i.codecCount||2;r=/(^|\s|,)+(avc[13])([^ ,]*)/i.exec(t);if(r){i.videoCodec=r[2];i.videoObjectTypeIndicator=r[3]}i.audioProfile=/(^|\s|,)+mp4a.[0-9A-Fa-f]+\.([0-9A-Fa-f]+)/i.exec(t);i.audioProfile=i.audioProfile&&i.audioProfile[2];return i};var dd=function e(t){return t.replace(/avc1\.(\d+)\.(\d+)/i,function(e){return fd([e])[0]})};var pd=function e(t,i,r){return t+"/"+i+'; codecs="'+r.filter(function(e){return!!e}).join(", ")+'"'};var md=function e(t){if(t.segments&&t.segments.length&&t.segments[0].map){return"mp4"}return"mp2t"};var vd=function e(t){var i=t.attributes||{};if(i.CODECS){return hd(i.CODECS)}return cd};var gd=function e(t,i){if(!t.mediaGroups.AUDIO||!i){return null}var r=t.mediaGroups.AUDIO[i];if(!r){return null}for(var n in r){var a=r[n];if(a.default&&a.playlists){return hd(a.playlists[0].attributes.CODECS).audioProfile}}return null};var yd=function e(t,i){var r=md(i);var n=vd(i);var a=i.attributes||{};var s=true;var o=false;if(!i){return[]}if(t.mediaGroups.AUDIO&&a.AUDIO){var u=t.mediaGroups.AUDIO[a.AUDIO];if(u){o=true;s=false;for(var l in u){if(!u[l].uri&&!u[l].playlists){s=true;break}}}}if(o&&!n.audioProfile){if(!s){n.audioProfile=gd(t,a.AUDIO)}if(!n.audioProfile){Ts.log.warn("Multiple audio tracks present but no audio codec string is specified. "+"Attempting to use the default audio codec (mp4a.40.2)");n.audioProfile=cd.audioProfile}}var c={};if(n.videoCodec){c.video=""+n.videoCodec+n.videoObjectTypeIndicator}if(n.audioProfile){c.audio="mp4a.40."+n.audioProfile}var f=pd("audio",r,[c.audio]);var h=pd("video",r,[c.video]);var d=pd("video",r,[c.video,c.audio]);if(o){if(!s&&c.video){return[h,f]}if(!s&&!c.video){return[f,f]}return[d,f]}if(!c.video){return[f]}return[d]};var _d=function e(t){var n={type:"",parameters:{}};var i=t.trim().split(";");n.type=i.shift().trim();i.forEach(function(e){var t=e.trim().split("=");if(t.length>1){var i=t[0].replace(/"/g,"").trim();var r=t[1].replace(/"/g,"").trim();n.parameters[i]=r}});return n};var bd=function e(t){return/mp4a\.\d+.\d+/i.test(t)};var Td=function e(t){return/avc1\.[\da-f]+/i.test(t)};var Sd=function e(t,i,r){if(typeof i==="undefined"||i===null||!t.length){return[]}var n=Math.ceil((i-r+3)*9e4);var a=void 0;for(a=0;a<t.length;a++){if(t[a].pts>n){break}}return t.slice(a)};var kd=function e(t,i,r){if(!i.length){return t}if(r){return i.slice()}var n=i[0].pts;var a=0;for(a;a<t.length;a++){if(t[a].pts>=n){break}}return t.slice(0,a).concat(i)};var wd=function e(t,i,r,n){var a=Math.ceil((i-n)*9e4);var s=Math.ceil((r-n)*9e4);var o=t.slice();var u=t.length;while(u--){if(t[u].pts<=s){break}}if(u===-1){return o}var l=u+1;while(l--){if(t[l].pts<=a){break}}l=Math.max(l,0);o.splice(l,u-l+1);return o};var Cd=function e(t,i,r){var n=null;var a=null;var s=0;var o=[];var u=[];if(!t&&!i){return Ts.createTimeRange()}if(!t){return i.buffered}if(!i){return t.buffered}if(r){return t.buffered}if(t.buffered.length===0&&i.buffered.length===0){return Ts.createTimeRange()}var l=t.buffered;var c=i.buffered;var f=l.length;while(f--){o.push({time:l.start(f),type:"start"});o.push({time:l.end(f),type:"end"})}f=c.length;while(f--){o.push({time:c.start(f),type:"start"});o.push({time:c.end(f),type:"end"})}o.sort(function(e,t){return e.time-t.time});for(f=0;f<o.length;f++){if(o[f].type==="start"){s++;if(s===2){n=o[f].time}}else if(o[f].type==="end"){s--;if(s===1){a=o[f].time}}if(n!==null&&a!==null){u.push([n,a]);n=null;a=null}}return Ts.createTimeRanges(u)};var Ed=function e(t,i){var r=t.addSourceBuffer(i);var n=Object.create(null);n.updating=false;n.realBuffer_=r;var a=function e(i){if(typeof r[i]==="function"){n[i]=function(){return r[i].apply(r,arguments)}}else if(typeof n[i]==="undefined"){Object.defineProperty(n,i,{get:function e(){return r[i]},set:function e(t){return r[i]=t}})}};for(var s in r){a(s)}return n};var Ad=function(e){Df(n,e);function n(e,t){Of(this,n);var i=xf(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,Ts.EventTarget));i.timestampOffset_=0;i.pendingBuffers_=[];i.bufferUpdating_=false;i.mediaSource_=e;i.codecs_=t;i.audioCodec_=null;i.videoCodec_=null;i.audioDisabled_=false;i.appendAudioInitSegment_=true;i.gopBuffer_=[];i.timeMapping_=0;i.safeAppend_=Ts.browser.IE_VERSION>=11;var r={remux:false,alignGopsAtEnd:i.safeAppend_};i.codecs_.forEach(function(e){if(bd(e)){i.audioCodec_=e}else if(Td(e)){i.videoCodec_=e}});i.transmuxer_=new ld;i.transmuxer_.postMessage({action:"init",options:r});i.transmuxer_.onmessage=function(e){if(e.data.action==="data"){return i.data_(e)}if(e.data.action==="done"){return i.done_(e)}if(e.data.action==="gopInfo"){return i.appendGopInfo_(e)}};Object.defineProperty(i,"timestampOffset",{get:function e(){return this.timestampOffset_},set:function e(t){if(typeof t==="number"&&t>=0){this.timestampOffset_=t;this.appendAudioInitSegment_=true;this.gopBuffer_.length=0;this.timeMapping_=0;this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:t})}}});Object.defineProperty(i,"appendWindowStart",{get:function e(){return(this.videoBuffer_||this.audioBuffer_).appendWindowStart},set:function e(t){if(this.videoBuffer_){this.videoBuffer_.appendWindowStart=t}if(this.audioBuffer_){this.audioBuffer_.appendWindowStart=t}}});Object.defineProperty(i,"updating",{get:function e(){return!!(this.bufferUpdating_||!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.updating||this.videoBuffer_&&this.videoBuffer_.updating)}});Object.defineProperty(i,"buffered",{get:function e(){return Cd(this.videoBuffer_,this.audioBuffer_,this.audioDisabled_)}});return i}Pf(n,[{key:"data_",value:function e(t){var i=t.data.segment;i.data=new Uint8Array(i.data,t.data.byteOffset,t.data.byteLength);i.initSegment=new Uint8Array(i.initSegment.data,i.initSegment.byteOffset,i.initSegment.byteLength);Gh(this,this.mediaSource_,i);this.pendingBuffers_.push(i);return}},{key:"done_",value:function e(t){if(this.mediaSource_.readyState==="closed"){this.pendingBuffers_.length=0;return}this.processPendingSegments_();return}},{key:"createRealSourceBuffers_",value:function e(){var n=this;var a=["audio","video"];a.forEach(function(i){if(!n[i+"Codec_"]){return}if(n[i+"Buffer_"]){return}var e=null;if(n.mediaSource_[i+"Buffer_"]){e=n.mediaSource_[i+"Buffer_"];e.updating=false}else{var t=i+"Codec_";var r=i+'/mp4;codecs="'+n[t]+'"';e=Ed(n.mediaSource_.nativeMediaSource_,r);n.mediaSource_[i+"Buffer_"]=e}n[i+"Buffer_"]=e;["update","updatestart","updateend"].forEach(function(t){e.addEventListener(t,function(){if(i==="audio"&&n.audioDisabled_){return}if(t==="updateend"){n[i+"Buffer_"].updating=false}var e=a.every(function(e){if(e==="audio"&&n.audioDisabled_){return true}if(i!==e&&n[e+"Buffer_"]&&n[e+"Buffer_"].updating){return false}return true});if(e){return n.trigger(t)}})})})}},{key:"appendBuffer",value:function e(t){this.bufferUpdating_=true;if(this.audioBuffer_&&this.audioBuffer_.buffered.length){var i=this.audioBuffer_.buffered;this.transmuxer_.postMessage({action:"setAudioAppendStart",appendStart:i.end(i.length-1)})}if(this.videoBuffer_){this.transmuxer_.postMessage({action:"alignGopsWith",gopsToAlignWith:Sd(this.gopBuffer_,this.mediaSource_.player_?this.mediaSource_.player_.currentTime():null,this.timeMapping_)})}this.transmuxer_.postMessage({action:"push",data:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength},[t.buffer]);this.transmuxer_.postMessage({action:"flush"})}},{key:"appendGopInfo_",value:function e(t){this.gopBuffer_=kd(this.gopBuffer_,t.data.gopInfo,this.safeAppend_)}},{key:"remove",value:function e(t,i){if(this.videoBuffer_){this.videoBuffer_.updating=true;this.videoBuffer_.remove(t,i);this.gopBuffer_=wd(this.gopBuffer_,t,i,this.timeMapping_)}if(!this.audioDisabled_&&this.audioBuffer_){this.audioBuffer_.updating=true;this.audioBuffer_.remove(t,i)}Xh(t,i,this.metadataTrack_);if(this.inbandTextTracks_){for(var r in this.inbandTextTracks_){Xh(t,i,this.inbandTextTracks_[r])}}}},{key:"processPendingSegments_",value:function e(){var t={video:{segments:[],bytes:0},audio:{segments:[],bytes:0},captions:[],metadata:[]};t=this.pendingBuffers_.reduce(function(e,t){var i=t.type;var r=t.data;var n=t.initSegment;e[i].segments.push(r);e[i].bytes+=r.byteLength;e[i].initSegment=n;if(t.captions){e.captions=e.captions.concat(t.captions)}if(t.info){e[i].info=t.info}if(t.metadata){e.metadata=e.metadata.concat(t.metadata)}return e},t);if(!this.videoBuffer_&&!this.audioBuffer_){if(t.video.bytes===0){this.videoCodec_=null}if(t.audio.bytes===0){this.audioCodec_=null}this.createRealSourceBuffers_()}if(t.audio.info){this.mediaSource_.trigger({type:"audioinfo",info:t.audio.info})}if(t.video.info){this.mediaSource_.trigger({type:"videoinfo",info:t.video.info})}if(this.appendAudioInitSegment_){if(!this.audioDisabled_&&this.audioBuffer_){t.audio.segments.unshift(t.audio.initSegment);t.audio.bytes+=t.audio.initSegment.byteLength}this.appendAudioInitSegment_=false}var i=false;if(this.videoBuffer_&&t.video.bytes){t.video.segments.unshift(t.video.initSegment);t.video.bytes+=t.video.initSegment.byteLength;this.concatAndAppendSegments_(t.video,this.videoBuffer_);Kh(this,t.captions,t.metadata)}else if(this.videoBuffer_&&(this.audioDisabled_||!this.audioBuffer_)){i=true}if(!this.audioDisabled_&&this.audioBuffer_){this.concatAndAppendSegments_(t.audio,this.audioBuffer_)}this.pendingBuffers_.length=0;if(i){this.trigger("updateend")}this.bufferUpdating_=false}},{key:"concatAndAppendSegments_",value:function e(t,i){var r=0;var n=void 0;if(t.bytes){n=new Uint8Array(t.bytes);t.segments.forEach(function(e){n.set(e,r);r+=e.byteLength});try{i.updating=true;i.appendBuffer(n)}catch(e){if(this.mediaSource_.player_){this.mediaSource_.player_.error({code:-3,type:"APPEND_BUFFER_ERR",message:e.message,originalError:e})}}}}},{key:"abort",value:function e(){if(this.videoBuffer_){this.videoBuffer_.abort()}if(!this.audioDisabled_&&this.audioBuffer_){this.audioBuffer_.abort()}if(this.transmuxer_){this.transmuxer_.postMessage({action:"reset"})}this.pendingBuffers_.length=0;this.bufferUpdating_=false}}]);return n}(Ts.EventTarget);var Ld=function(e){Df(t,e);function t(){Of(this,t);var a=xf(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));var e=void 0;a.nativeMediaSource_=new _.MediaSource;for(e in a.nativeMediaSource_){if(!(e in t.prototype)&&typeof a.nativeMediaSource_[e]==="function"){a[e]=a.nativeMediaSource_[e].bind(a.nativeMediaSource_)}}a.duration_=NaN;Object.defineProperty(a,"duration",{get:function e(){if(this.duration_===Infinity){return this.duration_}return this.nativeMediaSource_.duration},set:function e(t){this.duration_=t;if(t!==Infinity){this.nativeMediaSource_.duration=t;return}}});Object.defineProperty(a,"seekable",{get:function e(){if(this.duration_===Infinity){return Ts.createTimeRanges([[0,this.nativeMediaSource_.duration]])}return this.nativeMediaSource_.seekable}});Object.defineProperty(a,"readyState",{get:function e(){return this.nativeMediaSource_.readyState}});Object.defineProperty(a,"activeSourceBuffers",{get:function e(){return this.activeSourceBuffers_}});a.sourceBuffers=[];a.activeSourceBuffers_=[];a.updateActiveSourceBuffers_=function(){a.activeSourceBuffers_.length=0;if(a.sourceBuffers.length===1){var e=a.sourceBuffers[0];e.appendAudioInitSegment_=true;e.audioDisabled_=!e.audioCodec_;a.activeSourceBuffers_.push(e);return}var i=false;var r=true;for(var t=0;t<a.player_.audioTracks().length;t++){var n=a.player_.audioTracks()[t];if(n.enabled&&n.kind!=="main"){i=true;r=false;break}}a.sourceBuffers.forEach(function(e,t){e.appendAudioInitSegment_=true;if(e.videoCodec_&&e.audioCodec_){e.audioDisabled_=i}else if(e.videoCodec_&&!e.audioCodec_){e.audioDisabled_=true;r=false}else if(!e.videoCodec_&&e.audioCodec_){e.audioDisabled_=t?r:!r;if(e.audioDisabled_){return}}a.activeSourceBuffers_.push(e)})};a.onPlayerMediachange_=function(){a.sourceBuffers.forEach(function(e){e.appendAudioInitSegment_=true})};a.onHlsReset_=function(){a.sourceBuffers.forEach(function(e){if(e.transmuxer_){e.transmuxer_.postMessage({action:"resetCaptions"})}})};a.onHlsSegmentTimeMapping_=function(t){a.sourceBuffers.forEach(function(e){return e.timeMapping_=t.mapping})};["sourceopen","sourceclose","sourceended"].forEach(function(e){this.nativeMediaSource_.addEventListener(e,this.trigger.bind(this))},a);a.on("sourceopen",function(e){var t=h.querySelector('[src="'+a.url_+'"]');if(!t){return}a.player_=Ts(t.parentNode);if(!a.player_){return}a.player_.tech_.on("hls-reset",a.onHlsReset_);a.player_.tech_.on("hls-segment-time-mapping",a.onHlsSegmentTimeMapping_);if(a.player_.audioTracks&&a.player_.audioTracks()){a.player_.audioTracks().on("change",a.updateActiveSourceBuffers_);a.player_.audioTracks().on("addtrack",a.updateActiveSourceBuffers_);a.player_.audioTracks().on("removetrack",a.updateActiveSourceBuffers_)}a.player_.on("mediachange",a.onPlayerMediachange_)});a.on("sourceended",function(e){var t=$h(a.duration);for(var i=0;i<a.sourceBuffers.length;i++){var r=a.sourceBuffers[i];var n=r.metadataTrack_&&r.metadataTrack_.cues;if(n&&n.length){n[n.length-1].endTime=t}}});a.on("sourceclose",function(e){this.sourceBuffers.forEach(function(e){if(e.transmuxer_){e.transmuxer_.terminate()}});this.sourceBuffers.length=0;if(!this.player_){return}if(this.player_.audioTracks&&this.player_.audioTracks()){this.player_.audioTracks().off("change",this.updateActiveSourceBuffers_);this.player_.audioTracks().off("addtrack",this.updateActiveSourceBuffers_);this.player_.audioTracks().off("removetrack",this.updateActiveSourceBuffers_)}if(this.player_.el_){this.player_.off("mediachange",this.onPlayerMediachange_)}if(this.player_.tech_&&this.player_.tech_.el_){this.player_.tech_.off("hls-reset",this.onHlsReset_);this.player_.tech_.off("hls-segment-time-mapping",this.onHlsSegmentTimeMapping_)}});return a}Pf(t,[{key:"addSeekableRange_",value:function e(t,i){var r=void 0;if(this.duration!==Infinity){r=new Error("MediaSource.addSeekableRange() can only be invoked "+"when the duration is Infinity");r.name="InvalidStateError";r.code=11;throw r}if(i>this.nativeMediaSource_.duration||isNaN(this.nativeMediaSource_.duration)){this.nativeMediaSource_.duration=i}}},{key:"addSourceBuffer",value:function e(t){var i=void 0;var r=_d(t);if(/^(video|audio)\/mp2t$/i.test(r.type)){var n=[];if(r.parameters&&r.parameters.codecs){n=r.parameters.codecs.split(",");n=fd(n);n=n.filter(function(e){return bd(e)||Td(e)})}if(n.length===0){n=["avc1.4d400d","mp4a.40.2"]}i=new Ad(this,n);if(this.sourceBuffers.length!==0){this.sourceBuffers[0].createRealSourceBuffers_();i.createRealSourceBuffers_();this.sourceBuffers[0].audioDisabled_=true}}else{i=this.nativeMediaSource_.addSourceBuffer(t)}this.sourceBuffers.push(i);return i}}]);return t}(Ts.EventTarget);var Id=0;Ts.mediaSources={};var Od=function e(t,i){var r=Ts.mediaSources[t];if(r){r.trigger({type:"sourceopen",swfId:i})}else{throw new Error("Media Source not found (Video.js)")}};var Pd=function e(){return!!_.MediaSource&&!!_.MediaSource.isTypeSupported&&_.MediaSource.isTypeSupported('video/mp4;codecs="avc1.4d400d,mp4a.40.2"')};var Ud=function e(){this.MediaSource={open:Od,supportsNativeMediaSources:Pd};if(Pd()){return new Ld}throw new Error("Cannot use create a virtual MediaSource for this video")};Ud.open=Od;Ud.supportsNativeMediaSources=Pd;var Dd={createObjectURL:function e(t){var i="blob:vjs-media-source/";var r=void 0;if(t instanceof Ld){r=_.URL.createObjectURL(t.nativeMediaSource_);t.url_=r;return r}if(!(t instanceof Ld)){r=_.URL.createObjectURL(t);t.url_=r;return r}r=i+Id;Id++;Ts.mediaSources[r]=t;return r}};Ts.MediaSource=Ud;Ts.URL=Dd;var xd=Ts.EventTarget,Rd=Ts.mergeOptions;var Md=function e(t,i){var s=Rd(t,{duration:i.duration,minimumUpdatePeriod:i.minimumUpdatePeriod});for(var r=0;r<i.playlists.length;r++){var n=Hf(s,i.playlists[r]);if(n){s=n}}jf(i,function(e,t,i,r){if(e.playlists&&e.playlists.length){var n=e.playlists[0].uri;var a=Hf(s,e.playlists[0]);if(a){s=a;s.mediaGroups[t][i][r].playlists[0]=s.playlists[n]}}});return s};var Bd=function(e){Df(a,e);function a(e,t,i,r){Of(this,a);var n=xf(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));n.hls_=t;n.withCredentials=i;if(!e){throw new Error("A non-empty playlist URL or playlist is required")}n.on("minimumUpdatePeriod",function(){n.refreshXml_()});n.on("mediaupdatetimeout",function(){n.refreshMedia_()});if(typeof e==="string"){n.srcUrl=e;n.state="HAVE_NOTHING";return xf(n)}n.masterPlaylistLoader_=r;n.state="HAVE_METADATA";n.started=true;n.media(e);_.setTimeout(function(){n.trigger("loadedmetadata")},0);return n}Pf(a,[{key:"dispose",value:function e(){this.stopRequest();_.clearTimeout(this.mediaUpdateTimeout)}},{key:"stopRequest",value:function e(){if(this.request){var t=this.request;this.request=null;t.onreadystatechange=null;t.abort()}}},{key:"media",value:function e(t){if(!t){return this.media_}if(this.state==="HAVE_NOTHING"){throw new Error("Cannot switch media playlist from "+this.state)}var i=this.state;if(typeof t==="string"){if(!this.master.playlists[t]){throw new Error("Unknown playlist URI: "+t)}t=this.master.playlists[t]}var r=!this.media_||t.uri!==this.media_.uri;this.state="HAVE_METADATA";if(!r){return}if(this.media_){this.trigger("mediachanging")}this.media_=t;this.refreshMedia_();if(i!=="HAVE_MASTER"){this.trigger("mediachange")}}},{key:"pause",value:function e(){this.stopRequest();_.clearTimeout(this.mediaUpdateTimeout);if(this.state==="HAVE_NOTHING"){this.started=false}}},{key:"load",value:function e(t){var i=this;_.clearTimeout(this.mediaUpdateTimeout);var r=this.media();if(t){var n=r?r.targetDuration/2*1e3:5*1e3;this.mediaUpdateTimeout=_.setTimeout(function(){return i.load()},n);return}if(!this.started){this.start();return}this.trigger("loadedplaylist")}},{key:"parseMasterXml",value:function e(){var a=xo(this.masterXml_,{manifestUri:this.srcUrl,clientOffset:this.clientOffset_});a.uri=this.srcUrl;for(var t=0;t<a.playlists.length;t++){var i="placeholder-uri-"+t;a.playlists[t].uri=i;a.playlists[i]=a.playlists[t]}jf(a,function(e,t,i,r){if(e.playlists&&e.playlists.length){var n="placeholder-uri-"+t+"-"+i+"-"+r;e.playlists[0].uri=n;a.playlists[n]=e.playlists[0]}});qf(a);zf(a);return a}},{key:"start",value:function e(){var i=this;this.started=true;this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(e,t){if(!i.request){return}i.request=null;if(e){i.error={status:t.status,message:"DASH playlist request error at URL: "+i.srcUrl,responseText:t.responseText,code:2};if(i.state==="HAVE_NOTHING"){i.started=false}return i.trigger("error")}i.masterXml_=t.responseText;if(t.responseHeaders&&t.responseHeaders.date){i.masterLoaded_=Date.parse(t.responseHeaders.date)}else{i.masterLoaded_=Date.now()}i.syncClientServerClock_(i.onClientServerClockSync_.bind(i))})}},{key:"syncClientServerClock_",value:function e(r){var n=this;var a=Ro(this.masterXml_);if(a===null){this.clientOffset_=this.masterLoaded_-Date.now();return r()}if(a.method==="DIRECT"){this.clientOffset_=a.value-Date.now();return r()}this.request=this.hls_.xhr({uri:If(this.srcUrl,a.value),method:a.method,withCredentials:this.withCredentials},function(e,t){if(!n.request){return}if(e){n.clientOffset_=n.masterLoaded_-Date.now();return r()}var i=void 0;if(a.method==="HEAD"){if(!t.responseHeaders||!t.responseHeaders.date){i=n.masterLoaded_}else{i=Date.parse(t.responseHeaders.date)}}else{i=Date.parse(t.responseText)}n.clientOffset_=i-Date.now();r()})}},{key:"onClientServerClockSync_",value:function e(){var t=this;this.master=this.parseMasterXml();this.state="HAVE_MASTER";this.trigger("loadedplaylist");if(!this.media_){this.media(this.master.playlists[0])}_.setTimeout(function(){t.trigger("loadedmetadata")},0);if(this.master.minimumUpdatePeriod){_.setTimeout(function(){t.trigger("minimumUpdatePeriod")},this.master.minimumUpdatePeriod)}}},{key:"refreshXml_",value:function e(){var r=this;this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(e,t){if(!r.request){return}r.request=null;if(e){r.error={status:t.status,message:"DASH playlist request error at URL: "+r.srcUrl,responseText:t.responseText,code:2};if(r.state==="HAVE_NOTHING"){r.started=false}return r.trigger("error")}r.masterXml_=t.responseText;var i=r.parseMasterXml();r.master=Md(r.master,i);_.setTimeout(function(){r.trigger("minimumUpdatePeriod")},r.master.minimumUpdatePeriod)})}},{key:"refreshMedia_",value:function e(){var t=this;var i=void 0;var r=void 0;if(this.masterPlaylistLoader_){i=this.masterPlaylistLoader_.master;r=this.masterPlaylistLoader_.parseMasterXml()}else{i=this.master;r=this.parseMasterXml()}var n=Md(i,r);if(n){if(this.masterPlaylistLoader_){this.masterPlaylistLoader_.master=n}else{this.master=n}this.media_=n.playlists[this.media_.uri]}else{this.trigger("playlistunchanged")}if(!this.media().endList){this.mediaUpdateTimeout=_.setTimeout(function(){t.trigger("mediaupdatetimeout")},Wf(this.media(),!!n))}this.trigger("loadedplaylist")}}]);return a}(xd);var Nd=function e(t){if(Ts.log.debug){return Ts.log.debug.bind(Ts,"VHS:",t+" >")}return function(){}};function jd(){}var Fd=function(){function n(e,t,i,r){Of(this,n);this.callbacks_=[];this.pendingCallback_=null;this.timestampOffset_=0;this.mediaSource=e;this.processedAppend_=false;this.type_=i;this.mimeType_=t;this.logger_=Nd("SourceUpdater["+i+"]["+t+"]");if(e.readyState==="closed"){e.addEventListener("sourceopen",this.createSourceBuffer_.bind(this,t,r))}else{this.createSourceBuffer_(t,r)}}Pf(n,[{key:"createSourceBuffer_",value:function e(t,i){var r=this;this.sourceBuffer_=this.mediaSource.addSourceBuffer(t);this.logger_("created SourceBuffer");if(i){i.trigger("sourcebufferadded");if(this.mediaSource.sourceBuffers.length<2){i.on("sourcebufferadded",function(){r.start_()});return}}this.start_()}},{key:"start_",value:function e(){var t=this;this.started_=true;this.onUpdateendCallback_=function(){var e=t.pendingCallback_;t.pendingCallback_=null;t.logger_("buffered ["+qh(t.buffered())+"]");if(e){e()}t.runCallback_()};this.sourceBuffer_.addEventListener("updateend",this.onUpdateendCallback_);this.runCallback_()}},{key:"abort",value:function e(t){var i=this;if(this.processedAppend_){this.queueCallback_(function(){i.sourceBuffer_.abort()},t)}}},{key:"appendBuffer",value:function e(t,i){var r=this;this.processedAppend_=true;this.queueCallback_(function(){r.sourceBuffer_.appendBuffer(t)},i)}},{key:"buffered",value:function e(){if(!this.sourceBuffer_){return Ts.createTimeRanges()}return this.sourceBuffer_.buffered}},{key:"remove",value:function e(t,i){var r=this;var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:jd;if(this.processedAppend_){this.queueCallback_(function(){r.logger_("remove ["+t+" => "+i+"]");r.sourceBuffer_.remove(t,i)},n)}}},{key:"updating",value:function e(){return!this.sourceBuffer_||this.sourceBuffer_.updating||this.pendingCallback_}},{key:"timestampOffset",value:function e(t){var i=this;if(typeof t!=="undefined"){this.queueCallback_(function(){i.sourceBuffer_.timestampOffset=t});this.timestampOffset_=t}return this.timestampOffset_}},{key:"queueCallback_",value:function e(t,i){this.callbacks_.push([t.bind(this),i]);this.runCallback_()}},{key:"runCallback_",value:function e(){var t=void 0;if(!this.updating()&&this.callbacks_.length&&this.started_){t=this.callbacks_.shift();this.pendingCallback_=t[1];t[0]()}}},{key:"dispose",value:function e(){this.sourceBuffer_.removeEventListener("updateend",this.onUpdateendCallback_);if(this.sourceBuffer_&&this.mediaSource.readyState==="open"){this.sourceBuffer_.abort()}}}]);return n}();var Vd={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,BUFFER_LOW_WATER_LINE_RATE:1};var Hd={FAILURE:2,TIMEOUT:-101,ABORTED:-102};var qd=function e(t){var i=void 0;var r=void 0;r=t.offset+t.length-1;i=t.offset;return"bytes="+i+"-"+r};var zd=function e(t){var i={};if(t.byterange){i.Range=qd(t.byterange)}return i};var Wd=function e(t){t.forEach(function(e){e.abort()})};var Gd=function e(t){return{bandwidth:t.bandwidth,bytesReceived:t.bytesReceived||0,roundTripTime:t.roundTripTime||0}};var Xd=function e(t){var i=t.target;var r=Date.now()-i.requestTime;var n={bandwidth:Infinity,bytesReceived:0,roundTripTime:r||0};n.bytesReceived=t.loaded;n.bandwidth=Math.floor(n.bytesReceived/n.roundTripTime*8*1e3);return n};var Yd=function e(t,i){if(i.timedout){return{status:i.status,message:"HLS request timed-out at URL: "+i.uri,code:Hd.TIMEOUT,xhr:i}}if(i.aborted){return{status:i.status,message:"HLS request aborted at URL: "+i.uri,code:Hd.ABORTED,xhr:i}}if(t){return{status:i.status,message:"HLS request errored at URL: "+i.uri,code:Hd.FAILURE,xhr:i}}return null};var $d=function e(a,s){return function(e,t){var i=t.response;var r=Yd(e,t);if(r){return s(r,a)}if(i.byteLength!==16){return s({status:t.status,message:"Invalid HLS key at URL: "+t.uri,code:Hd.FAILURE,xhr:t},a)}var n=new DataView(i);a.key.bytes=new Uint32Array([n.getUint32(0),n.getUint32(4),n.getUint32(8),n.getUint32(12)]);return s(null,a)}};var Kd=function e(n,a,s){return function(e,t){var i=t.response;var r=Yd(e,t);if(r){return s(r,n)}if(i.byteLength===0){return s({status:t.status,message:"Empty HLS segment content at URL: "+t.uri,code:Hd.FAILURE,xhr:t},n)}n.map.bytes=new Uint8Array(t.response);if(!a.isInitialized()){a.init()}n.map.timescales=zo.timescale(n.map.bytes);n.map.videoTrackIds=zo.videoTrackIds(n.map.bytes);return s(null,n)}};var Jd=function e(a,s,o){return function(e,t){var i=t.response;var r=Yd(e,t);var n=void 0;if(r){return o(r,a)}if(i.byteLength===0){return o({status:t.status,message:"Empty HLS segment content at URL: "+t.uri,code:Hd.FAILURE,xhr:t},a)}a.stats=Gd(t);if(a.key){a.encryptedBytes=new Uint8Array(t.response)}else{a.bytes=new Uint8Array(t.response)}if(a.map&&a.map.bytes){if(!s.isInitialized()){s.init()}n=s.parse(a.bytes,a.map.videoTrackIds,a.map.timescales);if(n&&n.captions){a.captionStreams=n.captionStreams;a.fmp4Captions=n.captions}}return o(null,a)}};var Qd=function e(r,n,a){var t=function e(t){if(t.data.source===n.requestId){r.removeEventListener("message",e);var i=t.data.decrypted;n.bytes=new Uint8Array(i.bytes,i.byteOffset,i.byteLength);return a(null,n)}};r.addEventListener("message",t);r.postMessage(kh({source:n.requestId,encrypted:n.encryptedBytes,key:n.key.bytes,iv:n.key.iv}),[n.encryptedBytes.buffer,n.key.bytes.buffer])};var Zd=function e(i,r,n){var a=0;var s=false;return function(e,t){if(s){return}if(e){s=true;Wd(i);return n(e,t)}a+=1;if(a===i.length){t.endOfAllRequests=Date.now();if(t.encryptedBytes){return Qd(r,t,n)}return n(null,t)}}};var ep=function e(t,i){return function(e){t.stats=Ts.mergeOptions(t.stats,Xd(e));if(!t.stats.firstBytesReceivedAt&&t.stats.bytesReceived){t.stats.firstBytesReceivedAt=Date.now()}return i(e,t)}};var tp=function e(t,i,r,n,a,s,o){var u=[];var l=Zd(u,r,o);if(a.key){var c=Ts.mergeOptions(i,{uri:a.key.resolvedUri,responseType:"arraybuffer"});var f=$d(a,l);var h=t(c,f);u.push(h)}if(a.map&&!a.map.bytes){var d=Ts.mergeOptions(i,{uri:a.map.resolvedUri,responseType:"arraybuffer",headers:zd(a.map)});var p=Kd(a,n,l);var m=t(d,p);u.push(m)}var v=Ts.mergeOptions(i,{uri:a.resolvedUri,responseType:"arraybuffer",headers:zd(a)});var g=Jd(a,n,l);var y=t(v,g);y.addEventListener("progress",ep(a,s));u.push(y);return function(){return Wd(u)}};var ip=function e(t,i){var r=void 0;if(!t){return""}r=_.getComputedStyle(t);if(!r){return""}return r[i]};var rp=function e(t,r){var n=t.slice();t.sort(function(e,t){var i=r(e,t);if(i===0){return n.indexOf(e)-n.indexOf(t)}return i})};var np=function e(t,i){var r=void 0;var n=void 0;if(t.attributes.BANDWIDTH){r=t.attributes.BANDWIDTH}r=r||_.Number.MAX_VALUE;if(i.attributes.BANDWIDTH){n=i.attributes.BANDWIDTH}n=n||_.Number.MAX_VALUE;return r-n};var ap=function e(t,i){var r=void 0;var n=void 0;if(t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width){r=t.attributes.RESOLUTION.width}r=r||_.Number.MAX_VALUE;if(i.attributes.RESOLUTION&&i.attributes.RESOLUTION.width){n=i.attributes.RESOLUTION.width}n=n||_.Number.MAX_VALUE;if(r===n&&t.attributes.BANDWIDTH&&i.attributes.BANDWIDTH){return t.attributes.BANDWIDTH-i.attributes.BANDWIDTH}return r-n};var sp=function e(t,i,r,n,a){var s=t.playlists.map(function(e){var t=void 0;var i=void 0;var r=void 0;t=e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width;i=e.attributes.RESOLUTION&&e.attributes.RESOLUTION.height;r=e.attributes.BANDWIDTH;r=r||_.Number.MAX_VALUE;return{bandwidth:r,width:t,height:i,playlist:e}});rp(s,function(e,t){return e.bandwidth-t.bandwidth});s=s.filter(function(e){return!vh.isIncompatible(e.playlist)});var o=s.filter(function(e){return vh.isEnabled(e.playlist)});if(!o.length){o=s.filter(function(e){return!vh.isDisabled(e.playlist)})}var u=o.filter(function(e){return e.bandwidth*Vd.BANDWIDTH_VARIANCE<i});var l=u[u.length-1];var c=u.filter(function(e){return e.bandwidth===l.bandwidth})[0];if(a===false){var f=c||o[0]||s[0];return f?f.playlist:null}var h=u.filter(function(e){return e.width&&e.height});rp(h,function(e,t){return e.width-t.width});var d=h.filter(function(e){return e.width===r&&e.height===n});l=d[d.length-1];var p=d.filter(function(e){return e.bandwidth===l.bandwidth})[0];var m=void 0;var v=void 0;var g=void 0;if(!p){m=h.filter(function(e){return e.width>r||e.height>n});v=m.filter(function(e){return e.width===m[0].width&&e.height===m[0].height});l=v[v.length-1];g=v.filter(function(e){return e.bandwidth===l.bandwidth})[0]}var y=g||p||c||o[0]||s[0];return y?y.playlist:null};var op=function e(){return sp(this.playlists.master,this.systemBandwidth,parseInt(ip(this.tech_.el(),"width"),10),parseInt(ip(this.tech_.el(),"height"),10),this.limitRenditionByPlayerDimensions)};var up=function e(t){var i=t.master,a=t.currentTime,s=t.bandwidth,o=t.duration,u=t.segmentDuration,l=t.timeUntilRebuffer,c=t.currentTimeline,f=t.syncController;var r=i.playlists.filter(function(e){return!vh.isIncompatible(e)});var n=r.filter(vh.isEnabled);if(!n.length){n=r.filter(function(e){return!vh.isDisabled(e)})}var h=n.filter(vh.hasAttribute.bind(null,"BANDWIDTH"));var d=h.map(function(e){var t=f.getSyncPoint(e,o,c,a);var i=t?1:2;var r=vh.estimateSegmentRequestTime(u,s,e);var n=r*i-l;return{playlist:e,rebufferingImpact:n}});var p=d.filter(function(e){return e.rebufferingImpact<=0});rp(p,function(e,t){return np(t.playlist,e.playlist)});if(p.length){return p[0]}rp(d,function(e,t){return e.rebufferingImpact-t.rebufferingImpact});return d[0]||null};var lp=function e(){var t=this.playlists.master.playlists.filter(vh.isEnabled);rp(t,function(e,t){return np(e,t)});var i=t.filter(function(e){return hd(e.attributes.CODECS).videoCodec});return i[0]||null};var cp=function e(t,i,r){for(var n in r){if(!t[n]){i.trigger({type:"usage",name:"hls-608"});var a=i.textTracks().getTrackById(n);if(a){t[n]=a}else{t[n]=i.addRemoteTextTrack({kind:"captions",id:n,label:n},false).track}}}};var fp=function e(t){var n=t.inbandTextTracks,i=t.captionArray,a=t.timestampOffset;if(!i){return}var s=window.WebKitDataCue||window.VTTCue;i.forEach(function(e){var t=e.stream;var i=e.startTime;var r=e.endTime;if(!n[t]){return}i+=a;r+=a;n[t].addCue(new s(i,r,e.text))})};var hp=500;var dp=function e(t,i,r){if(!t||!i){return false}var n=t.segments;var a=r===n.length;return t.endList&&i.readyState==="open"&&a};var pp=function e(t){return typeof t==="number"&&isFinite(t)};var mp=function e(t,i,r){if(t!=="main"||!i||!r){return null}if(!r.containsAudio&&!r.containsVideo){return"Neither audio nor video found in segment."}if(i.containsVideo&&!r.containsVideo){return"Only audio found in segment when we expected video."+" We can't switch to audio only from a stream that had video."+" To get rid of this message, please add codec information to the manifest."}if(!i.containsVideo&&r.containsVideo){return"Video found in segment when we expected only audio."+" We can't switch to a stream with video from an audio only stream."+" To get rid of this message, please add codec information to the manifest."}return null};var vp=function e(t,i,r){var n=void 0;if(t.length&&t.start(0)>0&&t.start(0)<i){n=t.start(0)}else{n=i-30}return Math.min(n,i-r)};var gp=function e(t){var i=t.segment,r=i.start,n=i.end,a=t.playlist,s=a.mediaSequence,o=a.id,u=a.segments,l=u===undefined?[]:u,c=t.mediaIndex,f=t.timeline;return["appending ["+c+"] of ["+s+", "+(s+l.length)+"] from playlist ["+o+"]","["+r+" => "+n+"] in timeline ["+f+"]"].join(" ")};var yp=function(e){Df(i,e);function i(e){Of(this,i);var t=xf(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));if(!e){throw new TypeError("Initialization settings are required")}if(typeof e.currentTime!=="function"){throw new TypeError("No currentTime getter specified")}if(!e.mediaSource){throw new TypeError("No MediaSource specified")}t.bandwidth=e.bandwidth;t.throughput={rate:0,count:0};t.roundTrip=NaN;t.resetStats_();t.mediaIndex=null;t.hasPlayed_=e.hasPlayed;t.currentTime_=e.currentTime;t.seekable_=e.seekable;t.seeking_=e.seeking;t.duration_=e.duration;t.mediaSource_=e.mediaSource;t.hls_=e.hls;t.loaderType_=e.loaderType;t.startingMedia_=void 0;t.segmentMetadataTrack_=e.segmentMetadataTrack;t.goalBufferLength_=e.goalBufferLength;t.sourceType_=e.sourceType;t.inbandTextTracks_=e.inbandTextTracks;t.state_="INIT";t.checkBufferTimeout_=null;t.error_=void 0;t.currentTimeline_=-1;t.pendingSegment_=null;t.mimeType_=null;t.sourceUpdater_=null;t.xhrOptions_=null;t.activeInitSegmentId_=null;t.initSegments_={};t.captionParser_=new zc;t.decrypter_=e.decrypter;t.syncController_=e.syncController;t.syncPoint_={segmentIndex:0,time:0};t.syncController_.on("syncinfoupdate",function(){return t.trigger("syncinfoupdate")});t.mediaSource_.addEventListener("sourceopen",function(){return t.ended_=false});t.fetchAtBuffer_=false;t.logger_=Nd("SegmentLoader["+t.loaderType_+"]");Object.defineProperty(t,"state",{get:function e(){return this.state_},set:function e(t){if(t!==this.state_){this.logger_(this.state_+" -> "+t);this.state_=t}}});return t}Pf(i,[{key:"resetStats_",value:function e(){this.mediaBytesTransferred=0;this.mediaRequests=0;this.mediaRequestsAborted=0;this.mediaRequestsTimedout=0;this.mediaRequestsErrored=0;this.mediaTransferDuration=0;this.mediaSecondsLoaded=0}},{key:"dispose",value:function e(){this.state="DISPOSED";this.pause();this.abort_();if(this.sourceUpdater_){this.sourceUpdater_.dispose()}this.resetStats_();this.captionParser_.reset()}},{key:"abort",value:function e(){if(this.state!=="WAITING"){if(this.pendingSegment_){this.pendingSegment_=null}return}this.abort_();this.state="READY";if(!this.paused()){this.monitorBuffer_()}}},{key:"abort_",value:function e(){if(this.pendingSegment_){this.pendingSegment_.abortRequests()}this.pendingSegment_=null}},{key:"error",value:function e(t){if(typeof t!=="undefined"){this.error_=t}this.pendingSegment_=null;return this.error_}},{key:"endOfStream",value:function e(){this.ended_=true;this.pause();this.trigger("ended")}},{key:"buffered_",value:function e(){if(!this.sourceUpdater_){return Ts.createTimeRanges()}return this.sourceUpdater_.buffered()}},{key:"initSegment",value:function e(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!t){return null}var r=wh(t);var n=this.initSegments_[r];if(i&&!n&&t.bytes){this.initSegments_[r]=n={resolvedUri:t.resolvedUri,byterange:t.byterange,bytes:t.bytes,timescales:t.timescales,videoTrackIds:t.videoTrackIds}}return n||t}},{key:"couldBeginLoading_",value:function e(){return this.playlist_&&(this.sourceUpdater_||this.mimeType_&&this.state==="INIT")&&!this.paused()}},{key:"load",value:function e(){this.monitorBuffer_();if(!this.playlist_){return}this.syncController_.setDateTimeMapping(this.playlist_);if(this.state==="INIT"&&this.couldBeginLoading_()){return this.init_()}if(!this.couldBeginLoading_()||this.state!=="READY"&&this.state!=="INIT"){return}this.state="READY"}},{key:"init_",value:function e(){this.state="READY";this.sourceUpdater_=new Fd(this.mediaSource_,this.mimeType_,this.loaderType_,this.sourceBufferEmitter_);this.resetEverything();return this.monitorBuffer_()}},{key:"playlist",value:function e(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!t){return}var r=this.playlist_;var n=this.pendingSegment_;this.playlist_=t;this.xhrOptions_=i;if(!this.hasPlayed_()){t.syncInfo={mediaSequence:t.mediaSequence,time:0}}var a=r?r.id:null;this.logger_("playlist update ["+a+" => "+t.id+"]");this.trigger("syncinfoupdate");if(this.state==="INIT"&&this.couldBeginLoading_()){return this.init_()}if(!r||r.uri!==t.uri){if(this.mediaIndex!==null){this.resyncLoader()}return}var s=t.mediaSequence-r.mediaSequence;this.logger_("live window shift ["+s+"]");if(this.mediaIndex!==null){this.mediaIndex-=s}if(n){n.mediaIndex-=s;if(n.mediaIndex>=0){n.segment=t.segments[n.mediaIndex]}}this.syncController_.saveExpiredSegmentInfo(r,t)}},{key:"pause",value:function e(){if(this.checkBufferTimeout_){_.clearTimeout(this.checkBufferTimeout_);this.checkBufferTimeout_=null}}},{key:"paused",value:function e(){return this.checkBufferTimeout_===null}},{key:"mimeType",value:function e(t,i){if(this.mimeType_){return}this.mimeType_=t;this.sourceBufferEmitter_=i;if(this.state==="INIT"&&this.couldBeginLoading_()){this.init_()}}},{key:"resetEverything",value:function e(t){this.ended_=false;this.resetLoader();this.remove(0,this.duration_(),t);this.captionParser_.clearAllCaptions();this.trigger("reseteverything")}},{key:"resetLoader",value:function e(){this.fetchAtBuffer_=false;this.resyncLoader()}},{key:"resyncLoader",value:function e(){this.mediaIndex=null;this.syncPoint_=null;this.abort()}},{key:"remove",value:function e(t,i,r){if(this.sourceUpdater_){this.sourceUpdater_.remove(t,i,r)}Xh(t,i,this.segmentMetadataTrack_);if(this.inbandTextTracks_){for(var n in this.inbandTextTracks_){Xh(t,i,this.inbandTextTracks_[n])}}}},{key:"monitorBuffer_",value:function e(){if(this.checkBufferTimeout_){_.clearTimeout(this.checkBufferTimeout_)}this.checkBufferTimeout_=_.setTimeout(this.monitorBufferTick_.bind(this),1)}},{key:"monitorBufferTick_",value:function e(){if(this.state==="READY"){this.fillBuffer_()}if(this.checkBufferTimeout_){_.clearTimeout(this.checkBufferTimeout_)}this.checkBufferTimeout_=_.setTimeout(this.monitorBufferTick_.bind(this),hp)}},{key:"fillBuffer_",value:function e(){if(this.sourceUpdater_.updating()){return}if(!this.syncPoint_){this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_())}var t=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);if(!t){return}var i=dp(this.playlist_,this.mediaSource_,t.mediaIndex);if(i){this.endOfStream();return}if(t.mediaIndex===this.playlist_.segments.length-1&&this.mediaSource_.readyState==="ended"&&!this.seeking_()){return}if(t.timeline!==this.currentTimeline_||t.startOfSegment!==null&&t.startOfSegment<this.sourceUpdater_.timestampOffset()){this.syncController_.reset();t.timestampOffset=t.startOfSegment;this.captionParser_.clearAllCaptions()}this.loadSegment_(t)}},{key:"checkBuffer_",value:function e(t,i,r,n,a,s){var o=0;var u=void 0;if(t.length){o=t.end(t.length-1)}var l=Math.max(0,o-a);if(!i.segments.length){return null}if(l>=this.goalBufferLength_()){return null}if(!n&&l>=1){return null}if(s===null){r=this.getSyncSegmentCandidate_(i);return this.generateSegmentInfo_(i,r,null,true)}if(r!==null){var c=i.segments[r];if(c&&c.end){u=c.end}else{u=o}return this.generateSegmentInfo_(i,r+1,u,false)}if(this.fetchAtBuffer_){var f=vh.getMediaInfoForTime(i,o,s.segmentIndex,s.time);r=f.mediaIndex;u=f.startTime}else{var h=vh.getMediaInfoForTime(i,a,s.segmentIndex,s.time);r=h.mediaIndex;u=h.startTime}return this.generateSegmentInfo_(i,r,u,false)}},{key:"getSyncSegmentCandidate_",value:function e(t){var i=this;if(this.currentTimeline_===-1){return 0}var r=t.segments.map(function(e,t){return{timeline:e.timeline,segmentIndex:t}}).filter(function(e){return e.timeline===i.currentTimeline_});if(r.length){return r[Math.min(r.length-1,1)].segmentIndex}return Math.max(t.segments.length-1,0)}},{key:"generateSegmentInfo_",value:function e(t,i,r,n){if(i<0||i>=t.segments.length){return null}var a=t.segments[i];return{requestId:"segment-loader-"+Math.random(),uri:a.resolvedUri,mediaIndex:i,isSyncRequest:n,startOfSegment:r,playlist:t,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:a.timeline,duration:a.duration,segment:a}}},{key:"abortRequestEarly_",value:function e(t){if(this.hls_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH){return false}if(Date.now()-(t.firstBytesReceivedAt||Date.now())<1e3){return false}var i=this.currentTime_();var r=t.bandwidth;var n=this.pendingSegment_.duration;var a=vh.estimateSegmentRequestTime(n,r,this.playlist_,t.bytesReceived);var s=zh(this.buffered_(),i,this.hls_.tech_.playbackRate())-1;if(a<=s){return false}var o=up({master:this.hls_.playlists.master,currentTime:i,bandwidth:r,duration:this.duration_(),segmentDuration:n,timeUntilRebuffer:s,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(!o){return}var u=a-s;var l=u-o.rebufferingImpact;var c=.5;if(s<=Bh){c=1}if(!o.playlist||o.playlist.uri===this.playlist_.uri||l<c){return false}this.bandwidth=o.playlist.attributes.BANDWIDTH*Vd.BANDWIDTH_VARIANCE+1;this.abort();this.trigger("earlyabort");return true}},{key:"handleProgress_",value:function e(t,i){if(!this.pendingSegment_||i.requestId!==this.pendingSegment_.requestId||this.abortRequestEarly_(i.stats)){return}this.trigger("progress")}},{key:"loadSegment_",value:function e(t){this.state="WAITING";this.pendingSegment_=t;this.trimBackBuffer_(t);t.abortRequests=tp(this.hls_.xhr,this.xhrOptions_,this.decrypter_,this.captionParser_,this.createSimplifiedSegmentObj_(t),this.handleProgress_.bind(this),this.segmentRequestFinished_.bind(this))}},{key:"trimBackBuffer_",value:function e(t){var i=vp(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);if(i>0){this.remove(0,i)}}},{key:"createSimplifiedSegmentObj_",value:function e(t){var i=t.segment;var r={resolvedUri:i.resolvedUri,byterange:i.byterange,requestId:t.requestId};if(i.key){var n=i.key.iv||new Uint32Array([0,0,0,t.mediaIndex+t.playlist.mediaSequence]);r.key={resolvedUri:i.key.resolvedUri,iv:n}}if(i.map){r.map=this.initSegment(i.map)}return r}},{key:"segmentRequestFinished_",value:function e(t,i){this.mediaRequests+=1;if(i.stats){this.mediaBytesTransferred+=i.stats.bytesReceived;this.mediaTransferDuration+=i.stats.roundTripTime}if(!this.pendingSegment_){this.mediaRequestsAborted+=1;return}if(i.requestId!==this.pendingSegment_.requestId){return}if(t){this.pendingSegment_=null;this.state="READY";if(t.code===Hd.ABORTED){this.mediaRequestsAborted+=1;return}this.pause();if(t.code===Hd.TIMEOUT){this.mediaRequestsTimedout+=1;this.bandwidth=1;this.roundTrip=NaN;this.trigger("bandwidthupdate");return}this.mediaRequestsErrored+=1;this.error(t);this.trigger("error");return}this.bandwidth=i.stats.bandwidth;this.roundTrip=i.stats.roundTripTime;if(i.map){i.map=this.initSegment(i.map,true)}this.processSegmentResponse_(i)}},{key:"processSegmentResponse_",value:function e(t){var i=this.pendingSegment_;i.bytes=t.bytes;if(t.map){i.segment.map.bytes=t.map.bytes}i.endOfAllRequests=t.endOfAllRequests;if(t.fmp4Captions){cp(this.inbandTextTracks_,this.hls_.tech_,t.captionStreams);fp({inbandTextTracks:this.inbandTextTracks_,captionArray:t.fmp4Captions,timestampOffset:0});this.captionParser_.clearParsedCaptions()}this.handleSegment_()}},{key:"handleSegment_",value:function e(){var t=this;if(!this.pendingSegment_){this.state="READY";return}var i=this.pendingSegment_;var r=i.segment;var n=this.syncController_.probeSegmentInfo(i);if(typeof this.startingMedia_==="undefined"&&n&&(n.containsAudio||n.containsVideo)){this.startingMedia_={containsAudio:n.containsAudio,containsVideo:n.containsVideo}}var a=mp(this.loaderType_,this.startingMedia_,n);if(a){this.error({message:a,blacklistDuration:Infinity});this.trigger("error");return}if(i.isSyncRequest){this.trigger("syncinfoupdate");this.pendingSegment_=null;this.state="READY";return}if(i.timestampOffset!==null&&i.timestampOffset!==this.sourceUpdater_.timestampOffset()){this.sourceUpdater_.timestampOffset(i.timestampOffset);this.trigger("timestampoffset")}var s=this.syncController_.mappingForTimeline(i.timeline);if(s!==null){this.trigger({type:"segmenttimemapping",mapping:s})}this.state="APPENDING";if(r.map){var o=wh(r.map);if(!this.activeInitSegmentId_||this.activeInitSegmentId_!==o){var u=this.initSegment(r.map);this.sourceUpdater_.appendBuffer(u.bytes,function(){t.activeInitSegmentId_=o})}}i.byteLength=i.bytes.byteLength;if(typeof r.start==="number"&&typeof r.end==="number"){this.mediaSecondsLoaded+=r.end-r.start}else{this.mediaSecondsLoaded+=r.duration}this.logger_(gp(i));this.sourceUpdater_.appendBuffer(i.bytes,this.handleUpdateEnd_.bind(this))}},{key:"handleUpdateEnd_",value:function e(){if(!this.pendingSegment_){this.state="READY";if(!this.paused()){this.monitorBuffer_()}return}var t=this.pendingSegment_;var i=t.segment;var r=this.mediaIndex!==null;this.pendingSegment_=null;this.recordThroughput_(t);this.addSegmentMetadataCue_(t);this.state="READY";this.mediaIndex=t.mediaIndex;this.fetchAtBuffer_=true;this.currentTimeline_=t.timeline;this.trigger("syncinfoupdate");if(i.end&&this.currentTime_()-i.end>t.playlist.targetDuration*3){this.resetEverything();return}if(r){this.trigger("bandwidthupdate")}this.trigger("progress");var n=dp(t.playlist,this.mediaSource_,t.mediaIndex+1);if(n){this.endOfStream()}if(!this.paused()){this.monitorBuffer_()}}},{key:"recordThroughput_",value:function e(t){var i=this.throughput.rate;var r=Date.now()-t.endOfAllRequests+1;var n=Math.floor(t.byteLength/r*8*1e3);this.throughput.rate+=(n-i)/++this.throughput.count}},{key:"addSegmentMetadataCue_",value:function e(t){if(!this.segmentMetadataTrack_){return}var i=t.segment;var r=i.start;var n=i.end;if(!pp(r)||!pp(n)){return}Xh(r,n,this.segmentMetadataTrack_);var a=_.WebKitDataCue||_.VTTCue;var s={dateTimeObject:i.dateTimeObject,dateTimeString:i.dateTimeString,bandwidth:t.playlist.attributes.BANDWIDTH,resolution:t.playlist.attributes.RESOLUTION,codecs:t.playlist.attributes.CODECS,byteLength:t.byteLength,uri:t.uri,timeline:t.timeline,playlist:t.playlist.uri,start:r,end:n};var o=JSON.stringify(s);var u=new a(r,n,o);u.value=s;this.segmentMetadataTrack_.addCue(u)}}]);return i}(Ts.EventTarget);var _p=function e(t){return decodeURIComponent(escape(String.fromCharCode.apply(null,t)))};var bp=new Uint8Array("\n\n".split("").map(function(e){return e.charCodeAt(0)}));var Tp=function(e){Df(r,e);function r(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};Of(this,r);var i=xf(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e,t));i.mediaSource_=null;i.subtitlesTrack_=null;return i}Pf(r,[{key:"buffered_",value:function e(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues.length){return Ts.createTimeRanges()}var t=this.subtitlesTrack_.cues;var i=t[0].startTime;var r=t[t.length-1].startTime;return Ts.createTimeRanges([[i,r]])}},{key:"initSegment",value:function e(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!t){return null}var r=wh(t);var n=this.initSegments_[r];if(i&&!n&&t.bytes){var a=bp.byteLength+t.bytes.byteLength;var s=new Uint8Array(a);s.set(t.bytes);s.set(bp,t.bytes.byteLength);this.initSegments_[r]=n={resolvedUri:t.resolvedUri,byterange:t.byterange,bytes:s}}return n||t}},{key:"couldBeginLoading_",value:function e(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}},{key:"init_",value:function e(){this.state="READY";this.resetEverything();return this.monitorBuffer_()}},{key:"track",value:function e(t){if(typeof t==="undefined"){return this.subtitlesTrack_}this.subtitlesTrack_=t;if(this.state==="INIT"&&this.couldBeginLoading_()){this.init_()}return this.subtitlesTrack_}},{key:"remove",value:function e(t,i){Xh(t,i,this.subtitlesTrack_)}},{key:"fillBuffer_",value:function e(){var t=this;if(!this.syncPoint_){this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_())}var i=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);i=this.skipEmptySegments_(i);if(!i){return}if(this.syncController_.timestampOffsetForTimeline(i.timeline)===null){var r=function e(){t.state="READY";if(!t.paused()){t.monitorBuffer_()}};this.syncController_.one("timestampoffset",r);this.state="WAITING_ON_TIMELINE";return}this.loadSegment_(i)}},{key:"skipEmptySegments_",value:function e(t){while(t&&t.segment.empty){t=this.generateSegmentInfo_(t.playlist,t.mediaIndex+1,t.startOfSegment+t.duration,t.isSyncRequest)}return t}},{key:"handleSegment_",value:function e(){var t=this;if(!this.pendingSegment_||!this.subtitlesTrack_){this.state="READY";return}this.state="APPENDING";var i=this.pendingSegment_;var r=i.segment;if(typeof _.WebVTT!=="function"&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){var n=function e(){t.handleSegment_()};this.state="WAITING_ON_VTTJS";this.subtitlesTrack_.tech_.one("vttjsloaded",n);this.subtitlesTrack_.tech_.one("vttjserror",function(){t.subtitlesTrack_.tech_.off("vttjsloaded",n);t.error({message:"Error loading vtt.js"});t.state="READY";t.pause();t.trigger("error")});return}r.requested=true;try{this.parseVTTCues_(i)}catch(e){this.error({message:e.message});this.state="READY";this.pause();return this.trigger("error")}this.updateTimeMapping_(i,this.syncController_.timelines[i.timeline],this.playlist_);if(i.isSyncRequest){this.trigger("syncinfoupdate");this.pendingSegment_=null;this.state="READY";return}i.byteLength=i.bytes.byteLength;this.mediaSecondsLoaded+=r.duration;if(i.cues.length){this.remove(i.cues[0].endTime,i.cues[i.cues.length-1].endTime)}i.cues.forEach(function(e){t.subtitlesTrack_.addCue(e)});this.handleUpdateEnd_()}},{key:"parseVTTCues_",value:function e(t){var i=void 0;var r=false;if(typeof _.TextDecoder==="function"){i=new _.TextDecoder("utf8")}else{i=_.WebVTT.StringDecoder();r=true}var n=new _.WebVTT.Parser(_,_.vttjs,i);t.cues=[];t.timestampmap={MPEGTS:0,LOCAL:0};n.oncue=t.cues.push.bind(t.cues);n.ontimestampmap=function(e){return t.timestampmap=e};n.onparsingerror=function(e){Ts.log.warn("Error encountered when parsing cues: "+e.message)};if(t.segment.map){var a=t.segment.map.bytes;if(r){a=_p(a)}n.parse(a)}var s=t.bytes;if(r){s=_p(s)}n.parse(s);n.flush()}},{key:"updateTimeMapping_",value:function e(t,i,r){var n=t.segment;if(!i){return}if(!t.cues.length){n.empty=true;return}var a=t.timestampmap;var s=a.MPEGTS/9e4-a.LOCAL+i.mapping;t.cues.forEach(function(e){e.startTime+=s;e.endTime+=s});if(!r.syncInfo){var o=t.cues[0].startTime;var u=t.cues[t.cues.length-1].startTime;r.syncInfo={mediaSequence:r.mediaSequence+t.mediaIndex,time:Math.min(o,u-n.duration)}}}}]);return r}(yp);var Sp=function e(t,i){var r=t.cues;for(var n=0;n<r.length;n++){var a=r[n];if(i>=a.adStartTime&&i<=a.adEndTime){return a}}return null};var kp=function e(t,i){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;if(!t.segments){return}var n=r;var a=void 0;for(var s=0;s<t.segments.length;s++){var o=t.segments[s];if(!a){a=Sp(i,n+o.duration/2)}if(a){if("cueIn"in o){a.endTime=n;a.adEndTime=n;n+=o.duration;a=null;continue}if(n<a.endTime){n+=o.duration;continue}a.endTime+=o.duration}else{if("cueOut"in o){a=new _.VTTCue(n,n+o.duration,o.cueOut);a.adStartTime=n;a.adEndTime=n+parseFloat(o.cueOut);i.addCue(a)}if("cueOutCont"in o){var u=void 0;var l=void 0;var c=o.cueOutCont.split("/").map(parseFloat);var f=Rf(c,2);u=f[0];l=f[1];a=new _.VTTCue(n,n+o.duration,"");a.adStartTime=n-u;a.adEndTime=a.adStartTime+l;i.addCue(a)}}n+=o.duration}};var wp=mf.inspect;var Cp=[{name:"VOD",run:function e(t,i,r,n,a){if(r!==Infinity){var s={time:0,segmentIndex:0};return s}return null}},{name:"ProgramDateTime",run:function e(t,i,r,n,a){if(!t.datetimeToDisplayTime){return null}var s=i.segments||[];var o=null;var u=null;a=a||0;for(var l=0;l<s.length;l++){var c=s[l];if(c.dateTimeObject){var f=c.dateTimeObject.getTime()/1e3;var h=f+t.datetimeToDisplayTime;var d=Math.abs(a-h);if(u!==null&&u<d){break}u=d;o={time:h,segmentIndex:l}}}return o}},{name:"Segment",run:function e(t,i,r,n,a){var s=i.segments||[];var o=null;var u=null;a=a||0;for(var l=0;l<s.length;l++){var c=s[l];if(c.timeline===n&&typeof c.start!=="undefined"){var f=Math.abs(a-c.start);if(u!==null&&u<f){break}if(!o||u===null||u>=f){u=f;o={time:c.start,segmentIndex:l}}}}return o}},{name:"Discontinuity",run:function e(t,i,r,n,a){var s=null;a=a||0;if(i.discontinuityStarts&&i.discontinuityStarts.length){var o=null;for(var u=0;u<i.discontinuityStarts.length;u++){var l=i.discontinuityStarts[u];var c=i.discontinuitySequence+u+1;var f=t.discontinuities[c];if(f){var h=Math.abs(a-f.time);if(o!==null&&o<h){break}if(!s||o===null||o>=h){o=h;s={time:f.time,segmentIndex:l}}}}}return s}},{name:"Playlist",run:function e(t,i,r,n,a){if(i.syncInfo){var s={time:i.syncInfo.time,segmentIndex:i.syncInfo.mediaSequence-i.mediaSequence};return s}return null}}];var Ep=function(e){Df(t,e);function t(){Of(this,t);var e=xf(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e.inspectCache_=undefined;e.timelines=[];e.discontinuities=[];e.datetimeToDisplayTime=null;e.logger_=Nd("SyncController");return e}Pf(t,[{key:"getSyncPoint",value:function e(t,i,r,n){var a=this.runStrategies_(t,i,r,n);if(!a.length){return null}return this.selectSyncPoint_(a,{key:"time",value:n})}},{key:"getExpiredTime",value:function e(t,i){if(!t||!t.segments){return null}var r=this.runStrategies_(t,i,t.discontinuitySequence,0);if(!r.length){return null}var n=this.selectSyncPoint_(r,{key:"segmentIndex",value:0});if(n.segmentIndex>0){n.time*=-1}return Math.abs(n.time+Qf(t,n.segmentIndex,0))}},{key:"runStrategies_",value:function e(t,i,r,n){var a=[];for(var s=0;s<Cp.length;s++){var o=Cp[s];var u=o.run(this,t,i,r,n);if(u){u.strategy=o.name;a.push({strategy:o.name,syncPoint:u})}}return a}},{key:"selectSyncPoint_",value:function e(t,i){var r=t[0].syncPoint;var n=Math.abs(t[0].syncPoint[i.key]-i.value);var a=t[0].strategy;for(var s=1;s<t.length;s++){var o=Math.abs(t[s].syncPoint[i.key]-i.value);if(o<n){n=o;r=t[s].syncPoint;a=t[s].strategy}}this.logger_("syncPoint for ["+i.key+": "+i.value+"] chosen with strategy"+(" ["+a+"]: [time:"+r.time+",")+(" segmentIndex:"+r.segmentIndex+"]"));return r}},{key:"saveExpiredSegmentInfo",value:function e(t,i){var r=i.mediaSequence-t.mediaSequence;for(var n=r-1;n>=0;n--){var a=t.segments[n];if(a&&typeof a.start!=="undefined"){i.syncInfo={mediaSequence:t.mediaSequence+n,time:a.start};this.logger_("playlist refresh sync: [time:"+i.syncInfo.time+","+(" mediaSequence: "+i.syncInfo.mediaSequence+"]"));this.trigger("syncinfoupdate");break}}}},{key:"setDateTimeMapping",value:function e(t){if(!this.datetimeToDisplayTime&&t.segments&&t.segments.length&&t.segments[0].dateTimeObject){var i=t.segments[0].dateTimeObject.getTime()/1e3;this.datetimeToDisplayTime=-i}}},{key:"reset",value:function e(){this.inspectCache_=undefined}},{key:"probeSegmentInfo",value:function e(t){var i=t.segment;var r=t.playlist;var n=void 0;if(i.map){n=this.probeMp4Segment_(t)}else{n=this.probeTsSegment_(t)}if(n){if(this.calculateSegmentTimeMapping_(t,n)){this.saveDiscontinuitySyncInfo_(t);if(!r.syncInfo){r.syncInfo={mediaSequence:r.mediaSequence+t.mediaIndex,time:i.start}}}}return n}},{key:"probeMp4Segment_",value:function e(t){var i=t.segment;var r=zo.timescale(i.map.bytes);var n=zo.startTime(r,t.bytes);if(t.timestampOffset!==null){t.timestampOffset-=n}return{start:n,end:n+i.duration}}},{key:"probeTsSegment_",value:function e(t){var i=wp(t.bytes,this.inspectCache_);var r=void 0;var n=void 0;if(!i){return null}if(i.video&&i.video.length===2){this.inspectCache_=i.video[1].dts;r=i.video[0].dtsTime;n=i.video[1].dtsTime}else if(i.audio&&i.audio.length===2){this.inspectCache_=i.audio[1].dts;r=i.audio[0].dtsTime;n=i.audio[1].dtsTime}return{start:r,end:n,containsVideo:i.video&&i.video.length===2,containsAudio:i.audio&&i.audio.length===2}}},{key:"timestampOffsetForTimeline",value:function e(t){if(typeof this.timelines[t]==="undefined"){return null}return this.timelines[t].time}},{key:"mappingForTimeline",value:function e(t){if(typeof this.timelines[t]==="undefined"){return null}return this.timelines[t].mapping}},{key:"calculateSegmentTimeMapping_",value:function e(t,i){var r=t.segment;var n=this.timelines[t.timeline];if(t.timestampOffset!==null){n={time:t.startOfSegment,mapping:t.startOfSegment-i.start};this.timelines[t.timeline]=n;this.trigger("timestampoffset");this.logger_("time mapping for timeline "+t.timeline+": "+("[time: "+n.time+"] [mapping: "+n.mapping+"]"));r.start=t.startOfSegment;r.end=i.end+n.mapping}else if(n){r.start=i.start+n.mapping;r.end=i.end+n.mapping}else{return false}return true}},{key:"saveDiscontinuitySyncInfo_",value:function e(t){var i=t.playlist;var r=t.segment;if(r.discontinuity){this.discontinuities[r.timeline]={time:r.start,accuracy:0}}else if(i.discontinuityStarts&&i.discontinuityStarts.length){for(var n=0;n<i.discontinuityStarts.length;n++){var a=i.discontinuityStarts[n];var s=i.discontinuitySequence+n+1;var o=a-t.mediaIndex;var u=Math.abs(o);if(!this.discontinuities[s]||this.discontinuities[s].accuracy>u){var l=void 0;if(o<0){l=r.start-Qf(i,t.mediaIndex,a)}else{l=r.end+Qf(i,t.mediaIndex+1,a)}this.discontinuities[s]={time:l,accuracy:u}}}}}}]);return t}(Ts.EventTarget);var Ap=new rd("./decrypter-worker.worker.js",function(e,t){var p=this;var i=function(){function l(e){return e.subarray(0,e.byteLength-e[e.byteLength-1])}var f=function e(t,i){if(!(t instanceof i)){throw new TypeError("Cannot call a class as a function")}};var e=function(){function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(e,t,i){if(t)r(e.prototype,t);if(i)r(e,i);return e}}();var r=function e(t,i){if(typeof i!=="function"&&i!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof i)}t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:false,writable:true,configurable:true}});if(i)Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i};var n=function e(t,i){if(!t){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return i&&(typeof i==="object"||typeof i==="function")?i:t};var h=function e(){var t=[[[],[],[],[],[]],[[],[],[],[],[]]];var i=t[0];var r=t[1];var n=i[4];var a=r[4];var s=void 0;var o=void 0;var u=void 0;var l=[];var c=[];var f=void 0;var h=void 0;var d=void 0;var p=void 0;var m=void 0;var v=void 0;for(s=0;s<256;s++){c[(l[s]=s<<1^(s>>7)*283)^s]=s}for(o=u=0;!n[o];o^=f||1,u=c[u]||1){p=u^u<<1^u<<2^u<<3^u<<4;p=p>>8^p&255^99;n[o]=p;a[p]=o;d=l[h=l[f=l[o]]];v=d*16843009^h*65537^f*257^o*16843008;m=l[p]*257^p*16843008;for(s=0;s<4;s++){i[s][o]=m=m<<24^m>>>8;r[s][p]=v=v<<24^v>>>8}}for(s=0;s<5;s++){i[s]=i[s].slice(0);r[s]=r[s].slice(0)}return t};var d=null;var g=function(){function c(e){f(this,c);if(!d){d=h()}this._tables=[[d[0][0].slice(),d[0][1].slice(),d[0][2].slice(),d[0][3].slice(),d[0][4].slice()],[d[1][0].slice(),d[1][1].slice(),d[1][2].slice(),d[1][3].slice(),d[1][4].slice()]];var t=void 0;var i=void 0;var r=void 0;var n=void 0;var a=void 0;var s=this._tables[0][4];var o=this._tables[1];var u=e.length;var l=1;if(u!==4&&u!==6&&u!==8){throw new Error("Invalid aes key size")}n=e.slice(0);a=[];this._key=[n,a];for(t=u;t<4*u+28;t++){r=n[t-1];if(t%u===0||u===8&&t%u===4){r=s[r>>>24]<<24^s[r>>16&255]<<16^s[r>>8&255]<<8^s[r&255];if(t%u===0){r=r<<8^r>>>24^l<<24;l=l<<1^(l>>7)*283}}n[t]=n[t-u]^r}for(i=0;t;i++,t--){r=n[i&3?t:t-4];if(t<=4||i<4){a[i]=r}else{a[i]=o[0][s[r>>>24]]^o[1][s[r>>16&255]]^o[2][s[r>>8&255]]^o[3][s[r&255]]}}}c.prototype.decrypt=function e(t,i,r,n,a,s){var o=this._key[1];var u=t^o[0];var l=n^o[1];var c=r^o[2];var f=i^o[3];var h=void 0;var d=void 0;var p=void 0;var m=o.length/4-2;var v=void 0;var g=4;var y=this._tables[1];var _=y[0];var b=y[1];var T=y[2];var S=y[3];var k=y[4];for(v=0;v<m;v++){h=_[u>>>24]^b[l>>16&255]^T[c>>8&255]^S[f&255]^o[g];d=_[l>>>24]^b[c>>16&255]^T[f>>8&255]^S[u&255]^o[g+1];p=_[c>>>24]^b[f>>16&255]^T[u>>8&255]^S[l&255]^o[g+2];f=_[f>>>24]^b[u>>16&255]^T[l>>8&255]^S[c&255]^o[g+3];g+=4;u=h;l=d;c=p}for(v=0;v<4;v++){a[(3&-v)+s]=k[u>>>24]<<24^k[l>>16&255]<<16^k[c>>8&255]<<8^k[f&255]^o[g++];h=u;u=l;l=c;c=f;f=h}};return c}();var a=function(){function e(){f(this,e);this.listeners={}}e.prototype.on=function e(t,i){if(!this.listeners[t]){this.listeners[t]=[]}this.listeners[t].push(i)};e.prototype.off=function e(t,i){if(!this.listeners[t]){return false}var r=this.listeners[t].indexOf(i);this.listeners[t].splice(r,1);return r>-1};e.prototype.trigger=function e(t){var i=this.listeners[t];if(!i){return}if(arguments.length===2){var r=i.length;for(var n=0;n<r;++n){i[n].call(this,arguments[1])}}else{var a=Array.prototype.slice.call(arguments,1);var s=i.length;for(var o=0;o<s;++o){i[o].apply(this,a)}}};e.prototype.dispose=function e(){this.listeners={}};e.prototype.pipe=function e(t){this.on("data",function(e){t.push(e)})};return e}();var c=function(t){r(i,t);function i(){f(this,i);var e=n(this,t.call(this,a));e.jobs=[];e.delay=1;e.timeout_=null;return e}i.prototype.processJob_=function e(){this.jobs.shift()();if(this.jobs.length){this.timeout_=setTimeout(this.processJob_.bind(this),this.delay)}else{this.timeout_=null}};i.prototype.push=function e(t){this.jobs.push(t);if(!this.timeout_){this.timeout_=setTimeout(this.processJob_.bind(this),this.delay)}};return i}(a);var y=function e(t){return t<<24|(t&65280)<<8|(t&16711680)>>8|t>>>24};var s=function e(t,i,r){var n=new Int32Array(t.buffer,t.byteOffset,t.byteLength>>2);var a=new g(Array.prototype.slice.call(i));var s=new Uint8Array(t.byteLength);var o=new Int32Array(s.buffer);var u=void 0;var l=void 0;var c=void 0;var f=void 0;var h=void 0;var d=void 0;var p=void 0;var m=void 0;var v=void 0;u=r[0];l=r[1];c=r[2];f=r[3];for(v=0;v<n.length;v+=4){h=y(n[v]);d=y(n[v+1]);p=y(n[v+2]);m=y(n[v+3]);a.decrypt(h,d,p,m,o,v);o[v]=y(o[v]^u);o[v+1]=y(o[v+1]^l);o[v+2]=y(o[v+2]^c);o[v+3]=y(o[v+3]^f);u=h;l=d;c=p;f=m}return s};var o=function(){function u(e,t,i,r){f(this,u);var n=u.STEP;var a=new Int32Array(e.buffer);var s=new Uint8Array(e.byteLength);var o=0;this.asyncStream_=new c;this.asyncStream_.push(this.decryptChunk_(a.subarray(o,o+n),t,i,s));for(o=n;o<a.length;o+=n){i=new Uint32Array([y(a[o-4]),y(a[o-3]),y(a[o-2]),y(a[o-1])]);this.asyncStream_.push(this.decryptChunk_(a.subarray(o,o+n),t,i,s))}this.asyncStream_.push(function(){r(null,l(s))})}u.prototype.decryptChunk_=function e(t,i,r,n){return function(){var e=s(t,i,r);n.set(e,t.byteOffset)}};e(u,null,[{key:"STEP",get:function e(){return 32e3}}]);return u}();var u=function e(i){var r={};Object.keys(i).forEach(function(e){var t=i[e];if(ArrayBuffer.isView(t)){r[e]={bytes:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength}}else{r[e]=t}});return r};var t=function e(a){a.onmessage=function(e){var i=e.data;var t=new Uint8Array(i.encrypted.bytes,i.encrypted.byteOffset,i.encrypted.byteLength);var r=new Uint32Array(i.key.bytes,i.key.byteOffset,i.key.byteLength/4);var n=new Uint32Array(i.iv.bytes,i.iv.byteOffset,i.iv.byteLength/4);new o(t,r,n,function(e,t){a.postMessage(u({source:i.source,decrypted:t}),[t.buffer])})}};var i=new t(p);return i}()});var Lp=function e(t){var i=t.default?"main":"alternative";if(t.characteristics&&t.characteristics.indexOf("public.accessibility.describes-video")>=0){i="main-desc"}return i};var Ip=function e(t,i){t.abort();t.pause();if(i&&i.activePlaylistLoader){i.activePlaylistLoader.pause();i.activePlaylistLoader=null}};var Op=function e(t,i){i.activePlaylistLoader=t;t.load()};var Pp=function e(o,u){return function(){var e=u.segmentLoaders,t=e[o],i=e.main,r=u.mediaTypes[o];var n=r.activeTrack();var a=r.activeGroup(n);var s=r.activePlaylistLoader;Ip(t,r);if(!a){return}if(!a.playlistLoader){if(s){i.resetEverything()}return}t.resyncLoader();Op(a.playlistLoader,r)}};var Up=function e(o,u){return function(){var e=u.segmentLoaders,t=e[o],i=e.main,r=u.mediaTypes[o];var n=r.activeTrack();var a=r.activeGroup(n);var s=r.activePlaylistLoader;Ip(t,r);if(!a){return}if(!a.playlistLoader){i.resetEverything();return}if(s===a.playlistLoader){Op(a.playlistLoader,r);return}if(t.track){t.track(n)}t.resetEverything();Op(a.playlistLoader,r)}};var Dp={AUDIO:function e(u,l){return function(){var e=l.segmentLoaders[u],t=l.mediaTypes[u],i=l.blacklistCurrentPlaylist;Ip(e,t);var r=t.activeTrack();var n=t.activeGroup();var a=(n.filter(function(e){return e.default})[0]||n[0]).id;var s=t.tracks[a];if(r===s){i({message:"Problem encountered loading the default audio track."});return}Ts.log.warn("Problem encountered loading the alternate audio track."+"Switching back to default.");for(var o in t.tracks){t.tracks[o].enabled=t.tracks[o]===s}t.onTrackChanged()}},SUBTITLES:function e(r,n){return function(){var e=n.segmentLoaders[r],t=n.mediaTypes[r];Ts.log.warn("Problem encountered loading the subtitle track."+"Disabling subtitle track.");Ip(e,t);var i=t.activeTrack();if(i){i.mode="disabled"}t.onTrackChanged()}}};var xp={AUDIO:function e(t,i,r){if(!i){return}var n=r.tech,a=r.requestOptions,s=r.segmentLoaders[t];i.on("loadedmetadata",function(){var e=i.media();s.playlist(e,a);if(!n.paused()||e.endList&&n.preload()!=="none"){s.load()}});i.on("loadedplaylist",function(){s.playlist(i.media(),a);if(!n.paused()){s.load()}});i.on("error",Dp[t](t,r))},SUBTITLES:function e(t,i,r){var n=r.tech,a=r.requestOptions,s=r.segmentLoaders[t],o=r.mediaTypes[t];i.on("loadedmetadata",function(){var e=i.media();s.playlist(e,a);s.track(o.activeTrack());if(!n.paused()||e.endList&&n.preload()!=="none"){s.load()}});i.on("loadedplaylist",function(){s.playlist(i.media(),a);if(!n.paused()){s.load()}});i.on("error",Dp[t](t,r))}};var Rp=function e(t,i){return function(e){return e.attributes[t]===i}};var Mp=function e(t){return function(e){return e.resolvedUri===t}};var Bp={AUDIO:function e(t,i){var r=i.hls,n=i.sourceType,a=i.segmentLoaders[t],s=i.requestOptions.withCredentials,o=i.master,u=o.mediaGroups,l=o.playlists,c=i.mediaTypes[t],f=c.groups,h=c.tracks,d=i.masterPlaylistLoader;if(!u[t]||Object.keys(u[t]).length===0){u[t]={main:{default:{default:true}}}}for(var p in u[t]){if(!f[p]){f[p]=[]}var m=l.filter(Rp(t,p));for(var v in u[t][p]){var g=u[t][p][v];var y=m.filter(Mp(g.resolvedUri));if(y.length){delete g.resolvedUri}var _=void 0;if(g.resolvedUri){_=new Gf(g.resolvedUri,r,s)}else if(g.playlists&&n==="dash"){_=new Bd(g.playlists[0],r,s,d)}else{_=null}g=Ts.mergeOptions({id:v,playlistLoader:_},g);xp[t](t,g.playlistLoader,i);f[p].push(g);if(typeof h[v]==="undefined"){var b=new Ts.AudioTrack({id:v,kind:Lp(g),enabled:false,language:g.language,default:g.default,label:v});h[v]=b}}}a.on("error",Dp[t](t,i))},SUBTITLES:function e(t,i){var r=i.tech,n=i.hls,a=i.sourceType,s=i.segmentLoaders[t],o=i.requestOptions.withCredentials,u=i.master.mediaGroups,l=i.mediaTypes[t],c=l.groups,f=l.tracks,h=i.masterPlaylistLoader;for(var d in u[t]){if(!c[d]){c[d]=[]}for(var p in u[t][d]){if(u[t][d][p].forced){continue}var m=u[t][d][p];var v=void 0;if(a==="hls"){v=new Gf(m.resolvedUri,n,o)}else if(a==="dash"){v=new Bd(m.playlists[0],n,o,h)}m=Ts.mergeOptions({id:p,playlistLoader:v},m);xp[t](t,m.playlistLoader,i);c[d].push(m);if(typeof f[p]==="undefined"){var g=r.addRemoteTextTrack({id:p,kind:"subtitles",default:m.default&&m.autoselect,language:m.language,label:p},false).track;f[p]=g}}}s.on("error",Dp[t](t,i))},"CLOSED-CAPTIONS":function e(t,i){var r=i.tech,n=i.master.mediaGroups,a=i.mediaTypes[t],s=a.groups,o=a.tracks;for(var u in n[t]){if(!s[u]){s[u]=[]}for(var l in n[t][u]){var c=n[t][u][l];if(!c.instreamId.match(/CC\d/)){continue}s[u].push(Ts.mergeOptions({id:l},c));if(typeof o[l]==="undefined"){var f=r.addRemoteTextTrack({id:c.instreamId,kind:"captions",default:c.default&&c.autoselect,language:c.language,label:l},false).track;o[l]=f}}}}};var Np=function e(a,s){return function(t){var e=s.masterPlaylistLoader,i=s.mediaTypes[a].groups;var r=e.media();if(!r){return null}var n=null;if(r.attributes[a]){n=i[r.attributes[a]]}n=n||i.main;if(typeof t==="undefined"){return n}if(t===null){return null}return n.filter(function(e){return e.id===t.id})[0]||null}};var jp={AUDIO:function e(i,r){return function(){var e=r.mediaTypes[i].tracks;for(var t in e){if(e[t].enabled){return e[t]}}return null}},SUBTITLES:function e(i,r){return function(){var e=r.mediaTypes[i].tracks;for(var t in e){if(e[t].mode==="showing"){return e[t]}}return null}}};var Fp=function e(t){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(e){Bp[e](e,t)});var i=t.mediaTypes,r=t.masterPlaylistLoader,n=t.tech,a=t.hls;["AUDIO","SUBTITLES"].forEach(function(e){i[e].activeGroup=Np(e,t);i[e].activeTrack=jp[e](e,t);i[e].onGroupChanged=Pp(e,t);i[e].onTrackChanged=Up(e,t)});var s=i.AUDIO.activeGroup();var o=(s.filter(function(e){return e.default})[0]||s[0]).id;i.AUDIO.tracks[o].enabled=true;i.AUDIO.onTrackChanged();r.on("mediachange",function(){["AUDIO","SUBTITLES"].forEach(function(e){return i[e].onGroupChanged()})});var u=function e(){i.AUDIO.onTrackChanged();n.trigger({type:"usage",name:"hls-audio-change"})};n.audioTracks().addEventListener("change",u);n.remoteTextTracks().addEventListener("change",i.SUBTITLES.onTrackChanged);a.on("dispose",function(){n.audioTracks().removeEventListener("change",u);n.remoteTextTracks().removeEventListener("change",i.SUBTITLES.onTrackChanged)});n.clearTracks("audio");for(var l in i.AUDIO.tracks){n.audioTracks().addTrack(i.AUDIO.tracks[l])}};var Vp=function e(){var t={};["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(e){t[e]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:jd,activeTrack:jd,onGroupChanged:jd,onTrackChanged:jd}});return t};var Hp=60*2;var qp=void 0;var zp=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred"];var Wp=function e(t){return this.audioSegmentLoader_[t]+this.mainSegmentLoader_[t]};var Gp=function(e){Df(d,e);function d(e){Of(this,d);var t=xf(this,(d.__proto__||Object.getPrototypeOf(d)).call(this));var i=e.url,r=e.withCredentials,n=e.tech,a=e.bandwidth,s=e.externHls,o=e.useCueTags,u=e.blacklistDuration,l=e.enableLowInitialPlaylist,c=e.sourceType,f=e.seekTo;if(!i){throw new Error("A non-empty playlist URL is required")}qp=s;t.withCredentials=r;t.tech_=n;t.hls_=n.hls;t.seekTo_=f;t.sourceType_=c;t.useCueTags_=o;t.blacklistDuration=u;t.enableLowInitialPlaylist=l;if(t.useCueTags_){t.cueTagsTrack_=t.tech_.addTextTrack("metadata","ad-cues");t.cueTagsTrack_.inBandMetadataTrackDispatchType=""}t.requestOptions_={withCredentials:t.withCredentials,timeout:null};t.mediaTypes_=Vp();t.mediaSource=new Ts.MediaSource;t.mediaSource.addEventListener("sourceopen",t.handleSourceOpen_.bind(t));t.seekable_=Ts.createTimeRanges();t.hasPlayed_=function(){return false};t.syncController_=new Ep(e);t.segmentMetadataTrack_=n.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},false).track;t.decrypter_=new Ap;t.inbandTextTracks_={};var h={hls:t.hls_,mediaSource:t.mediaSource,currentTime:t.tech_.currentTime.bind(t.tech_),seekable:function e(){return t.seekable()},seeking:function e(){return t.tech_.seeking()},duration:function e(){return t.mediaSource.duration},hasPlayed:function e(){return t.hasPlayed_()},goalBufferLength:function e(){return t.goalBufferLength()},bandwidth:a,syncController:t.syncController_,decrypter:t.decrypter_,sourceType:t.sourceType_,inbandTextTracks:t.inbandTextTracks_};t.masterPlaylistLoader_=t.sourceType_==="dash"?new Bd(i,t.hls_,t.withCredentials):new Gf(i,t.hls_,t.withCredentials);t.setupMasterPlaylistLoaderListeners_();t.mainSegmentLoader_=new yp(Ts.mergeOptions(h,{segmentMetadataTrack:t.segmentMetadataTrack_,loaderType:"main"}),e);t.audioSegmentLoader_=new yp(Ts.mergeOptions(h,{loaderType:"audio"}),e);t.subtitleSegmentLoader_=new Tp(Ts.mergeOptions(h,{loaderType:"vtt"}),e);t.setupSegmentLoaderListeners_();zp.forEach(function(e){t[e+"_"]=Wp.bind(t,e)});t.logger_=Nd("MPC");t.masterPlaylistLoader_.load();return t}Pf(d,[{key:"setupMasterPlaylistLoaderListeners_",value:function e(){var n=this;this.masterPlaylistLoader_.on("loadedmetadata",function(){var e=n.masterPlaylistLoader_.media();var t=n.masterPlaylistLoader_.targetDuration*1.5*1e3;if(mh(n.masterPlaylistLoader_.master,n.masterPlaylistLoader_.media())){n.requestOptions_.timeout=0}else{n.requestOptions_.timeout=t}if(e.endList&&n.tech_.preload()!=="none"){n.mainSegmentLoader_.playlist(e,n.requestOptions_);n.mainSegmentLoader_.load()}Fp({sourceType:n.sourceType_,segmentLoaders:{AUDIO:n.audioSegmentLoader_,SUBTITLES:n.subtitleSegmentLoader_,main:n.mainSegmentLoader_},tech:n.tech_,requestOptions:n.requestOptions_,masterPlaylistLoader:n.masterPlaylistLoader_,hls:n.hls_,master:n.master(),mediaTypes:n.mediaTypes_,blacklistCurrentPlaylist:n.blacklistCurrentPlaylist.bind(n)});n.triggerPresenceUsage_(n.master(),e);try{n.setupSourceBuffers_()}catch(e){Ts.log.warn("Failed to create SourceBuffers",e);return n.mediaSource.endOfStream("decode")}n.setupFirstPlay();n.trigger("selectedinitialmedia")});this.masterPlaylistLoader_.on("loadedplaylist",function(){var e=n.masterPlaylistLoader_.media();if(!e){n.excludeUnsupportedVariants_();var t=void 0;if(n.enableLowInitialPlaylist){t=n.selectInitialPlaylist()}if(!t){t=n.selectPlaylist()}n.initialMedia_=t;n.masterPlaylistLoader_.media(n.initialMedia_);return}if(n.useCueTags_){n.updateAdCues_(e)}n.mainSegmentLoader_.playlist(e,n.requestOptions_);n.updateDuration();if(!n.tech_.paused()){n.mainSegmentLoader_.load();if(n.audioSegmentLoader_){n.audioSegmentLoader_.load()}}if(!e.endList){var i=function e(){var t=n.seekable();if(t.length!==0){n.mediaSource.addSeekableRange_(t.start(0),t.end(0))}};if(n.duration()!==Infinity){var r=function e(){if(n.duration()===Infinity){i()}else{n.tech_.one("durationchange",e)}};n.tech_.one("durationchange",r)}else{i()}}});this.masterPlaylistLoader_.on("error",function(){n.blacklistCurrentPlaylist(n.masterPlaylistLoader_.error)});this.masterPlaylistLoader_.on("mediachanging",function(){n.mainSegmentLoader_.abort();n.mainSegmentLoader_.pause()});this.masterPlaylistLoader_.on("mediachange",function(){var e=n.masterPlaylistLoader_.media();var t=n.masterPlaylistLoader_.targetDuration*1.5*1e3;if(mh(n.masterPlaylistLoader_.master,n.masterPlaylistLoader_.media())){n.requestOptions_.timeout=0}else{n.requestOptions_.timeout=t}n.mainSegmentLoader_.playlist(e,n.requestOptions_);n.mainSegmentLoader_.load();n.tech_.trigger({type:"mediachange",bubbles:true})});this.masterPlaylistLoader_.on("playlistunchanged",function(){var e=n.masterPlaylistLoader_.media();var t=n.stuckAtPlaylistEnd_(e);if(t){n.blacklistCurrentPlaylist({message:"Playlist no longer updating."});n.tech_.trigger("playliststuck")}});this.masterPlaylistLoader_.on("renditiondisabled",function(){n.tech_.trigger({type:"usage",name:"hls-rendition-disabled"})});this.masterPlaylistLoader_.on("renditionenabled",function(){n.tech_.trigger({type:"usage",name:"hls-rendition-enabled"})})}},{key:"triggerPresenceUsage_",value:function e(t,i){var r=t.mediaGroups||{};var n=true;var a=Object.keys(r.AUDIO);for(var s in r.AUDIO){for(var o in r.AUDIO[s]){var u=r.AUDIO[s][o];if(!u.uri){n=false}}}if(n){this.tech_.trigger({type:"usage",name:"hls-demuxed"})}if(Object.keys(r.SUBTITLES).length){this.tech_.trigger({type:"usage",name:"hls-webvtt"})}if(qp.Playlist.isAes(i)){this.tech_.trigger({type:"usage",name:"hls-aes"})}if(qp.Playlist.isFmp4(i)){this.tech_.trigger({type:"usage",name:"hls-fmp4"})}if(a.length&&Object.keys(r.AUDIO[a[0]]).length>1){this.tech_.trigger({type:"usage",name:"hls-alternate-audio"})}if(this.useCueTags_){this.tech_.trigger({type:"usage",name:"hls-playlist-cue-tags"})}}},{key:"setupSegmentLoaderListeners_",value:function e(){var a=this;this.mainSegmentLoader_.on("bandwidthupdate",function(){var e=a.selectPlaylist();var t=a.masterPlaylistLoader_.media();var i=a.tech_.buffered();var r=i.length?i.end(i.length-1)-a.tech_.currentTime():0;var n=a.bufferLowWaterLine();if(!t.endList||a.duration()<Vd.MAX_BUFFER_LOW_WATER_LINE||e.attributes.BANDWIDTH<t.attributes.BANDWIDTH||r>=n){a.masterPlaylistLoader_.media(e)}a.tech_.trigger("bandwidthupdate")});this.mainSegmentLoader_.on("progress",function(){a.trigger("progress")});this.mainSegmentLoader_.on("error",function(){a.blacklistCurrentPlaylist(a.mainSegmentLoader_.error())});this.mainSegmentLoader_.on("syncinfoupdate",function(){a.onSyncInfoUpdate_()});this.mainSegmentLoader_.on("timestampoffset",function(){a.tech_.trigger({type:"usage",name:"hls-timestamp-offset"})});this.audioSegmentLoader_.on("syncinfoupdate",function(){a.onSyncInfoUpdate_()});this.mainSegmentLoader_.on("ended",function(){a.onEndOfStream()});this.mainSegmentLoader_.on("earlyabort",function(){a.blacklistCurrentPlaylist({message:"Aborted early because there isn't enough bandwidth to complete the "+"request without rebuffering."},Hp)});this.mainSegmentLoader_.on("reseteverything",function(){a.tech_.trigger("hls-reset")});this.mainSegmentLoader_.on("segmenttimemapping",function(e){a.tech_.trigger({type:"hls-segment-time-mapping",mapping:e.mapping})});this.audioSegmentLoader_.on("ended",function(){a.onEndOfStream()})}},{key:"mediaSecondsLoaded_",value:function e(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}},{key:"load",value:function e(){this.mainSegmentLoader_.load();if(this.mediaTypes_.AUDIO.activePlaylistLoader){this.audioSegmentLoader_.load()}if(this.mediaTypes_.SUBTITLES.activePlaylistLoader){this.subtitleSegmentLoader_.load()}}},{key:"smoothQualityChange_",value:function e(){var t=this.selectPlaylist();if(t!==this.masterPlaylistLoader_.media()){this.masterPlaylistLoader_.media(t);this.mainSegmentLoader_.resetLoader()}}},{key:"fastQualityChange_",value:function e(){var t=this;var i=this.selectPlaylist();if(i===this.masterPlaylistLoader_.media()){return}this.masterPlaylistLoader_.media(i);this.mainSegmentLoader_.resetEverything(function(){if(Ts.browser.IE_VERSION||Ts.browser.IS_EDGE){t.tech_.setCurrentTime(t.tech_.currentTime()+.04)}else{t.tech_.setCurrentTime(t.tech_.currentTime())}})}},{key:"play",value:function e(){if(this.setupFirstPlay()){return}if(this.tech_.ended()){this.seekTo_(0)}if(this.hasPlayed_()){this.load()}var t=this.tech_.seekable();if(this.tech_.duration()===Infinity){if(this.tech_.currentTime()<t.start(0)){return this.seekTo_(t.end(t.length-1))}}}},{key:"setupFirstPlay",value:function e(){var t=this;var i=this.masterPlaylistLoader_.media();if(!i||this.tech_.paused()||this.hasPlayed_()){return false}if(!i.endList){var r=this.seekable();if(!r.length){return false}if(Ts.browser.IE_VERSION&&this.tech_.readyState()===0){this.tech_.one("loadedmetadata",function(){t.trigger("firstplay");t.seekTo_(r.end(0));t.hasPlayed_=function(){return true}});return false}this.trigger("firstplay");this.seekTo_(r.end(0))}this.hasPlayed_=function(){return true};this.load();return true}},{key:"handleSourceOpen_",value:function e(){try{this.setupSourceBuffers_()}catch(e){Ts.log.warn("Failed to create Source Buffers",e);return this.mediaSource.endOfStream("decode")}if(this.tech_.autoplay()){var t=this.tech_.play();if(typeof t!=="undefined"&&typeof t.then==="function"){t.then(null,function(e){})}}this.trigger("sourceopen")}},{key:"onEndOfStream",value:function e(){var t=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader){if(!this.mainSegmentLoader_.startingMedia_||this.mainSegmentLoader_.startingMedia_.containsVideo){t=t&&this.audioSegmentLoader_.ended_}else{t=this.audioSegmentLoader_.ended_}}if(t){this.mediaSource.endOfStream()}}},{key:"stuckAtPlaylistEnd_",value:function e(t){var i=this.seekable();if(!i.length){return false}var r=this.syncController_.getExpiredTime(t,this.mediaSource.duration);if(r===null){return false}var n=qp.Playlist.playlistEnd(t,r);var a=this.tech_.currentTime();var s=this.tech_.buffered();if(!s.length){return n-a<=Nh}var o=s.end(s.length-1);return o-a<=Nh&&n-o<=Nh}},{key:"blacklistCurrentPlaylist",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var i=arguments[1];var r=void 0;var n=void 0;r=t.playlist||this.masterPlaylistLoader_.media();i=i||t.blacklistDuration||this.blacklistDuration;if(!r){this.error=t;try{return this.mediaSource.endOfStream("network")}catch(e){return this.trigger("error")}}var a=this.masterPlaylistLoader_.master.playlists.filter(lh).length===1;if(a){Ts.log.warn("Problem encountered with the current "+"HLS playlist. Trying again since it is the final playlist.");this.tech_.trigger("retryplaylist");return this.masterPlaylistLoader_.load(a)}r.excludeUntil=Date.now()+i*1e3;this.tech_.trigger("blacklistplaylist");this.tech_.trigger({type:"usage",name:"hls-rendition-blacklisted"});n=this.selectPlaylist();Ts.log.warn("Problem encountered with the current HLS playlist."+(t.message?" "+t.message:"")+" Switching to another playlist.");return this.masterPlaylistLoader_.media(n)}},{key:"pauseLoading",value:function e(){this.mainSegmentLoader_.pause();if(this.mediaTypes_.AUDIO.activePlaylistLoader){this.audioSegmentLoader_.pause()}if(this.mediaTypes_.SUBTITLES.activePlaylistLoader){this.subtitleSegmentLoader_.pause()}}},{key:"setCurrentTime",value:function e(t){var i=Fh(this.tech_.buffered(),t);if(!(this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media())){return 0}if(!this.masterPlaylistLoader_.media().segments){return 0}if(i&&i.length){return t}this.mainSegmentLoader_.resetEverything();this.mainSegmentLoader_.abort();if(this.mediaTypes_.AUDIO.activePlaylistLoader){this.audioSegmentLoader_.resetEverything();this.audioSegmentLoader_.abort()}if(this.mediaTypes_.SUBTITLES.activePlaylistLoader){this.subtitleSegmentLoader_.resetEverything();this.subtitleSegmentLoader_.abort()}this.load()}},{key:"duration",value:function e(){if(!this.masterPlaylistLoader_){return 0}if(this.mediaSource){return this.mediaSource.duration}return qp.Playlist.duration(this.masterPlaylistLoader_.media())}},{key:"seekable",value:function e(){return this.seekable_}},{key:"onSyncInfoUpdate_",value:function e(){var t=void 0;var i=void 0;if(!this.masterPlaylistLoader_){return}var r=this.masterPlaylistLoader_.media();if(!r){return}var n=this.syncController_.getExpiredTime(r,this.mediaSource.duration);if(n===null){return}t=qp.Playlist.seekable(r,n);if(t.length===0){return}if(this.mediaTypes_.AUDIO.activePlaylistLoader){r=this.mediaTypes_.AUDIO.activePlaylistLoader.media();n=this.syncController_.getExpiredTime(r,this.mediaSource.duration);if(n===null){return}i=qp.Playlist.seekable(r,n);if(i.length===0){return}}if(!i){this.seekable_=t}else if(i.start(0)>t.end(0)||t.start(0)>i.end(0)){this.seekable_=t}else{this.seekable_=Ts.createTimeRanges([[i.start(0)>t.start(0)?i.start(0):t.start(0),i.end(0)<t.end(0)?i.end(0):t.end(0)]])}this.logger_("seekable updated ["+qh(this.seekable_)+"]");this.tech_.trigger("seekablechanged")}},{key:"updateDuration",value:function e(){var t=this;var i=this.mediaSource.duration;var r=qp.Playlist.duration(this.masterPlaylistLoader_.media());var n=this.tech_.buffered();var a=function e(){t.mediaSource.duration=r;t.tech_.trigger("durationchange");t.mediaSource.removeEventListener("sourceopen",e)};if(n.length>0){r=Math.max(r,n.end(n.length-1))}if(i!==r){if(this.mediaSource.readyState!=="open"){this.mediaSource.addEventListener("sourceopen",a)}else{a()}}}},{key:"dispose",value:function e(){var r=this;this.decrypter_.terminate();this.masterPlaylistLoader_.dispose();this.mainSegmentLoader_.dispose();["AUDIO","SUBTITLES"].forEach(function(e){var t=r.mediaTypes_[e].groups;for(var i in t){t[i].forEach(function(e){if(e.playlistLoader){e.playlistLoader.dispose()}})}});this.audioSegmentLoader_.dispose();this.subtitleSegmentLoader_.dispose()}},{key:"master",value:function e(){return this.masterPlaylistLoader_.master}},{key:"media",value:function e(){return this.masterPlaylistLoader_.media()||this.initialMedia_}},{key:"setupSourceBuffers_",value:function e(){var t=this.masterPlaylistLoader_.media();var i=void 0;if(!t||this.mediaSource.readyState!=="open"){return}i=yd(this.masterPlaylistLoader_.master,t);if(i.length<1){this.error="No compatible SourceBuffer configuration for the variant stream:"+t.resolvedUri;return this.mediaSource.endOfStream("decode")}this.configureLoaderMimeTypes_(i);this.excludeIncompatibleVariants_(t)}},{key:"configureLoaderMimeTypes_",value:function e(t){var i=t.length>1&&t[0].indexOf(",")===-1&&t[0]!==t[1]?new Ts.EventTarget:null;this.mainSegmentLoader_.mimeType(t[0],i);if(t[1]){this.audioSegmentLoader_.mimeType(t[1],i)}}},{key:"excludeUnsupportedVariants_",value:function e(){this.master().playlists.forEach(function(e){if(e.attributes.CODECS&&_.MediaSource&&_.MediaSource.isTypeSupported&&!_.MediaSource.isTypeSupported('video/mp4; codecs="'+dd(e.attributes.CODECS)+'"')){e.excludeUntil=Infinity}})}},{key:"excludeIncompatibleVariants_",value:function e(t){var i=2;var r=null;var n=void 0;if(t.attributes.CODECS){n=hd(t.attributes.CODECS);r=n.videoCodec;i=n.codecCount}this.master().playlists.forEach(function(e){var t={codecCount:2,videoCodec:null};if(e.attributes.CODECS){t=hd(e.attributes.CODECS)}if(t.codecCount!==i){e.excludeUntil=Infinity}if(t.videoCodec!==r){e.excludeUntil=Infinity}})}},{key:"updateAdCues_",value:function e(t){var i=0;var r=this.seekable();if(r.length){i=r.start(0)}kp(t,this.cueTagsTrack_,i)}},{key:"goalBufferLength",value:function e(){var t=this.tech_.currentTime();var i=Vd.GOAL_BUFFER_LENGTH;var r=Vd.GOAL_BUFFER_LENGTH_RATE;var n=Math.max(i,Vd.MAX_GOAL_BUFFER_LENGTH);return Math.min(i+t*r,n)}},{key:"bufferLowWaterLine",value:function e(){var t=this.tech_.currentTime();var i=Vd.BUFFER_LOW_WATER_LINE;var r=Vd.BUFFER_LOW_WATER_LINE_RATE;var n=Math.max(i,Vd.MAX_BUFFER_LOW_WATER_LINE);return Math.min(i+t*r,n)}}]);return d}(Ts.EventTarget);var Xp=function e(n,a,s){return function(e){var t=n.master.playlists[a];var i=uh(t);var r=lh(t);if(typeof e==="undefined"){return r}if(e){delete t.disabled}else{t.disabled=true}if(e!==r&&!i){s();if(e){n.trigger("renditionenabled")}else{n.trigger("renditiondisabled")}}return e}};var Yp=function e(t,i,r){Of(this,e);var n=t.masterPlaylistController_,a=t.options_.smoothQualityChange;var s=a?"smooth":"fast";var o=n[s+"QualityChange_"].bind(n);if(i.attributes.RESOLUTION){var u=i.attributes.RESOLUTION;this.width=u.width;this.height=u.height}this.bandwidth=i.attributes.BANDWIDTH;this.id=r;this.enabled=Xp(t.playlists,i.uri,o)};var $p=function e(i){var t=i.playlists;i.representations=function(){return t.master.playlists.filter(function(e){return!uh(e)}).map(function(e,t){return new Yp(i,e,e.uri)})}};var Kp=["seeking","seeked","pause","playing","error"];var Jp=function(){function s(e){var t=this;Of(this,s);this.tech_=e.tech;this.seekable=e.seekable;this.seekTo=e.seekTo;this.consecutiveUpdates=0;this.lastRecordedTime=null;this.timer_=null;this.checkCurrentTimeTimeout_=null;this.logger_=Nd("PlaybackWatcher");this.logger_("initialize");var i=function e(){return t.monitorCurrentTime_()};var r=function e(){return t.techWaiting_()};var n=function e(){return t.cancelTimer_()};var a=function e(){return t.fixesBadSeeks_()};this.tech_.on("seekablechanged",a);this.tech_.on("waiting",r);this.tech_.on(Kp,n);this.tech_.on("canplay",i);this.dispose=function(){t.logger_("dispose");t.tech_.off("seekablechanged",a);t.tech_.off("waiting",r);t.tech_.off(Kp,n);t.tech_.off("canplay",i);if(t.checkCurrentTimeTimeout_){_.clearTimeout(t.checkCurrentTimeTimeout_)}t.cancelTimer_()}}Pf(s,[{key:"monitorCurrentTime_",value:function e(){this.checkCurrentTime_();if(this.checkCurrentTimeTimeout_){_.clearTimeout(this.checkCurrentTimeTimeout_)}this.checkCurrentTimeTimeout_=_.setTimeout(this.monitorCurrentTime_.bind(this),250)}},{key:"checkCurrentTime_",value:function e(){if(this.tech_.seeking()&&this.fixesBadSeeks_()){this.consecutiveUpdates=0;this.lastRecordedTime=this.tech_.currentTime();return}if(this.tech_.paused()||this.tech_.seeking()){return}var t=this.tech_.currentTime();var i=this.tech_.buffered();if(this.lastRecordedTime===t&&(!i.length||t+Nh>=i.end(i.length-1))){return this.techWaiting_()}if(this.consecutiveUpdates>=5&&t===this.lastRecordedTime){this.consecutiveUpdates++;this.waiting_()}else if(t===this.lastRecordedTime){this.consecutiveUpdates++}else{this.consecutiveUpdates=0;this.lastRecordedTime=t}}},{key:"cancelTimer_",value:function e(){this.consecutiveUpdates=0;if(this.timer_){this.logger_("cancelTimer_");clearTimeout(this.timer_)}this.timer_=null}},{key:"fixesBadSeeks_",value:function e(){var t=this.tech_.seeking();var i=this.seekable();var r=this.tech_.currentTime();var n=void 0;if(t&&this.afterSeekableWindow_(i,r)){var a=i.end(i.length-1);n=a}if(t&&this.beforeSeekableWindow_(i,r)){var s=i.start(0);n=s+Nh}if(typeof n!=="undefined"){this.logger_("Trying to seek outside of seekable at time "+r+" with "+("seekable range "+qh(i)+". Seeking to ")+(n+"."));this.seekTo(n);return true}return false}},{key:"waiting_",value:function e(){if(this.techWaiting_()){return}var t=this.tech_.currentTime();var i=this.tech_.buffered();var r=Fh(i,t);if(r.length&&t+3<=r.end(0)){this.cancelTimer_();this.seekTo(t);this.logger_("Stopped at "+t+" while inside a buffered region "+("["+r.start(0)+" -> "+r.end(0)+"]. Attempting to resume ")+"playback by seeking to the current time.");this.tech_.trigger({type:"usage",name:"hls-unknown-waiting"});return}}},{key:"techWaiting_",value:function e(){var t=this.seekable();var i=this.tech_.currentTime();if(this.tech_.seeking()&&this.fixesBadSeeks_()){return true}if(this.tech_.seeking()||this.timer_!==null){return true}if(this.beforeSeekableWindow_(t,i)){var r=t.end(t.length-1);this.logger_("Fell out of live window at time "+i+". Seeking to "+("live point (seekable end) "+r));this.cancelTimer_();this.seekTo(r);this.tech_.trigger({type:"usage",name:"hls-live-resync"});return true}var n=this.tech_.buffered();var a=Vh(n,i);if(this.videoUnderflow_(a,n,i)){this.cancelTimer_();this.seekTo(i);this.tech_.trigger({type:"usage",name:"hls-video-underflow"});return true}if(a.length>0){var s=a.start(0)-i;this.logger_("Stopped at "+i+", setting timer for "+s+", seeking "+("to "+a.start(0)));this.timer_=setTimeout(this.skipTheGap_.bind(this),s*1e3,i);return true}return false}},{key:"afterSeekableWindow_",value:function e(t,i){if(!t.length){return false}if(i>t.end(t.length-1)+Nh){return true}return false}},{key:"beforeSeekableWindow_",value:function e(t,i){if(t.length&&t.start(0)>0&&i<t.start(0)-Nh){return true}return false}},{key:"videoUnderflow_",value:function e(t,i,r){if(t.length===0){var n=this.gapFromVideoUnderflow_(i,r);if(n){this.logger_("Encountered a gap in video from "+n.start+" to "+n.end+". "+("Seeking to current time "+r));return true}}return false}},{key:"skipTheGap_",value:function e(t){var i=this.tech_.buffered();var r=this.tech_.currentTime();var n=Vh(i,r);this.cancelTimer_();if(n.length===0||r!==t){return}this.logger_("skipTheGap_:","currentTime:",r,"scheduled currentTime:",t,"nextRange start:",n.start(0));this.seekTo(n.start(0)+Bh);this.tech_.trigger({type:"usage",name:"hls-gap-skip"})}},{key:"gapFromVideoUnderflow_",value:function e(t,i){var r=Hh(t);for(var n=0;n<r.length;n++){var a=r.start(n);var s=r.end(n);if(i-a<4&&i-a>2){return{start:a,end:s}}}return null}}]);return s}();var Qp={errorInterval:30,getSource:function e(t){var i=this.tech({IWillNotUseThisInPlugins:true});var r=i.currentSource_;return t(r)}};var Zp=function i(r,e){var t=0;var n=0;var a=Ts.mergeOptions(Qp,e);r.ready(function(){r.trigger({type:"usage",name:"hls-error-reload-initialized"})});var s=function e(){if(n){r.currentTime(n)}};var o=function e(t){if(t===null||t===undefined){return}n=r.duration()!==Infinity&&r.currentTime()||0;r.one("loadedmetadata",s);r.src(t);r.trigger({type:"usage",name:"hls-error-reload"});r.play()};var u=function e(){if(Date.now()-t<a.errorInterval*1e3){r.trigger({type:"usage",name:"hls-error-reload-canceled"});return}if(!a.getSource||typeof a.getSource!=="function"){Ts.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!");return}t=Date.now();return a.getSource.call(r,o)};var l=function e(){r.off("loadedmetadata",s);r.off("error",u);r.off("dispose",e)};var c=function e(t){l();i(r,t)};r.on("error",u);r.on("dispose",l);r.reloadSourceOnError=c};var em=function e(t){Zp(this,t)};var tm="1.5.1";Ts.use("*",function(i){return{setSource:function e(t,i){i(null,t)},setCurrentTime:function e(t){if(i.vhs&&i.currentSource().src===i.vhs.source_.src){i.vhs.setCurrentTime(t)}return t},play:function e(){if(i.vhs&&i.currentSource().src===i.vhs.source_.src){i.vhs.setCurrentTime(i.currentTime())}}}});var im={PlaylistLoader:Gf,Playlist:vh,Decrypter:Lf,AsyncStream:Cf,decrypt:Af,utils:Lh,STANDARD_PLAYLIST_SELECTOR:op,INITIAL_PLAYLIST_SELECTOR:lp,comparePlaylistBandwidth:np,comparePlaylistResolution:ap,xhr:_h()};["GOAL_BUFFER_LENGTH","MAX_GOAL_BUFFER_LENGTH","GOAL_BUFFER_LENGTH_RATE","BUFFER_LOW_WATER_LINE","MAX_BUFFER_LOW_WATER_LINE","BUFFER_LOW_WATER_LINE_RATE","BANDWIDTH_VARIANCE"].forEach(function(i){Object.defineProperty(im,i,{get:function e(){Ts.log.warn("using Hls."+i+" is UNSAFE be sure you know what you are doing");return Vd[i]},set:function e(t){Ts.log.warn("using Hls."+i+" is UNSAFE be sure you know what you are doing");if(typeof t!=="number"||t<0){Ts.log.warn("value of Hls."+i+" must be greater than or equal to 0");return}Vd[i]=t}})});var rm="videojs-vhs";var nm=function e(t){var i=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i;if(i.test(t)){return"hls"}var r=/^application\/dash\+xml/i;if(r.test(t)){return"dash"}return null};var am=function e(t,i){var r=i.media();var n=-1;for(var a=0;a<t.length;a++){if(t[a].id===r.uri){n=a;break}}t.selectedIndex_=n;t.trigger({selectedIndex:n,type:"change"})};var sm=function e(t,i){i.representations().forEach(function(e){t.addQualityLevel(e)});am(t,i.playlists)};im.canPlaySource=function(){return Ts.log.warn("HLS is no longer a tech. Please remove it from "+"your player's techOrder.")};var om=function e(t,i,r){if(!t){return t}var n={};for(var a in t){n[a]={audioContentType:'audio/mp4; codecs="'+r.attributes.CODECS+'"',videoContentType:'video/mp4; codecs="'+i.attributes.CODECS+'"'};if(i.contentProtection&&i.contentProtection[a]&&i.contentProtection[a].pssh){n[a].pssh=i.contentProtection[a].pssh}if(typeof t[a]==="string"){n[a].url=t[a]}}return Ts.mergeOptions(t,n)};var um=function e(t){if(t.options_.sourceType!=="dash"){return}var i=Ts.players[t.tech_.options_.playerId];if(i.eme){var r=om(t.source_.keySystems,t.playlists.media(),t.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader.media());if(r){i.currentSource().keySystems=r;if(i.eme.initializeMediaKeys){i.eme.initializeMediaKeys()}}}};var lm=function e(){if(!window.localStorage){return null}var t=window.localStorage.getItem(rm);if(!t){return null}try{return JSON.parse(t)}catch(e){return null}};var cm=function e(t){if(!window.localStorage){return false}var i=lm();i=i?Ts.mergeOptions(i,t):t;try{window.localStorage.setItem(rm,JSON.stringify(i))}catch(e){return false}return i};im.supportsNativeHls=function(){var t=h.createElement("video");if(!Ts.getTech("Html5").isSupported()){return false}var e=["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"];return e.some(function(e){return/maybe|probably/i.test(t.canPlayType(e))})}();im.supportsNativeDash=function(){if(!Ts.getTech("Html5").isSupported()){return false}return/maybe|probably/i.test(h.createElement("video").canPlayType("application/dash+xml"))}();im.supportsTypeNatively=function(e){if(e==="hls"){return im.supportsNativeHls}if(e==="dash"){return im.supportsNativeDash}return false};im.isSupported=function(){return Ts.log.warn("HLS is no longer a tech. Please remove it from "+"your player's techOrder.")};var fm=Ts.getComponent("Component");var hm=function(e){Df(a,e);function a(e,t,i){Of(this,a);var r=xf(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,t,i.hls));if(t.options_&&t.options_.playerId){var n=Ts(t.options_.playerId);if(!n.hasOwnProperty("hls")){Object.defineProperty(n,"hls",{get:function e(){Ts.log.warn("player.hls is deprecated. Use player.tech().hls instead.");t.trigger({type:"usage",name:"hls-player-access"});return r},configurable:true})}n.vhs=r;n.dash=r;r.player_=n}r.tech_=t;r.source_=e;r.stats={};r.setOptions_();if(r.options_.overrideNative&&t.overrideNativeAudioTracks&&t.overrideNativeVideoTracks){t.overrideNativeAudioTracks(true);t.overrideNativeVideoTracks(true)}else if(r.options_.overrideNative&&(t.featuresNativeVideoTracks||t.featuresNativeAudioTracks)){throw new Error("Overriding native HLS requires emulated tracks. "+"See https://git.io/vMpjB")}r.on(h,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],function(e){var t=h.fullscreenElement||h.webkitFullscreenElement||h.mozFullScreenElement||h.msFullscreenElement;if(t&&t.contains(r.tech_.el())){r.masterPlaylistController_.smoothQualityChange_()}});r.on(r.tech_,"seeking",function(){if(this.tech_.seeking()&&this.tech_.currentTime()===0&&this.tech_.player_.loop()){this.setCurrentTime(0)}});r.on(r.tech_,"error",function(){if(this.masterPlaylistController_){this.masterPlaylistController_.pauseLoading()}});r.on(r.tech_,"play",r.play);return r}Pf(a,[{key:"setOptions_",value:function e(){var t=this;this.options_.withCredentials=this.options_.withCredentials||false;this.options_.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions===false?false:true;this.options_.smoothQualityChange=this.options_.smoothQualityChange||false;this.options_.useBandwidthFromLocalStorage=typeof this.source_.useBandwidthFromLocalStorage!=="undefined"?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||false;if(typeof this.options_.blacklistDuration!=="number"){this.options_.blacklistDuration=5*60}if(typeof this.options_.bandwidth!=="number"){if(this.options_.useBandwidthFromLocalStorage){var i=lm();if(i&&i.bandwidth){this.options_.bandwidth=i.bandwidth;this.tech_.trigger({type:"usage",name:"hls-bandwidth-from-local-storage"})}if(i&&i.throughput){this.options_.throughput=i.throughput;this.tech_.trigger({type:"usage",name:"hls-throughput-from-local-storage"})}}}if(typeof this.options_.bandwidth!=="number"){this.options_.bandwidth=Vd.INITIAL_BANDWIDTH}this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===Vd.INITIAL_BANDWIDTH;["withCredentials","limitRenditionByPlayerDimensions","bandwidth","smoothQualityChange"].forEach(function(e){if(typeof t.source_[e]!=="undefined"){t.options_[e]=t.source_[e]}});this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions}},{key:"src",value:function e(t,i){var r=this;if(!t){return}this.setOptions_();this.options_.url=this.source_.src;this.options_.tech=this.tech_;this.options_.externHls=im;this.options_.sourceType=nm(i);this.options_.seekTo=function(e){r.tech_.setCurrentTime(e);r.setCurrentTime(e)};this.masterPlaylistController_=new Gp(this.options_);this.playbackWatcher_=new Jp(Ts.mergeOptions(this.options_,{seekable:function e(){return r.seekable()}}));this.masterPlaylistController_.on("error",function(){var e=Ts.players[r.tech_.options_.playerId];e.error(r.masterPlaylistController_.error)});this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):im.STANDARD_PLAYLIST_SELECTOR.bind(this);this.masterPlaylistController_.selectInitialPlaylist=im.INITIAL_PLAYLIST_SELECTOR.bind(this);this.playlists=this.masterPlaylistController_.masterPlaylistLoader_;this.mediaSource=this.masterPlaylistController_.mediaSource;Object.defineProperties(this,{selectPlaylist:{get:function e(){return this.masterPlaylistController_.selectPlaylist},set:function e(t){this.masterPlaylistController_.selectPlaylist=t.bind(this)}},throughput:{get:function e(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function e(t){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=t;this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function e(){return this.masterPlaylistController_.mainSegmentLoader_.bandwidth},set:function e(t){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=t;this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function e(){var t=1/(this.bandwidth||1);var i=void 0;if(this.throughput>0){i=1/this.throughput}else{i=0}var r=Math.floor(1/(t+i));return r},set:function e(){Ts.log.error('The "systemBandwidth" property is read-only')}}});if(this.options_.bandwidth){this.bandwidth=this.options_.bandwidth}if(this.options_.throughput){this.throughput=this.options_.throughput}Object.defineProperties(this.stats,{bandwidth:{get:function e(){return r.bandwidth||0},enumerable:true},mediaRequests:{get:function e(){return r.masterPlaylistController_.mediaRequests_()||0},enumerable:true},mediaRequestsAborted:{get:function e(){return r.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:true},mediaRequestsTimedout:{get:function e(){return r.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:true},mediaRequestsErrored:{get:function e(){return r.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:true},mediaTransferDuration:{get:function e(){return r.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:true},mediaBytesTransferred:{get:function e(){return r.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:true},mediaSecondsLoaded:{get:function e(){return r.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:true},buffered:{get:function e(){return Wh(r.tech_.buffered())},enumerable:true},currentTime:{get:function e(){return r.tech_.currentTime()},enumerable:true},currentSource:{get:function e(){return r.tech_.currentSource_},enumerable:true},currentTech:{get:function e(){return r.tech_.name_},enumerable:true},duration:{get:function e(){return r.tech_.duration()},enumerable:true},master:{get:function e(){return r.playlists.master},enumerable:true},playerDimensions:{get:function e(){return r.tech_.currentDimensions()},enumerable:true},seekable:{get:function e(){return Wh(r.tech_.seekable())},enumerable:true},timestamp:{get:function e(){return Date.now()},enumerable:true},videoPlaybackQuality:{get:function e(){return r.tech_.getVideoPlaybackQuality()},enumerable:true}});this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_));this.tech_.on("bandwidthupdate",function(){if(r.options_.useBandwidthFromLocalStorage){cm({bandwidth:r.bandwidth,throughput:Math.round(r.throughput)})}});this.masterPlaylistController_.on("selectedinitialmedia",function(){$p(r);um(r)});this.on(this.masterPlaylistController_,"progress",function(){this.tech_.trigger("progress")});this.tech_.ready(function(){return r.setupQualityLevels_()});if(!this.tech_.el()){return}this.tech_.src(Ts.URL.createObjectURL(this.masterPlaylistController_.mediaSource))}},{key:"setupQualityLevels_",value:function e(){var t=this;var i=Ts.players[this.tech_.options_.playerId];if(i&&i.qualityLevels){this.qualityLevels_=i.qualityLevels();this.masterPlaylistController_.on("selectedinitialmedia",function(){sm(t.qualityLevels_,t)});this.playlists.on("mediachange",function(){am(t.qualityLevels_,t.playlists)})}}},{key:"play",value:function e(){this.masterPlaylistController_.play()}},{key:"setCurrentTime",value:function e(t){this.masterPlaylistController_.setCurrentTime(t)}},{key:"duration",value:function e(){return this.masterPlaylistController_.duration()}},{key:"seekable",value:function e(){return this.masterPlaylistController_.seekable()}},{key:"dispose",value:function e(){if(this.playbackWatcher_){this.playbackWatcher_.dispose()}if(this.masterPlaylistController_){this.masterPlaylistController_.dispose()}if(this.qualityLevels_){this.qualityLevels_.dispose()}if(this.player_){delete this.player_.vhs;delete this.player_.dash;delete this.player_.hls}if(this.tech_&&this.tech_.hls){delete this.tech_.hls}Uf(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"dispose",this).call(this)}},{key:"convertToStreamTime",value:function e(t,i){return Rh({playlist:this.masterPlaylistController_.media(),time:t,callback:i})}},{key:"seekToStreamTime",value:function e(t,i){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:2;return Mh({streamTime:t,playlist:this.masterPlaylistController_.media(),retryCount:n,pauseAfterSeek:r,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:i})}}]);return a}(fm);var dm={name:"videojs-http-streaming",VERSION:tm,canHandleSource:function e(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var r=Ts.mergeOptions(Ts.options,i);return dm.canPlayType(t.type,r)},handleSource:function e(t,i){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var n=Ts.mergeOptions(Ts.options,r);i.hls=new hm(t,i,n);i.hls.xhr=_h();i.hls.src(t.src,t.type);return i.hls},canPlayType:function e(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var r=Ts.mergeOptions(Ts.options,i),n=r.hls.overrideNative;var a=nm(t);var s=a&&(!im.supportsTypeNatively(a)||n);return s?"maybe":""}};if(typeof Ts.MediaSource==="undefined"||typeof Ts.URL==="undefined"){Ts.MediaSource=Ud;Ts.URL=Dd}if(Ud.supportsNativeMediaSources()){Ts.getTech("Html5").registerSourceHandler(dm,0)}Ts.HlsHandler=hm;Ts.HlsSourceHandler=dm;Ts.Hls=im;if(!Ts.use){Ts.registerComponent("Hls",im)}Ts.options.hls=Ts.options.hls||{};if(Ts.registerPlugin){Ts.registerPlugin("reloadSourceOnError",em)}else{Ts.plugin("reloadSourceOnError",em)}return Ts});!function(){!function(e){var t=e&&e.videojs;t&&(t.CDN_VERSION="7.4.1")}(window)}();